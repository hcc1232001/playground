{"version":3,"sources":["pages lazy /^/.*$/ groupOptions: {} namespace object","utils/vendor/orbitControls.js","media/models/190717_frying pan animationA_flip.fbx","media/models/190717_frying pan animationB_shake.fbx","media/models/190717_frying pan animationB_flip.fbx","media/models/190717_frying pan animationC_shake.fbx","media/models/190717_frying pan animationC_flip.fbx","App.js","index.js","globals/config.js","pages/fbxViewer.js","utils/vendor/shaders/CopyShader.js","utils/vendor/postprocessing/Pass.js","utils/vendor/postprocessing/ShaderPass.js","utils/vendor/postprocessing/MaskPass.js","utils/vendor/postprocessing/EffectComposer.js","utils/vendor/postprocessing/RenderPass.js","utils/vendor/shaders/SAOShader.js","utils/vendor/shaders/DepthLimitedBlurShader.js","utils/vendor/shaders/UnpackDepthRGBAShader.js","utils/vendor/postprocessing/SAOPass.js","pages/kitchenViewer.js","media/models/190717_frying pan animationA_shake.fbx","pages/typhoonViewer.js","pages/jsonViewer.js","pages/indexPage.js","pages/touchTableViewer.js","pages/animatingLines.js","pages/svgAnimator.js","components/useDeviceMotion.js","pages/joinGame.js","pages/homePage.js","components/touchTableInstance.js","pages/touchTable.js","components/fbxModelsLoader.js","pages/createGame.js","globals/routes.js","media/models/190715_CLP_game(8).fbx","media/textures/meat.png","media/textures/mid_meat.png","media/textures/welldone_meat.png","media/sound/click.mp3"],"names":["map","./animatingLines","./animatingLines.js","./createGame","./createGame.js","./custom-inputbox.css","./fbxViewer","./fbxViewer.css","./fbxViewer.js","./homePage","./homePage.css","./homePage.js","./indexPage","./indexPage.js","./joinGame","./joinGame.js","./jsonViewer","./jsonViewer.js","./kitchenViewer","./kitchenViewer.css","./kitchenViewer.js","./svgAnimator","./svgAnimator.css","./svgAnimator.js","./touchTable","./touchTable.css","./touchTable.js","./touchTableViewer","./touchTableViewer.js","./typhoonViewer","./typhoonViewer.js","webpackAsyncContext","req","Promise","resolve","then","__webpack_require__","o","e","Error","code","ids","id","t","keys","Object","module","exports","THREE","require","OrbitControls","object","domElement","this","undefined","document","enabled","target","Vector3","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","MOUSE","MIDDLE","target0","clone","position0","position","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","scope","copy","reset","updateProjectionMatrix","dispatchEvent","changeEvent","update","state","STATE","NONE","offset","quat","Quaternion","setFromUnitVectors","up","quatInverse","inverse","lastPosition","lastQuaternion","sub","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","max","min","makeSafe","radius","scale","add","panOffset","setFromSpherical","lookAt","multiplyScalar","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseMove","onMouseUp","window","onKeyDown","type","startEvent","endEvent","ROTATE","DOLLY","PAN","TOUCH_ROTATE","TOUCH_DOLLY_PAN","Spherical","rotateStart","Vector2","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","angle","rotateUp","panLeft","v","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","body","isPerspectiveCamera","targetDistance","length","tan","fov","clientHeight","matrix","isOrthographicCamera","right","left","clientWidth","top","bottom","console","warn","dollyIn","dollyScale","dollyOut","handleMouseDownPan","event","clientX","clientY","preventDefault","focus","button","ctrlKey","metaKey","shiftKey","handleMouseDownRotate","handleMouseDownDolly","addEventListener","subVectors","x","y","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","stopPropagation","handleMouseWheel","needsUpdate","keyCode","handleKeyDown","touches","pageX","pageY","handleTouchStartRotate","dx","dy","sqrt","handleTouchStartDollyPan","handleTouchMoveRotate","handleTouchMoveDollyPan","prototype","create","EventDispatcher","constructor","defineProperties","center","get","noZoom","value","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","default","p","templates","joinGame","JoinGame","homePage","HomePage","fbxViewer","FbxViewer","typhoonViewer","TyphoonViewer","jsonViewer","JsonViewer","kitchenViewer","KitchenViewer","indexPage","IndexPage","touchTableViewer","TouchTableViewer","touchTable","TouchTable","animatingLines","AnimatingLines","svgAnimator","SvgAnimator","getRenderPropForRoute","pageId","AppComponent","match","react_default","a","createElement","App","react_router_dom","react_router","path","routes","render","to","ReactDOM","src_App_0","getElementById","d","__webpack_exports__","serverPath","serverPort","props","_useState","useState","scene","camera","containerEl","renderer","orbitControl","raycaster","clock","mixer","_useState2","D_Documents_Projects_React_playground_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__","threeObjects","setThreeObjects","_useState3","_useState4","cameraPosition","setCameraPosition","fbxName","useParams","log","animationFrame","initScene","background","offsetWidth","offsetHeight","antialias","alpha","setPixelRatio","devicePixelRatio","setSize","setClearColor","appendChild","shadowMap","loader","FBXLoader","load","concat","action","animations","clipAction","play","cameraOfFbx","getObjectByName","z","i","charCodeAt","currentChar","String","fromCharCode","videoElement","video","oncanplay","muted","loop","autoplay","src","texture","minFilter","magFilter","format","material","displacementMap","displacementScale","testEl","changeChildrenMaterialColor","lvl","arguments","includes","name","children","forEach","child","isMesh","color","traverse","side","castShadow","receiveShadow","addShadowToChild","robotArmEl","addShadowToRobotArm","robotArmArmourEl","robotArmArmourElTexture","emissiveMap","emissive","rock","rockTexture","prevThreeObjects","D_Documents_Projects_React_playground_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__","item","loaded","total","err","onResize","aspect","useEffect","clearTimeout","setTimeout","requestAnimationFrame","delta","getDelta","react__WEBPACK_IMPORTED_MODULE_2___default","ref","className","style","height","onClick","CopyShader","uniforms","tDiffuse","opacity","vertexShader","join","fragmentShader","Pass","needsSwap","clear","renderToScreen","assign","error","FullScreenQuad","OrthographicCamera","geometry","PlaneBufferGeometry","_mesh","Mesh","defineProperty","ShaderPass","shader","textureID","call","ShaderMaterial","UniformsUtils","defines","fsQuad","writeBuffer","readBuffer","setRenderTarget","autoClearColor","autoClearDepth","autoClearStencil","MaskPass","writeValue","clearValue","context","buffers","setMask","depth","setLocked","stencil","setTest","setOp","REPLACE","setFunc","ALWAYS","setClear","EQUAL","KEEP","ClearMaskPass","EffectComposer","renderTarget","parameters","LinearFilter","RGBAFormat","stencilBuffer","size","getSize","_pixelRatio","getPixelRatio","_width","width","_height","WebGLRenderTarget","renderTarget1","renderTarget2","passes","copyPass","Clock","swapBuffers","tmp","addPass","pass","push","getDrawingBufferSize","insertPass","index","splice","isLastEnabledPass","passIndex","deltaTime","currentRenderTarget","getRenderTarget","maskActive","il","stencilFunc","NOTEQUAL","effectiveWidth","effectiveHeight","pixelRatio","RenderPass","overrideMaterial","clearColor","clearAlpha","clearDepth","oldClearColor","oldClearAlpha","oldAutoClear","autoClear","getClearColor","getHex","getClearAlpha","SAOShader","NUM_SAMPLES","NUM_RINGS","NORMAL_TEXTURE","DIFFUSE_TEXTURE","DEPTH_PACKING","PERSPECTIVE_CAMERA","tDepth","tNormal","cameraNear","cameraFar","cameraProjectionMatrix","Matrix4","cameraInverseProjectionMatrix","intensity","bias","minResolution","kernelRadius","randomSeed","DepthLimitedBlurShader","KERNEL_RADIUS","sampleUvOffsets","sampleWeights","depthCutoff","BlurShaderUtils","createSampleWeights","stdDev","gaussian","exp","weights","createSampleOffsets","uvIncrement","offsets","configure","UnpackDepthRGBAShader","SAOPass","depthTexture","useNormals","resolution","supportsDepthTextureExtension","supportsNormalTexture","originalClearColor","Color","params","output","saoBias","saoIntensity","saoScale","saoKernelRadius","saoMinResolution","saoBlur","saoBlurRadius","saoBlurStdDev","saoBlurDepthCutoff","saoRenderTarget","blurIntermediateRenderTarget","beautyRenderTarget","normalRenderTarget","NearestFilter","depthRenderTarget","DepthTexture","UnsignedShortType","maxFilter","depthBuffer","depthMaterial","MeshDepthMaterial","depthPacking","RGBADepthPacking","blending","NoBlending","normalMaterial","MeshNormalMaterial","saoMaterial","extensions","derivatives","getInverse","projectionMatrix","vBlurMaterial","hBlurMaterial","materialCopy","transparent","depthTest","depthWrite","CustomBlending","blendSrc","DstColorFactor","blendDst","ZeroFactor","blendEquation","AddEquation","blendSrcAlpha","DstAlphaFactor","blendDstAlpha","blendEquationAlpha","depthCopy","OUTPUT","Beauty","Default","SAO","Depth","Normal","renderPass","near","far","floor","prevStdDev","prevNumSamples","renderOverride","outputMaterial","passMaterial","originalClearAlpha","originalAutoClear","setClearAlpha","executeCrossFade","startAction","endAction","duration","setEffectiveTimeScale","setEffectiveWeight","time","crossFadeTo","_ref","_ref$enableSAOPass","enableSAOPass","slicedToArray","pansAnimation","setPansAnimation","_useState5","_useState6","_useState7","_useState8","_useState9","_useState10","roomLoaded","setRoomLoaded","_useState11","_useState12","setTextureLoaded","_useState13","innerWidth","innerHeight","_useState14","_useState15","Date","now","_useState16","loadPans","progressCallback","pans","pansNameMapping","panName","tracksRename","Meat_A__Copy_.position","Meat_A__Copy_.quaternion","frying_pan_A_2.position","frying_pan_A_2.quaternion","Meat_B__Copy_.position","Meat_B__Copy_.quaternion","frying_pan_B_2.position","frying_pan_B_2.quaternion","Meat_C__Copy_.position","Meat_C__Copy_.quaternion","frying_pan_C_2.position","frying_pan_C_2.quaternion","mixersArray","progressArray","Array","fill","onProgress","totalProgressPercent","reduce","c","idx","currentPan","panObject","find","shakePromise","reject","track","shake","flipPromise","flip","all","results","actions","objectSpread2","pansLoader","result","composer","useTarget","fbxUrl","isPointLight","isDirectionalLight","shadow","mapSize","isCamera","filter","obj","startsWith","panObj","panMesh","toLowerCase","endsWith","textureLoader","meatTextures","meatUrl","mildMeatUrl","welldoneMeatUrl","saoPass","cancelAnimationFrame","dlight","plight1","plight2","alight","wrapElement","wrapElementTexture","roughness","metalness","emissiveIntensity","alphaMap","innerElement","texReady","disReady","texVideo","dispVideo","vidTexture","alphaTest","dispTexture","jsonName","ObjectLoader","r","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","react_router_dom__WEBPACK_IMPORTED_MODULE_1__","globals_routes__WEBPACK_IMPORTED_MODULE_2__","D_Documents_Projects_React_playground_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","targetWinSize","setTargetWinSize","winSize","setWinSize","winScale","setWinScale","react__WEBPACK_IMPORTED_MODULE_1___default","overflow","transform","transformOrigin","border","transition","zIndex","cursor","prevTargerWinSize","svgEl","setSvgEl","elList","setElList","clickedEl","setClickedEl","clickedElInfo","setClickedElInfo","svgStr","setSvgStr","htmlEl","querySelector","dragoverHandler","dropHandler","file","dataTransfer","items","kind","getAsFile","files","reader","FileReader","readAsBinaryString","onloadend","ElListWithSelector","ElList","querySelectorAll","svgOnClick","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","el","getBBox","elOnClick","boundBox","selector","finder","root","data","return","currentTarget","selectorStr","classList","parentNode","elementInfo","getComputedStyle","getAttribute","animation","animationEls","from","animationEl","animationAttrs","calcMode","values","keySplines","repeatCount","dur","begin","remove","getBoundingClientRect","pointerEvents","split","replace","dangerouslySetInnerHTML","__html","onChange","selected","key","tagName","readOnly","animationData","viewBox","stroke","vectorEffect","strokeWidth","UseDeviceMotion","threshold","setThreshold","moveCounter","setMoveCounter","permissionGranted","setPermissionGranted","lastAccVec3","onMotion","beta","gamma","abs","deltaZ","prevMoveCounter","onShake","Fragment","DeviceOrientationEvent","requestPermission","response","catch","STATUS","freeze","CONNECTING","IDLE","SHAKING","ENDGAME","INVALID","socket","setSocket","statusDisplay","setStatusDisplay","lastShakeTime","serverUrl","io","on","emit","userId","joinStatus","status","msg","useDeviceMotion","playersInfo","setPlayersInfo","_loop","playerIdx","playerInfo","joinGamePath","location","origin","pathname","generatePath","QRCode","toDataURL","dark","light","margin","url","prevPlayersInfo","newPlayerInfo","toConsumableArray","img","joined","href","rel","alt","shakeCount","TouchTableInstance","setScale","scalingFactor","setScalingFactor","currentRotate","setAngle","rotatingAngle","setRotatingAngle","currentXY","setCurrentXY","previousXY","setPreviousXY","useRef","aniScale","TweenMax","ease","Back","easeOut","onUpdate","onComplete","react_hammerjs_es","onPinch","newScale","onPinchEnd","onRotateStart","rotation","onRotateMove","onPanStart","contains","offsetParent","current","onPan","onPanEnd","options","recognizers","pinch","enable","rotate","easeIn","closeFunc","instances","setInstances","audioInstance","Audio","clickSound","playClickSound","removeInstance","instance","prevInstance","instanceIndex","indexOf","slice","onPress","containerWidth","containerHeight","instanceRotated","rotateAngleX","atan","rotateAngleY","rotatedPositionX","cos","sin","rotatedPositionY","instanceWidth","instanceHeight","instanceX","instanceY","newInstance","components_touchTableInstance","fbxModelsLoader","modelsUrlArray","modelLoadingArray","modelUrl","clampWhenFinished","CreateGame","loadedModels","setLoadedModels","fbxModels","loadModels","models","fbxViewerOfName","jsonViewerOfName"],"mappings":"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","file":"static/js/main.140f9981.chunk.js","sourcesContent":["var map = {\n\t\"./animatingLines\": [\n\t\t35,\n\t\t9\n\t],\n\t\"./animatingLines.js\": [\n\t\t35,\n\t\t9\n\t],\n\t\"./createGame\": [\n\t\t51,\n\t\t9\n\t],\n\t\"./createGame.js\": [\n\t\t51,\n\t\t9\n\t],\n\t\"./custom-inputbox.css\": [\n\t\t80,\n\t\t7\n\t],\n\t\"./fbxViewer\": [\n\t\t22,\n\t\t9\n\t],\n\t\"./fbxViewer.css\": [\n\t\t29,\n\t\t7\n\t],\n\t\"./fbxViewer.js\": [\n\t\t22,\n\t\t9\n\t],\n\t\"./homePage\": [\n\t\t38,\n\t\t9\n\t],\n\t\"./homePage.css\": [\n\t\t77,\n\t\t7\n\t],\n\t\"./homePage.js\": [\n\t\t38,\n\t\t9\n\t],\n\t\"./indexPage\": [\n\t\t33,\n\t\t9\n\t],\n\t\"./indexPage.js\": [\n\t\t33,\n\t\t9\n\t],\n\t\"./joinGame\": [\n\t\t37,\n\t\t9\n\t],\n\t\"./joinGame.js\": [\n\t\t37,\n\t\t9\n\t],\n\t\"./jsonViewer\": [\n\t\t32,\n\t\t9\n\t],\n\t\"./jsonViewer.js\": [\n\t\t32,\n\t\t9\n\t],\n\t\"./kitchenViewer\": [\n\t\t23,\n\t\t9\n\t],\n\t\"./kitchenViewer.css\": [\n\t\t76,\n\t\t7\n\t],\n\t\"./kitchenViewer.js\": [\n\t\t23,\n\t\t9\n\t],\n\t\"./svgAnimator\": [\n\t\t36,\n\t\t9\n\t],\n\t\"./svgAnimator.css\": [\n\t\t79,\n\t\t7\n\t],\n\t\"./svgAnimator.js\": [\n\t\t36,\n\t\t9\n\t],\n\t\"./touchTable\": [\n\t\t39,\n\t\t9\n\t],\n\t\"./touchTable.css\": [\n\t\t78,\n\t\t7\n\t],\n\t\"./touchTable.js\": [\n\t\t39,\n\t\t9\n\t],\n\t\"./touchTableViewer\": [\n\t\t34,\n\t\t9\n\t],\n\t\"./touchTableViewer.js\": [\n\t\t34,\n\t\t9\n\t],\n\t\"./typhoonViewer\": [\n\t\t31,\n\t\t9\n\t],\n\t\"./typhoonViewer.js\": [\n\t\t31,\n\t\t9\n\t]\n};\n\nfunction webpackAsyncContext(req) {\n\treturn Promise.resolve().then(function() {\n\t\tif(!__webpack_require__.o(map, req)) {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t}\n\n\t\tvar ids = map[req], id = ids[0];\n\t\treturn __webpack_require__.t(id, ids[1])\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 100;\nmodule.exports = webpackAsyncContext;","/* three-orbitcontrols addendum */\r\nvar THREE = require('three');\r\n/**\r\n * @author qiao / https://github.com/qiao\r\n * @author mrdoob / http://mrdoob.com\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author erich666 / http://erichaines.com\r\n */\r\n// This set of controls performs orbiting, dollying (zooming), and panning.\r\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\r\n//\r\n//    Orbit - left mouse / touch: one-finger move\r\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\r\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\r\n\r\n\r\nTHREE.OrbitControls = function (object, domElement) {\r\n  this.object = object;\r\n  this.domElement = domElement !== undefined ? domElement : document; // Set to false to disable this control\r\n\r\n  this.enabled = true; // \"target\" sets the location of focus, where the object orbits around\r\n\r\n  this.target = new THREE.Vector3(); // How far you can dolly in and out ( PerspectiveCamera only )\r\n\r\n  this.minDistance = 0;\r\n  this.maxDistance = Infinity; // How far you can zoom in and out ( OrthographicCamera only )\r\n\r\n  this.minZoom = 0;\r\n  this.maxZoom = Infinity; // How far you can orbit vertically, upper and lower limits.\r\n  // Range is 0 to Math.PI radians.\r\n\r\n  this.minPolarAngle = 0; // radians\r\n\r\n  this.maxPolarAngle = Math.PI; // radians\r\n  // How far you can orbit horizontally, upper and lower limits.\r\n  // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\r\n\r\n  this.minAzimuthAngle = -Infinity; // radians\r\n\r\n  this.maxAzimuthAngle = Infinity; // radians\r\n  // Set to true to enable damping (inertia)\r\n  // If damping is enabled, you must call controls.update() in your animation loop\r\n\r\n  this.enableDamping = false;\r\n  this.dampingFactor = 0.25; // This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\r\n  // Set to false to disable zooming\r\n\r\n  this.enableZoom = true;\r\n  this.zoomSpeed = 1.0; // Set to false to disable rotating\r\n\r\n  this.enableRotate = true;\r\n  this.rotateSpeed = 1.0; // Set to false to disable panning\r\n\r\n  this.enablePan = true;\r\n  this.panSpeed = 1.0;\r\n  this.screenSpacePanning = false; // if true, pan in screen-space\r\n\r\n  this.keyPanSpeed = 7.0; // pixels moved per arrow key push\r\n  // Set to true to automatically rotate around the target\r\n  // If auto-rotate is enabled, you must call controls.update() in your animation loop\r\n\r\n  this.autoRotate = false;\r\n  this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\r\n  // Set to false to disable use of the keys\r\n\r\n  this.enableKeys = true; // The four arrow keys\r\n\r\n  this.keys = {\r\n    LEFT: 37,\r\n    UP: 38,\r\n    RIGHT: 39,\r\n    BOTTOM: 40\r\n  }; // Mouse buttons\r\n\r\n  this.mouseButtons = {\r\n    LEFT: THREE.MOUSE.LEFT,\r\n    MIDDLE: THREE.MOUSE.MIDDLE,\r\n    RIGHT: THREE.MOUSE.RIGHT\r\n  }; // for reset\r\n\r\n  this.target0 = this.target.clone();\r\n  this.position0 = this.object.position.clone();\r\n  this.zoom0 = this.object.zoom; //\r\n  // public methods\r\n  //\r\n\r\n  this.getPolarAngle = function () {\r\n    return spherical.phi;\r\n  };\r\n\r\n  this.getAzimuthalAngle = function () {\r\n    return spherical.theta;\r\n  };\r\n\r\n  this.saveState = function () {\r\n    scope.target0.copy(scope.target);\r\n    scope.position0.copy(scope.object.position);\r\n    scope.zoom0 = scope.object.zoom;\r\n  };\r\n\r\n  this.reset = function () {\r\n    scope.target.copy(scope.target0);\r\n    scope.object.position.copy(scope.position0);\r\n    scope.object.zoom = scope.zoom0;\r\n    scope.object.updateProjectionMatrix();\r\n    scope.dispatchEvent(changeEvent);\r\n    scope.update();\r\n    state = STATE.NONE;\r\n  }; // this method is exposed, but perhaps it would be better if we can make it private...\r\n\r\n\r\n  this.update = function () {\r\n    var offset = new THREE.Vector3(); // so camera.up is the orbit axis\r\n\r\n    var quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));\r\n    var quatInverse = quat.clone().inverse();\r\n    var lastPosition = new THREE.Vector3();\r\n    var lastQuaternion = new THREE.Quaternion();\r\n    return function update() {\r\n      var position = scope.object.position;\r\n      offset.copy(position).sub(scope.target); // rotate offset to \"y-axis-is-up\" space\r\n\r\n      offset.applyQuaternion(quat); // angle from z-axis around y-axis\r\n\r\n      spherical.setFromVector3(offset);\r\n\r\n      if (scope.autoRotate && state === STATE.NONE) {\r\n        rotateLeft(getAutoRotationAngle());\r\n      }\r\n\r\n      spherical.theta += sphericalDelta.theta;\r\n      spherical.phi += sphericalDelta.phi; // restrict theta to be between desired limits\r\n\r\n      spherical.theta = Math.max(scope.minAzimuthAngle, Math.min(scope.maxAzimuthAngle, spherical.theta)); // restrict phi to be between desired limits\r\n\r\n      spherical.phi = Math.max(scope.minPolarAngle, Math.min(scope.maxPolarAngle, spherical.phi));\r\n      spherical.makeSafe();\r\n      spherical.radius *= scale; // restrict radius to be between desired limits\r\n\r\n      spherical.radius = Math.max(scope.minDistance, Math.min(scope.maxDistance, spherical.radius)); // move target to panned location\r\n\r\n      scope.target.add(panOffset);\r\n      offset.setFromSpherical(spherical); // rotate offset back to \"camera-up-vector-is-up\" space\r\n\r\n      offset.applyQuaternion(quatInverse);\r\n      position.copy(scope.target).add(offset);\r\n      scope.object.lookAt(scope.target);\r\n\r\n      if (scope.enableDamping === true) {\r\n        sphericalDelta.theta *= 1 - scope.dampingFactor;\r\n        sphericalDelta.phi *= 1 - scope.dampingFactor;\r\n        panOffset.multiplyScalar(1 - scope.dampingFactor);\r\n      } else {\r\n        sphericalDelta.set(0, 0, 0);\r\n        panOffset.set(0, 0, 0);\r\n      }\r\n\r\n      scale = 1; // update condition is:\r\n      // min(camera displacement, camera rotation in radians)^2 > EPS\r\n      // using small-angle approximation cos(x/2) = 1 - x^2 / 8\r\n\r\n      if (zoomChanged || lastPosition.distanceToSquared(scope.object.position) > EPS || 8 * (1 - lastQuaternion.dot(scope.object.quaternion)) > EPS) {\r\n        scope.dispatchEvent(changeEvent);\r\n        lastPosition.copy(scope.object.position);\r\n        lastQuaternion.copy(scope.object.quaternion);\r\n        zoomChanged = false;\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    };\r\n  }();\r\n\r\n  this.dispose = function () {\r\n    scope.domElement.removeEventListener('contextmenu', onContextMenu, false);\r\n    scope.domElement.removeEventListener('mousedown', onMouseDown, false);\r\n    scope.domElement.removeEventListener('wheel', onMouseWheel, false);\r\n    scope.domElement.removeEventListener('touchstart', onTouchStart, false);\r\n    scope.domElement.removeEventListener('touchend', onTouchEnd, false);\r\n    scope.domElement.removeEventListener('touchmove', onTouchMove, false);\r\n    document.removeEventListener('mousemove', onMouseMove, false);\r\n    document.removeEventListener('mouseup', onMouseUp, false);\r\n    window.removeEventListener('keydown', onKeyDown, false); //scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\r\n  }; //\r\n  // internals\r\n  //\r\n\r\n\r\n  var scope = this;\r\n  var changeEvent = {\r\n    type: 'change'\r\n  };\r\n  var startEvent = {\r\n    type: 'start'\r\n  };\r\n  var endEvent = {\r\n    type: 'end'\r\n  };\r\n  var STATE = {\r\n    NONE: -1,\r\n    ROTATE: 0,\r\n    DOLLY: 1,\r\n    PAN: 2,\r\n    TOUCH_ROTATE: 3,\r\n    TOUCH_DOLLY_PAN: 4\r\n  };\r\n  var state = STATE.NONE;\r\n  var EPS = 0.000001; // current position in spherical coordinates\r\n\r\n  var spherical = new THREE.Spherical();\r\n  var sphericalDelta = new THREE.Spherical();\r\n  var scale = 1;\r\n  var panOffset = new THREE.Vector3();\r\n  var zoomChanged = false;\r\n  var rotateStart = new THREE.Vector2();\r\n  var rotateEnd = new THREE.Vector2();\r\n  var rotateDelta = new THREE.Vector2();\r\n  var panStart = new THREE.Vector2();\r\n  var panEnd = new THREE.Vector2();\r\n  var panDelta = new THREE.Vector2();\r\n  var dollyStart = new THREE.Vector2();\r\n  var dollyEnd = new THREE.Vector2();\r\n  var dollyDelta = new THREE.Vector2();\r\n\r\n  function getAutoRotationAngle() {\r\n    return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\r\n  }\r\n\r\n  function getZoomScale() {\r\n    return Math.pow(0.95, scope.zoomSpeed);\r\n  }\r\n\r\n  function rotateLeft(angle) {\r\n    sphericalDelta.theta -= angle;\r\n  }\r\n\r\n  function rotateUp(angle) {\r\n    sphericalDelta.phi -= angle;\r\n  }\r\n\r\n  var panLeft = function () {\r\n    var v = new THREE.Vector3();\r\n    return function panLeft(distance, objectMatrix) {\r\n      v.setFromMatrixColumn(objectMatrix, 0); // get X column of objectMatrix\r\n\r\n      v.multiplyScalar(-distance);\r\n      panOffset.add(v);\r\n    };\r\n  }();\r\n\r\n  var panUp = function () {\r\n    var v = new THREE.Vector3();\r\n    return function panUp(distance, objectMatrix) {\r\n      if (scope.screenSpacePanning === true) {\r\n        v.setFromMatrixColumn(objectMatrix, 1);\r\n      } else {\r\n        v.setFromMatrixColumn(objectMatrix, 0);\r\n        v.crossVectors(scope.object.up, v);\r\n      }\r\n\r\n      v.multiplyScalar(distance);\r\n      panOffset.add(v);\r\n    };\r\n  }(); // deltaX and deltaY are in pixels; right and down are positive\r\n\r\n\r\n  var pan = function () {\r\n    var offset = new THREE.Vector3();\r\n    return function pan(deltaX, deltaY) {\r\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\r\n      if (scope.object.isPerspectiveCamera) {\r\n        // perspective\r\n        var position = scope.object.position;\r\n        offset.copy(position).sub(scope.target);\r\n        var targetDistance = offset.length(); // half of the fov is center to top of screen\r\n\r\n        targetDistance *= Math.tan(scope.object.fov / 2 * Math.PI / 180.0); // we use only clientHeight here so aspect ratio does not distort speed\r\n\r\n        panLeft(2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix);\r\n        panUp(2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix);\r\n      } else if (scope.object.isOrthographicCamera) {\r\n        // orthographic\r\n        panLeft(deltaX * (scope.object.right - scope.object.left) / scope.object.zoom / element.clientWidth, scope.object.matrix);\r\n        panUp(deltaY * (scope.object.top - scope.object.bottom) / scope.object.zoom / element.clientHeight, scope.object.matrix);\r\n      } else {\r\n        // camera neither orthographic nor perspective\r\n        console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.');\r\n        scope.enablePan = false;\r\n      }\r\n    };\r\n  }();\r\n\r\n  function dollyIn(dollyScale) {\r\n    if (scope.object.isPerspectiveCamera) {\r\n      scale /= dollyScale;\r\n    } else if (scope.object.isOrthographicCamera) {\r\n      scope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom * dollyScale));\r\n      scope.object.updateProjectionMatrix();\r\n      zoomChanged = true;\r\n    } else {\r\n      console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\r\n      scope.enableZoom = false;\r\n    }\r\n  }\r\n\r\n  function dollyOut(dollyScale) {\r\n    if (scope.object.isPerspectiveCamera) {\r\n      scale *= dollyScale;\r\n    } else if (scope.object.isOrthographicCamera) {\r\n      scope.object.zoom = Math.max(scope.minZoom, Math.min(scope.maxZoom, scope.object.zoom / dollyScale));\r\n      scope.object.updateProjectionMatrix();\r\n      zoomChanged = true;\r\n    } else {\r\n      console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\r\n      scope.enableZoom = false;\r\n    }\r\n  } //\r\n  // event callbacks - update the object state\r\n  //\r\n\r\n\r\n  function handleMouseDownRotate(event) {\r\n    //console.log( 'handleMouseDownRotate' );\r\n    rotateStart.set(event.clientX, event.clientY);\r\n  }\r\n\r\n  function handleMouseDownDolly(event) {\r\n    //console.log( 'handleMouseDownDolly' );\r\n    dollyStart.set(event.clientX, event.clientY);\r\n  }\r\n\r\n  function handleMouseDownPan(event) {\r\n    //console.log( 'handleMouseDownPan' );\r\n    panStart.set(event.clientX, event.clientY);\r\n  }\r\n\r\n  function handleMouseMoveRotate(event) {\r\n    //console.log( 'handleMouseMoveRotate' );\r\n    rotateEnd.set(event.clientX, event.clientY);\r\n    rotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed);\r\n    var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n    rotateLeft(2 * Math.PI * rotateDelta.x / element.clientHeight); // yes, height\r\n\r\n    rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight);\r\n    rotateStart.copy(rotateEnd);\r\n    scope.update();\r\n  }\r\n\r\n  function handleMouseMoveDolly(event) {\r\n    //console.log( 'handleMouseMoveDolly' );\r\n    dollyEnd.set(event.clientX, event.clientY);\r\n    dollyDelta.subVectors(dollyEnd, dollyStart);\r\n\r\n    if (dollyDelta.y > 0) {\r\n      dollyIn(getZoomScale());\r\n    } else if (dollyDelta.y < 0) {\r\n      dollyOut(getZoomScale());\r\n    }\r\n\r\n    dollyStart.copy(dollyEnd);\r\n    scope.update();\r\n  }\r\n\r\n  function handleMouseMovePan(event) {\r\n    //console.log( 'handleMouseMovePan' );\r\n    panEnd.set(event.clientX, event.clientY);\r\n    panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);\r\n    pan(panDelta.x, panDelta.y);\r\n    panStart.copy(panEnd);\r\n    scope.update();\r\n  }\r\n\r\n  function handleMouseUp(event) {// console.log( 'handleMouseUp' );\r\n  }\r\n\r\n  function handleMouseWheel(event) {\r\n    // console.log( 'handleMouseWheel' );\r\n    if (event.deltaY < 0) {\r\n      dollyOut(getZoomScale());\r\n    } else if (event.deltaY > 0) {\r\n      dollyIn(getZoomScale());\r\n    }\r\n\r\n    scope.update();\r\n  }\r\n\r\n  function handleKeyDown(event) {\r\n    // console.log( 'handleKeyDown' );\r\n    var needsUpdate = false;\r\n\r\n    switch (event.keyCode) {\r\n      case scope.keys.UP:\r\n        pan(0, scope.keyPanSpeed);\r\n        needsUpdate = true;\r\n        break;\r\n\r\n      case scope.keys.BOTTOM:\r\n        pan(0, -scope.keyPanSpeed);\r\n        needsUpdate = true;\r\n        break;\r\n\r\n      case scope.keys.LEFT:\r\n        pan(scope.keyPanSpeed, 0);\r\n        needsUpdate = true;\r\n        break;\r\n\r\n      case scope.keys.RIGHT:\r\n        pan(-scope.keyPanSpeed, 0);\r\n        needsUpdate = true;\r\n        break;\r\n    }\r\n\r\n    if (needsUpdate) {\r\n      // prevent the browser from scrolling on cursor keys\r\n      event.preventDefault();\r\n      scope.update();\r\n    }\r\n  }\r\n\r\n  function handleTouchStartRotate(event) {\r\n    //console.log( 'handleTouchStartRotate' );\r\n    rotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\r\n  }\r\n\r\n  function handleTouchStartDollyPan(event) {\r\n    //console.log( 'handleTouchStartDollyPan' );\r\n    if (scope.enableZoom) {\r\n      var dx = event.touches[0].pageX; // - event.touches[1].pageX;\r\n      var dy = event.touches[0].pageY; // - event.touches[1].pageY;\r\n      var distance = Math.sqrt(dx * dx + dy * dy);\r\n      dollyStart.set(0, distance);\r\n    }\r\n\r\n    if (scope.enablePan) {\r\n      var x = 0.5 * (event.touches[0].pageX); // + event.touches[1].pageX);\r\n      var y = 0.5 * (event.touches[0].pageY); // + event.touches[1].pageY);\r\n      panStart.set(x, y);\r\n    }\r\n  }\r\n\r\n  function handleTouchMoveRotate(event) {\r\n    //console.log( 'handleTouchMoveRotate' );\r\n    rotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\r\n    rotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed);\r\n    var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n    rotateLeft(2 * Math.PI * rotateDelta.x / element.clientHeight); // yes, height\r\n\r\n    rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight);\r\n    rotateStart.copy(rotateEnd);\r\n    scope.update();\r\n  }\r\n\r\n  function handleTouchMoveDollyPan(event) {\r\n    //console.log( 'handleTouchMoveDollyPan' );\r\n    if (scope.enableZoom) {\r\n      var dx = event.touches[0].pageX; // - event.touches[1].pageX;\r\n      var dy = event.touches[0].pageY; // - event.touches[1].pageY;\r\n      var distance = Math.sqrt(dx * dx + dy * dy);\r\n      dollyEnd.set(0, distance);\r\n      dollyDelta.set(0, Math.pow(dollyEnd.y / dollyStart.y, scope.zoomSpeed));\r\n      dollyIn(dollyDelta.y);\r\n      dollyStart.copy(dollyEnd);\r\n    }\r\n\r\n    if (scope.enablePan) {\r\n      var x = 0.5 * (event.touches[0].pageX); // + event.touches[1].pageX);\r\n      var y = 0.5 * (event.touches[0].pageY); // + event.touches[1].pageY);\r\n      panEnd.set(x, y);\r\n      panDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed);\r\n      pan(panDelta.x, panDelta.y);\r\n      panStart.copy(panEnd);\r\n    }\r\n\r\n    scope.update();\r\n  }\r\n\r\n  function handleTouchEnd(event) {} //console.log( 'handleTouchEnd' );\r\n  //\r\n  // event handlers - FSM: listen for events and reset state\r\n  //\r\n\r\n\r\n  function onMouseDown(event) {\r\n    if (scope.enabled === false) return; // Prevent the browser from scrolling.\r\n\r\n    event.preventDefault(); // Manually set the focus since calling preventDefault above\r\n    // prevents the browser from setting it automatically.\r\n\r\n    scope.domElement.focus ? scope.domElement.focus() : window.focus();\r\n\r\n    switch (event.button) {\r\n      case scope.mouseButtons.LEFT:\r\n        if (event.ctrlKey || event.metaKey || event.shiftKey) {\r\n          if (scope.enablePan === false) return;\r\n          handleMouseDownPan(event);\r\n          state = STATE.PAN;\r\n        } else {\r\n          if (scope.enableRotate === false) return;\r\n          handleMouseDownRotate(event);\r\n          state = STATE.ROTATE;\r\n        }\r\n\r\n        break;\r\n\r\n      case scope.mouseButtons.MIDDLE:\r\n        if (scope.enableZoom === false) return;\r\n        handleMouseDownDolly(event);\r\n        state = STATE.DOLLY;\r\n        break;\r\n\r\n      case scope.mouseButtons.RIGHT:\r\n        if (scope.enablePan === false) return;\r\n        handleMouseDownPan(event);\r\n        state = STATE.PAN;\r\n        break;\r\n    }\r\n\r\n    if (state !== STATE.NONE) {\r\n      document.addEventListener('mousemove', onMouseMove, false);\r\n      document.addEventListener('mouseup', onMouseUp, false);\r\n      scope.dispatchEvent(startEvent);\r\n    }\r\n  }\r\n\r\n  function onMouseMove(event) {\r\n    if (scope.enabled === false) return;\r\n    event.preventDefault();\r\n\r\n    switch (state) {\r\n      case STATE.ROTATE:\r\n        if (scope.enableRotate === false) return;\r\n        handleMouseMoveRotate(event);\r\n        break;\r\n\r\n      case STATE.DOLLY:\r\n        if (scope.enableZoom === false) return;\r\n        handleMouseMoveDolly(event);\r\n        break;\r\n\r\n      case STATE.PAN:\r\n        if (scope.enablePan === false) return;\r\n        handleMouseMovePan(event);\r\n        break;\r\n    }\r\n  }\r\n\r\n  function onMouseUp(event) {\r\n    if (scope.enabled === false) return;\r\n    handleMouseUp(event);\r\n    document.removeEventListener('mousemove', onMouseMove, false);\r\n    document.removeEventListener('mouseup', onMouseUp, false);\r\n    scope.dispatchEvent(endEvent);\r\n    state = STATE.NONE;\r\n  }\r\n\r\n  function onMouseWheel(event) {\r\n    if (scope.enabled === false || scope.enableZoom === false || (state !== STATE.NONE && state !== STATE.ROTATE)) return;\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    scope.dispatchEvent(startEvent);\r\n    handleMouseWheel(event);\r\n    scope.dispatchEvent(endEvent);\r\n  }\r\n\r\n  function onKeyDown(event) {\r\n    if (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false) return;\r\n    handleKeyDown(event);\r\n  }\r\n\r\n  function onTouchStart(event) {\r\n    if (scope.enabled === false) return;\r\n    event.preventDefault();\r\n\r\n    switch (event.touches.length) {\r\n      case 2:\r\n        // two-fingered touch: rotate\r\n        if (scope.enableRotate === false) return;\r\n        handleTouchStartRotate(event);\r\n        state = STATE.TOUCH_ROTATE;\r\n        break;\r\n\r\n      case 1:\r\n        // one-fingered touch: dolly-pan\r\n        if (scope.enableZoom === false && scope.enablePan === false) return;\r\n        handleTouchStartDollyPan(event);\r\n        state = STATE.TOUCH_DOLLY_PAN;\r\n        break;\r\n\r\n      default:\r\n        state = STATE.NONE;\r\n    }\r\n\r\n    if (state !== STATE.NONE) {\r\n      scope.dispatchEvent(startEvent);\r\n    }\r\n  }\r\n\r\n  function onTouchMove(event) {\r\n    if (scope.enabled === false) return;\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    switch (event.touches.length) {\r\n      case 2:\r\n        // two-fingered touch: rotate\r\n        if (scope.enableRotate === false) return;\r\n        if (state !== STATE.TOUCH_ROTATE) return; // is this needed?\r\n\r\n        handleTouchMoveRotate(event);\r\n        break;\r\n\r\n      case 1:\r\n        // one-fingered touch: dolly-pan\r\n        if (scope.enableZoom === false && scope.enablePan === false) return;\r\n        if (state !== STATE.TOUCH_DOLLY_PAN) return; // is this needed?\r\n\r\n        handleTouchMoveDollyPan(event);\r\n        break;\r\n\r\n      default:\r\n        state = STATE.NONE;\r\n    }\r\n  }\r\n\r\n  function onTouchEnd(event) {\r\n    if (scope.enabled === false) return;\r\n    handleTouchEnd(event);\r\n    scope.dispatchEvent(endEvent);\r\n    state = STATE.NONE;\r\n  }\r\n\r\n  function onContextMenu(event) {\r\n    if (scope.enabled === false) return;\r\n    event.preventDefault();\r\n  } //\r\n\r\n\r\n  scope.domElement.addEventListener('contextmenu', onContextMenu, false);\r\n  scope.domElement.addEventListener('mousedown', onMouseDown, false);\r\n  scope.domElement.addEventListener('wheel', onMouseWheel, false);\r\n  scope.domElement.addEventListener('touchstart', onTouchStart, false);\r\n  scope.domElement.addEventListener('touchend', onTouchEnd, false);\r\n  scope.domElement.addEventListener('touchmove', onTouchMove, false);\r\n  window.addEventListener('keydown', onKeyDown, false); // force an update at start\r\n\r\n  this.update();\r\n};\r\n\r\nTHREE.OrbitControls.prototype = Object.create(THREE.EventDispatcher.prototype);\r\nTHREE.OrbitControls.prototype.constructor = THREE.OrbitControls;\r\nObject.defineProperties(THREE.OrbitControls.prototype, {\r\n  center: {\r\n    get: function () {\r\n      console.warn('THREE.OrbitControls: .center has been renamed to .target');\r\n      return this.target;\r\n    }\r\n  },\r\n  // backward compatibility\r\n  noZoom: {\r\n    get: function () {\r\n      console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\r\n      return !this.enableZoom;\r\n    },\r\n    set: function (value) {\r\n      console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\r\n      this.enableZoom = !value;\r\n    }\r\n  },\r\n  noRotate: {\r\n    get: function () {\r\n      console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.');\r\n      return !this.enableRotate;\r\n    },\r\n    set: function (value) {\r\n      console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.');\r\n      this.enableRotate = !value;\r\n    }\r\n  },\r\n  noPan: {\r\n    get: function () {\r\n      console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\r\n      return !this.enablePan;\r\n    },\r\n    set: function (value) {\r\n      console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\r\n      this.enablePan = !value;\r\n    }\r\n  },\r\n  noKeys: {\r\n    get: function () {\r\n      console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\r\n      return !this.enableKeys;\r\n    },\r\n    set: function (value) {\r\n      console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\r\n      this.enableKeys = !value;\r\n    }\r\n  },\r\n  staticMoving: {\r\n    get: function () {\r\n      console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.');\r\n      return !this.enableDamping;\r\n    },\r\n    set: function (value) {\r\n      console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.');\r\n      this.enableDamping = !value;\r\n    }\r\n  },\r\n  dynamicDampingFactor: {\r\n    get: function () {\r\n      console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.');\r\n      return this.dampingFactor;\r\n    },\r\n    set: function (value) {\r\n      console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.');\r\n      this.dampingFactor = value;\r\n    }\r\n  }\r\n});\r\n/* three-orbitcontrols addendum */\r\n\r\nmodule.exports = exports.default = THREE.OrbitControls;","module.exports = __webpack_public_path__ + \"static/media/190717_frying pan animationA_flip.76c68fdb.fbx\";","module.exports = __webpack_public_path__ + \"static/media/190717_frying pan animationB_shake.39143745.fbx\";","module.exports = __webpack_public_path__ + \"static/media/190717_frying pan animationB_flip.73bcd93e.fbx\";","module.exports = __webpack_public_path__ + \"static/media/190717_frying pan animationC_shake.642bef3e.fbx\";","module.exports = __webpack_public_path__ + \"static/media/190717_frying pan animationC_flip.e5174b4e.fbx\";","import React from 'react';\nimport {HashRouter, BrowserRouter, Switch, Route, Redirect} from 'react-router-dom';\nimport asyncLoadingPage from 'components/asyncLoadingComponent.js';\nimport routes from 'globals/routes';\n// import logo from './logo.svg';\nimport './App.css';\n\nimport JoinGame from 'pages/joinGame';\nimport HomePage from 'pages/homePage';\nimport FbxViewer from 'pages/fbxViewer';\nimport TyphoonViewer from 'pages/typhoonViewer';\nimport JsonViewer from 'pages/jsonViewer';\nimport KitchenViewer from 'pages/kitchenViewer';\nimport IndexPage from 'pages/indexPage';\nimport TouchTableViewer from 'pages/touchTableViewer';\nimport TouchTable from 'pages/touchTable';\nimport AnimatingLines from 'pages/animatingLines';\nimport SvgAnimator from 'pages/svgAnimator';\n\nconst templates = {\n  joinGame: JoinGame,\n  homePage: HomePage,\n  fbxViewer: FbxViewer,\n  typhoonViewer: TyphoonViewer,\n  jsonViewer: JsonViewer,\n  kitchenViewer: KitchenViewer,\n  indexPage: IndexPage,\n  touchTableViewer: TouchTableViewer,\n  touchTable: TouchTable,\n  animatingLines: AnimatingLines,\n  svgAnimator: SvgAnimator,\n};\n\nconst getRenderPropForRoute = (pageId) => {\n  // const AppComponent = asyncLoadingPage(pageId);\n  const AppComponent = templates[pageId];\n  return (match) => { return (<AppComponent match={match} />) };\n  \n}\n\nconst App = () => {\n  return (\n    // <BrowserRouter basename=\"/rendering2\">\n    <BrowserRouter>\n      <Switch>\n        {/* <Route path={routes.joinGame} render={getRenderPropForRoute('joinGame')} /> */}\n        {/* <Route path={routes.createGame} render={getRenderPropForRoute('createGame')} /> */}\n        {/* <Route path={routes.homePage} render={getRenderPropForRoute('homePage')} /> */}\n        {/* <Route path={routes.fbxViewerOfName} render={getRenderPropForRoute('fbxViewer')} /> */}\n        {/* <Route path={routes.jsonViewerOfName} render={getRenderPropForRoute('jsonViewer')} /> */}\n        <Route path={routes.typhoonViewer} render={getRenderPropForRoute('typhoonViewer')} />\n        {/* <Route path={routes.kitchenViewer} render={getRenderPropForRoute('kitchenViewer')} /> */}\n        {/* <Route path={routes.indexPage} render={getRenderPropForRoute('indexPage')} /> */}\n        {/* <Route path={routes.touchTableViewer} render={getRenderPropForRoute('touchTableViewer')} /> */}\n        {/* <Route path={routes.touchTable} render={getRenderPropForRoute('touchTable')} /> */}\n        {/* <Route path={routes.animatingLines} render={getRenderPropForRoute('animatingLines')} /> */}\n        {/* <Route path={routes.svgAnimator} render={getRenderPropForRoute('svgAnimator')} /> */}\n        {/* <Redirect to={routes.homePage} /> */}\n        <Redirect to={'/webmb'} />\n      </Switch>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n// import ReactDOMServer from 'react-dom/server';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('main'));\n// ReactDOM.hydrate(<App />, document.getElementById('main'));\n\n\n// console.log(ReactDOMServer.renderToString(<App />));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n// serviceWorker.register();\n","const serverPath = 'https://socketio-testing.herokuapp.com';\r\nconst serverPort = 443;\r\n// const serverPath = '//10.0.1.9';\r\n// const serverPort = 3000;\r\nexport {\r\n  serverPath,\r\n  serverPort\r\n};","import React from 'react';\r\nimport {useState, useEffect} from 'react';\r\nimport {useParams} from 'react-router-dom';\r\nimport * as THREE from 'three';\r\nimport OrbitControls from 'utils/vendor/orbitControls';\r\nimport {FBXLoader} from 'three/examples/jsm/loaders/FBXLoader';\r\n\r\nimport './fbxViewer.css';\r\n// import fbxUrl from 'media/models/Windows for Building department breaking.fbx';\r\n// import fbxUrl from 'media/models/windows.fbx';\r\n// import fbxUrl from 'media/models/190717_frying pan animationA(2).fbx';\r\n\r\n// import fbxUrl from 'media/models/190715_CLP_game(7).fbx';\r\n\r\n// const FBXLoader = require('three-fbxloader-offical');\r\n\r\nconst addShadowToChild = (object, scene) => {\r\n  // let camera = null;\r\n  // console.log(object.name);\r\n  object.traverse( function ( child ) {\r\n    // if (object !== child) {\r\n    //   child.children.forEach((c) =>\r\n    //     addShadowToChild(c, scene)\r\n    //   )\r\n    // }\r\n    if (child.isMesh) { // && child.scale.x === 0 && child.scale.y === 0 && child.scale.z === 0) {\r\n      // child.scale.x = 0.001;\r\n      // child.scale.y = 0.001;\r\n      // child.scale.z = 0.001;\r\n      child.material.side = THREE.FrontSide;\r\n      child.material.needsUpdate = true;\r\n      child.castShadow = true;\r\n      child.receiveShadow = true;\r\n    }\r\n  });\r\n  // return camera;\r\n}\r\n\r\nconst addShadowToRobotArm = (object) => {\r\n  object.traverse( function ( child ) {\r\n    if (child.isMesh) {\r\n      child.castShadow = false;\r\n      child.receiveShadow = true;\r\n    }\r\n  })\r\n}\r\n\r\nconst changeChildrenMaterialColor = (object, lvl = 0) => {\r\n  // let camera = null;\r\n  if (![\"Robot_Hand_1\", \"Hand\"].includes(object.name)) {\r\n    object.children.forEach( function ( child ) {\r\n      changeChildrenMaterialColor(child, lvl + 1);\r\n    });\r\n    if (object.isMesh) {\r\n      object.material.color = new THREE.Color(0.9098039216, 0.062745098, 0.678431373);\r\n    }\r\n  }\r\n  // return camera;\r\n}\r\nconst App = (props) => {\r\n  const [threeObjects, setThreeObjects] = useState({\r\n    scene: null,\r\n    camera: null,\r\n    containerEl: null,\r\n    renderer: null,\r\n    orbitControl: null,\r\n    raycaster: null,\r\n    clock: null,\r\n    mixer: null,\r\n  });\r\n  const [cameraPosition, setCameraPosition] = useState([0, 0, -10]);\r\n  const { fbxName } = useParams();\r\n  console.log(fbxName);\r\n  let containerEl = null;\r\n  let animationFrame = null;\r\n  const cameraDefaultPosition = [\r\n    [500, 500, 250],\r\n    [500, 500, -250],\r\n    [500, -500, -250],\r\n    [500, -500, 250],\r\n  ]\r\n  const setContainerEl = (ref) => containerEl = ref;\r\n  const initScene = () => {\r\n    const scene = new THREE.Scene();\r\n    scene.background = new THREE.Color(0x404040);\r\n    // scene.background = new THREE.Color(\"transparent\");\r\n    const camera = new THREE.PerspectiveCamera( 50, containerEl.offsetWidth / containerEl.offsetHeight, 0.1, 10000 );\r\n    // camera.position.set(500, 500, 250);\r\n    camera.lookAt(0, 0, 0);\r\n    camera.updateProjectionMatrix();\r\n    \r\n    // const pl100 = new THREE.PointLight(new THREE.Color(1,1,1), 1, 0, 0);\r\n    // pl100.position.set(45.925, 16.159, -95.215);\r\n    // pl100.castShadow = true;\r\n    // scene.add(pl100);\r\n\r\n    // const pl50c = new THREE.PointLight(new THREE.Color(1,1,1), 0.5, 0, 0);\r\n    // pl50c.position.set(0, 171.974, -107.009);\r\n    // pl50c.castShadow = true;\r\n    // scene.add(pl50c);\r\n\r\n    // const pl50b = new THREE.PointLight(new THREE.Color(1,1,1), 0.5, 0, 0);\r\n    // pl50b.position.set(-139.051, 98.463, -73.829);\r\n    // pl50b.castShadow = true;\r\n    // scene.add(pl50b);\r\n\r\n    // const pl50a = new THREE.PointLight(new THREE.Color(1,1,1), 0.5, 0, 0);\r\n    // pl50a.position.set(49.707, 56.062, -29.082);\r\n    // pl50a.castShadow = true;\r\n    // scene.add(pl50a);\r\n\r\n    const renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true } );\r\n    renderer.setPixelRatio( window.devicePixelRatio );\r\n    renderer.setSize( containerEl.offsetWidth, containerEl.offsetHeight );\r\n    renderer.setClearColor( 0xcccccc, 0 );\r\n    containerEl.appendChild( renderer.domElement );\r\n\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n    // renderer.shadowMap.type = THREE.VSMShadowMap;\r\n\r\n    // add control\r\n    const orbitControl = new OrbitControls( camera, renderer.domElement );\r\n    // dampling\r\n    // orbitControl.enableDamping = true;\r\n    // orbitControl.dampingFactor = 0.05;\r\n    // // to cancel out the super fast rotation after enabled damping\r\n    // // orbitControl.enableRotate = false;\r\n    // orbitControl.rotateSpeed = 0.02;\r\n    // orbitControl.autoRotateSpeed = 0.05;\r\n    \r\n    /**\r\n     * limit the vertical rotation\r\n     * https://stackoverflow.com/questions/25308943/limit-orbitcontrols-horizontal-rotation/25311658#25311658\r\n     **/ \r\n    // How far you can orbit vertically, upper and lower limits.\r\n    // Range is 0 to Math.PI radians\r\n    // orbitControl.minPolarAngle = Math.PI / 8;\r\n    // orbitControl.maxPolarAngle = Math.PI * 3 / 8;\r\n    // // How far you can orbit horizontally, upper and lower limits.\r\n    // // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\r\n    // orbitControl.minAzimuthAngle = Math.PI / 4;\r\n    // orbitControl.maxAzimuthAngle = Math.PI / 4; \r\n    \r\n    // // to disable zoom\r\n    // orbitControl.enableZoom = false;\r\n    // orbitControl.minDistance = 5;\r\n    // orbitControl.maxDistance = 5;\r\n    // to disable rotation\r\n    // orbitControl.enableRotate = false;\r\n    // to disable pan\r\n    // orbitControl.enablePan = false;\r\n    // orbitControl.panSpeed = 0.05;\r\n    // raycaster\r\n    const raycaster = new THREE.Raycaster(camera.position, new THREE.Vector3(0, 0, 0), 0, orbitControl.maxDistance * 2);\r\n\r\n    const clock = new THREE.Clock();\r\n\r\n    const loader = new FBXLoader();\r\n    let mixer = null;\r\n    loader.load(`./media/fbx/${fbxName}.fbx`, (object) => {\r\n      mixer = new THREE.AnimationMixer( object );\r\n      let action = null;\r\n      if (object.animations.length) {\r\n        action = mixer.clipAction( object.animations[ 0 ] );\r\n        action.play();\r\n      }\r\n      // action.loop = THREE.LoopOnce;\r\n      // action.clampWhenFinished = true;\r\n      // object.traverse( function ( child ) {\r\n      //   if ( child.isMesh ) {\r\n      //     child.castShadow = true;\r\n      //     child.receiveShadow = true;\r\n      //   }\r\n      // });\r\n      // debugger;\r\n      const cameraOfFbx = object.getObjectByName('Camera');\r\n      if (cameraOfFbx) {\r\n        setCameraPosition([\r\n          cameraOfFbx.position.x,\r\n          cameraOfFbx.position.y,\r\n          cameraOfFbx.position.z\r\n        ]);\r\n        camera.position.set(\r\n          cameraOfFbx.position.x,\r\n          cameraOfFbx.position.y,\r\n          cameraOfFbx.position.z\r\n        );\r\n      } else {\r\n        camera.position.set(\r\n          cameraPosition[0],\r\n          cameraPosition[1],\r\n          cameraPosition[2]\r\n        );\r\n        \r\n      }\r\n\r\n      for (let i = 'a'.charCodeAt(0); i <= 'z'.charCodeAt(0); i++) {\r\n        const currentChar = String.fromCharCode(i);\r\n        const videoElement = object.getObjectByName(`video${currentChar}`, true);\r\n        if (videoElement) {\r\n          const video = document.createElement('video');\r\n          video.oncanplay = () => {\r\n            video.play();\r\n          }\r\n          video.muted = true;\r\n          video.loop = true;\r\n          video.autoplay = true;\r\n          video.src = `./media/fbx/video${currentChar}.mp4`;\r\n          const texture = new THREE.VideoTexture( video );\r\n            texture.minFilter = THREE.LinearFilter;\r\n            texture.magFilter = THREE.LinearFilter;\r\n            texture.format = THREE.RGBFormat;\r\n            videoElement.material.map = texture;\r\n        }\r\n      }\r\n\r\n      // window.robotHand = object.getObjectByName(`Base_1_1`, true);\r\n\r\n      // hardcode the displacement map and the texture map\r\n      {\r\n        {\r\n          const videoElement = object.getObjectByName(`one`, true);\r\n          if (videoElement) {\r\n            const video = document.createElement('video');\r\n            video.oncanplay = () => {\r\n              video.play();\r\n            }\r\n            video.muted = true;\r\n            video.loop = true;\r\n            video.autoplay = true;\r\n            video.src = `./media/fbx/One.mp4`;\r\n            const texture = new THREE.VideoTexture( video );\r\n            texture.minFilter = THREE.LinearFilter;\r\n            texture.magFilter = THREE.LinearFilter;\r\n            texture.format = THREE.RGBFormat;\r\n            videoElement.material.displacementMap = texture;\r\n            videoElement.material.displacementScale = 10;\r\n          }\r\n        }\r\n        {\r\n          const videoElement = object.getObjectByName(`two`, true);\r\n          if (videoElement) {\r\n            const video = document.createElement('video');\r\n            video.oncanplay = () => {\r\n              video.play();\r\n            }\r\n            video.muted = true;\r\n            video.loop = true;\r\n            video.autoplay = true;\r\n            video.src = `./media/fbx/Two.mp4`;\r\n            const texture = new THREE.VideoTexture( video );\r\n              texture.minFilter = THREE.LinearFilter;\r\n              texture.magFilter = THREE.LinearFilter;\r\n              texture.format = THREE.RGBFormat;\r\n              videoElement.material.displacementMap = texture;\r\n              videoElement.material.displacementScale = 10;\r\n          }\r\n        }\r\n        {\r\n          const videoElement = object.getObjectByName(`three`, true);\r\n          if (videoElement) {\r\n            const video = document.createElement('video');\r\n            video.oncanplay = () => {\r\n              video.play();\r\n            }\r\n            video.muted = true;\r\n            video.loop = true;\r\n            video.autoplay = true;\r\n            video.src = `./media/fbx/Three.mp4`;\r\n            const texture = new THREE.VideoTexture( video );\r\n              texture.minFilter = THREE.LinearFilter;\r\n              texture.magFilter = THREE.LinearFilter;\r\n              texture.format = THREE.RGBFormat;\r\n              videoElement.material.displacementMap = texture;\r\n              videoElement.material.displacementScale = 10;\r\n              window.testEl = videoElement;\r\n              // videoElement.material.color = new THREE.Color(0.9098039216, 0.062745098, 0.678431373);\r\n          }\r\n        }\r\n        {\r\n          const videoElement = object.getObjectByName(`four`, true);\r\n          if (videoElement) {\r\n            const video = document.createElement('video');\r\n            video.oncanplay = () => {\r\n              video.play();\r\n            }\r\n            video.muted = true;\r\n            video.loop = true;\r\n            video.autoplay = true;\r\n            video.src = `./media/fbx/Four.mp4`;\r\n            const texture = new THREE.VideoTexture( video );\r\n              texture.minFilter = THREE.LinearFilter;\r\n              texture.magFilter = THREE.LinearFilter;\r\n              texture.format = THREE.RGBFormat;\r\n              videoElement.material.displacementMap = texture;\r\n              videoElement.material.displacementScale = 10;\r\n          }\r\n        }\r\n        {\r\n          const videoElement = object.getObjectByName(`Hand`, true);\r\n          if (videoElement) {\r\n            const video = document.createElement('video');\r\n            video.oncanplay = () => {\r\n              video.play();\r\n            }\r\n            video.muted = true;\r\n            video.loop = true;\r\n            video.autoplay = true;\r\n            video.src = `./media/fbx/Stone to gold.mp4`;\r\n            const texture = new THREE.VideoTexture( video );\r\n              texture.minFilter = THREE.LinearFilter;\r\n              texture.magFilter = THREE.LinearFilter;\r\n              texture.format = THREE.RGBFormat;\r\n              videoElement.material = new THREE.MeshBasicMaterial({\r\n                map: texture\r\n              });\r\n              // videoElement.material.map = texture;\r\n          }\r\n        }\r\n        // console.log(object);\r\n        changeChildrenMaterialColor(object);\r\n      }\r\n\r\n\r\n      addShadowToChild(object, scene);\r\n      \r\n      const robotArmEl = object.getObjectByName(`Robot_Hand_1`, true);\r\n      if (robotArmEl)\r\n        addShadowToRobotArm(robotArmEl);\r\n\r\n      const robotArmArmourEl = object.getObjectByName(`bbb`, true);\r\n      if (robotArmArmourEl) {\r\n        var robotArmArmourElTexture = new THREE.TextureLoader().load( './media/fbx/Color.jpg' );\r\n        robotArmArmourEl.material.emissiveMap = robotArmArmourElTexture;\r\n        robotArmArmourEl.material.emissive = new THREE.Color(1,1,1);\r\n        robotArmArmourEl.material.map = robotArmArmourElTexture;\r\n        robotArmArmourEl.material.color = new THREE.Color(1,1,1);\r\n      }\r\n\r\n      // atiq rock use\r\n      {\r\n        const rock = object.children[0];\r\n        var rockTexture = new THREE.TextureLoader().load( `./media/fbx/${fbxName}.jpg` );\r\n        rock.material = new THREE.MeshBasicMaterial();\r\n        // rock.material.map = rockTexture;\r\n        // rock.material.emissive = new THREE.Color(1,1,1);\r\n        rock.material.map = rockTexture;\r\n        rock.material.color = new THREE.Color(1,1,1);\r\n      }\r\n      switch (fbxName) {\r\n        case 'Fluorite':\r\n        case 'FluoriteD':\r\n        case 'FluoriteH':\r\n          object.position.set(0, 0, 18);\r\n          break;\r\n        case 'FossilizedFish':\r\n        case 'FossilizedFishD':\r\n        case 'FossilizedFishH':\r\n          object.position.set(0, 0, 9);\r\n          break;\r\n        case 'Okenite':\r\n        case 'OkeniteD':\r\n        case 'OkeniteH':\r\n          object.position.set(0, 0, 12);\r\n          break;\r\n        case 'PurpuriteH':\r\n        case 'PurpuriteM':\r\n        case 'PurpuriteL':\r\n          scene.background = new THREE.Color(0xafeeee);\r\n          break;\r\n        default:\r\n          object.position.set(0, 0, 0);\r\n      }\r\n      scene.add(object);\r\n\r\n\r\n      // camera.lookAt(object);\r\n      setThreeObjects((prevThreeObjects) => {\r\n        return {\r\n          ...prevThreeObjects,\r\n          mixer: mixer,\r\n          action: action,\r\n        }\r\n      })\r\n    }, (item) => {\r\n      // console.log( item, loaded, total );\r\n      console.log(item.loaded / item.total * 100 + '%');\r\n    }, (err) => {\r\n      console.log(err);\r\n    });\r\n    \r\n    setThreeObjects({\r\n      scene: scene,\r\n      camera: camera,\r\n      containerEl: containerEl,\r\n      renderer: renderer,\r\n      orbitControl: orbitControl,\r\n      raycaster: raycaster,\r\n      clock: clock,\r\n    })\r\n  }\r\n  const update = () => {\r\n    animationFrame = requestAnimationFrame(() => update());\r\n    // animationFrame = setTimeout(() => update(), 1000 / 30);\r\n    // fix the animation step to 30fps\r\n    // const delta = 1 / 30; //threeObjects.clock.getDelta();\r\n    const delta = threeObjects.clock.getDelta();\r\n    if (threeObjects.mixer) {\r\n      threeObjects.mixer.update(delta);\r\n    }\r\n    // try move camera to new position\r\n    // const newCamPos = cameraPosition;\r\n    // const oldCamPos = threeObjects.camera.position;\r\n    // if (newCamPos[0] !== oldCamPos.x ||\r\n    //   newCamPos[1] !== oldCamPos.y||\r\n    //   newCamPos[2] !== oldCamPos.z) {\r\n    //   oldCamPos.x = (newCamPos[0] - oldCamPos.x) * 0.15 + oldCamPos.x;\r\n    //   oldCamPos.y = (newCamPos[1] - oldCamPos.y) * 0.15 + oldCamPos.y;\r\n    //   oldCamPos.z = (newCamPos[2] - oldCamPos.z) * 0.15 + oldCamPos.z;\r\n    // }\r\n    threeObjects.orbitControl.update();\r\n    threeObjects.renderer.render( threeObjects.scene, threeObjects.camera );\r\n  };\r\n  // const doCameraAnimation = () => {\r\n  //   setCameraPosition((prevCameraPosition) => {\r\n  //     return (prevCameraPosition + 1) % cameraDefaultPosition.length;\r\n  //   });\r\n  // };\r\n  const onResize = () => {\r\n    threeObjects.camera.aspect = threeObjects.containerEl.offsetWidth / threeObjects.containerEl.offsetHeight;\r\n    threeObjects.camera.updateProjectionMatrix();\r\n    threeObjects.renderer.setSize( threeObjects.containerEl.offsetWidth, threeObjects.containerEl.offsetHeight );\r\n  }\r\n  useEffect(() => {\r\n    initScene();\r\n  }, []);\r\n  useEffect(() => {\r\n    window.addEventListener('resize', onResize);\r\n    return () => {\r\n      window.removeEventListener('resize', onResize);\r\n    }\r\n  }, [threeObjects])\r\n  useEffect(() => {\r\n    if (animationFrame)\r\n      // cancelAnimationFrame(animationFrame);\r\n      clearTimeout(animationFrame);\r\n    // console.log(threeObjects);\r\n    if (threeObjects.scene) {\r\n      animationFrame = setTimeout(() => update(), 1000 / 30);//update();\r\n    }\r\n    return () => {\r\n      if (animationFrame)\r\n        // cancelAnimationFrame(animationFrame);\r\n        clearTimeout(animationFrame);\r\n    }\r\n  }, [threeObjects, cameraPosition]);\r\n  const backToInitialView = () => {\r\n    threeObjects.orbitControl.reset();\r\n    threeObjects.camera.position.set(\r\n      cameraPosition[0],\r\n      cameraPosition[1],\r\n      cameraPosition[2]\r\n    );\r\n    debugger\r\n    threeObjects.camera.lookAt(threeObjects.scene.children[0].children[0]);\r\n  }\r\n  return <div ref={setContainerEl}\r\n    // onClick={doCameraAnimation}\r\n    className=\"threeCanvas\"\r\n    style={{\r\n      height: '100vh',\r\n    }}>\r\n    <div className=\"hintsText\">\r\n      <ul>\r\n        <li>Left button to rotate</li>\r\n        <li>Wheel button to zoom</li>\r\n        <li>Right button to pan</li>\r\n      </ul>\r\n      <div className=\"backToInitialView\"\r\n        onClick={backToInitialView}\r\n      >\r\n        Back to default view\r\n      </div>\r\n    </div>\r\n  </div>;\r\n}\r\n\r\nexport default App;","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Full-screen textured quad shader\n */\n\n\n\nvar CopyShader = {\n\n\tuniforms: {\n\n\t\t\"tDiffuse\": { value: null },\n\t\t\"opacity\":  { value: 1.0 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform float opacity;\",\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vec4 texel = texture2D( tDiffuse, vUv );\",\n\t\t\t\"gl_FragColor = opacity * texel;\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\nexport { CopyShader };\n","import {\n\tOrthographicCamera,\n\tPlaneBufferGeometry,\n\tMesh\n} from 'three';\n\nfunction Pass() {\n\n\t// if set to true, the pass is processed by the composer\n\tthis.enabled = true;\n\n\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\tthis.needsSwap = true;\n\n\t// if set to true, the pass clears its buffer before rendering\n\tthis.clear = false;\n\n\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\tthis.renderToScreen = false;\n\n}\n\nObject.assign( Pass.prototype, {\n\n\tsetSize: function ( /* width, height */ ) {},\n\n\trender: function ( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n} );\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nPass.FullScreenQuad = ( function () {\n\n\tvar camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tvar geometry = new PlaneBufferGeometry( 2, 2 );\n\n\tvar FullScreenQuad = function ( material ) {\n\n\t\tthis._mesh = new Mesh( geometry, material );\n\n\t};\n\n\tObject.defineProperty( FullScreenQuad.prototype, 'material', {\n\n\t\tget: function () {\n\n\t\t\treturn this._mesh.material;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tthis._mesh.material = value;\n\n\t\t}\n\n\t} );\n\n\tObject.assign( FullScreenQuad.prototype, {\n\n\t\trender: function ( renderer ) {\n\n\t\t\trenderer.render( this._mesh, camera );\n\n\t\t}\n\n\t} );\n\n\treturn FullScreenQuad;\n\n} )();\n\nexport { Pass };\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nimport {\n\tShaderMaterial,\n\tUniformsUtils\n} from 'three';\nimport { Pass } from \"utils/vendor/postprocessing/Pass.js\";\n\nvar ShaderPass = function ( shader, textureID ) {\n\n\tPass.call( this );\n\n\tthis.textureID = ( textureID !== undefined ) ? textureID : \"tDiffuse\";\n\n\tif ( shader instanceof ShaderMaterial ) {\n\n\t\tthis.uniforms = shader.uniforms;\n\n\t\tthis.material = shader;\n\n\t} else if ( shader ) {\n\n\t\tthis.uniforms = UniformsUtils.clone( shader.uniforms );\n\n\t\tthis.material = new ShaderMaterial( {\n\n\t\t\tdefines: Object.assign( {}, shader.defines ),\n\t\t\tuniforms: this.uniforms,\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader\n\n\t\t} );\n\n\t}\n\n\tthis.fsQuad = new Pass.FullScreenQuad( this.material );\n\n};\n\nShaderPass.prototype = Object.assign( Object.create( Pass.prototype ), {\n\n\tconstructor: ShaderPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tif ( this.uniforms[ this.textureID ] ) {\n\n\t\t\tthis.uniforms[ this.textureID ].value = readBuffer.texture;\n\n\t\t}\n\n\t\tthis.fsQuad.material = this.material;\n\n\t\tif ( this.renderToScreen ) {\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t} else {\n\n\t\t\trenderer.setRenderTarget( writeBuffer );\n\t\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\t\tthis.fsQuad.render( renderer );\n\n\t\t}\n\n\t}\n\n} );\n\nexport { ShaderPass };\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\n\nimport { Pass } from 'utils/vendor/postprocessing/Pass';\n\nvar MaskPass = function ( scene, camera ) {\n\n\tPass.call( this );\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.clear = true;\n\tthis.needsSwap = false;\n\n\tthis.inverse = false;\n\n};\n\nMaskPass.prototype = Object.assign( Object.create( Pass.prototype ), {\n\n\tconstructor: MaskPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tvar context = renderer.context;\n\t\tvar state = renderer.state;\n\n\t\t// don't update color or depth\n\n\t\tstate.buffers.color.setMask( false );\n\t\tstate.buffers.depth.setMask( false );\n\n\t\t// lock buffers\n\n\t\tstate.buffers.color.setLocked( true );\n\t\tstate.buffers.depth.setLocked( true );\n\n\t\t// set up stencil\n\n\t\tvar writeValue, clearValue;\n\n\t\tif ( this.inverse ) {\n\n\t\t\twriteValue = 0;\n\t\t\tclearValue = 1;\n\n\t\t} else {\n\n\t\t\twriteValue = 1;\n\t\t\tclearValue = 0;\n\n\t\t}\n\n\t\tstate.buffers.stencil.setTest( true );\n\t\tstate.buffers.stencil.setOp( context.REPLACE, context.REPLACE, context.REPLACE );\n\t\tstate.buffers.stencil.setFunc( context.ALWAYS, writeValue, 0xffffffff );\n\t\tstate.buffers.stencil.setClear( clearValue );\n\n\t\t// draw into the stencil buffer\n\n\t\trenderer.setRenderTarget( readBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\trenderer.setRenderTarget( writeBuffer );\n\t\tif ( this.clear ) renderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\t// unlock color and depth buffer for subsequent rendering\n\n\t\tstate.buffers.color.setLocked( false );\n\t\tstate.buffers.depth.setLocked( false );\n\n\t\t// only render where stencil is set to 1\n\n\t\tstate.buffers.stencil.setFunc( context.EQUAL, 1, 0xffffffff ); // draw if == 1\n\t\tstate.buffers.stencil.setOp( context.KEEP, context.KEEP, context.KEEP );\n\n\t}\n\n} );\n\n\nvar ClearMaskPass = function () {\n\n\tPass.call( this );\n\n\tthis.needsSwap = false;\n\n};\n\nClearMaskPass.prototype = Object.create( Pass.prototype );\n\nObject.assign( ClearMaskPass.prototype, {\n\n\trender: function ( renderer /*, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\trenderer.state.buffers.stencil.setTest( false );\n\n\t}\n\n} );\n\nexport { MaskPass, ClearMaskPass };\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nimport {\n\tClock,\n\tLinearFilter,\n\tMesh,\n\tOrthographicCamera,\n\tPlaneBufferGeometry,\n\tRGBAFormat,\n\tVector2,\n\tWebGLRenderTarget\n} from 'three';\nimport { CopyShader } from \"../shaders/CopyShader.js\";\nimport { ShaderPass } from \"../postprocessing/ShaderPass.js\";\nimport { MaskPass } from \"../postprocessing/MaskPass.js\";\nimport { ClearMaskPass } from \"../postprocessing/MaskPass.js\";\n\nvar EffectComposer = function ( renderer, renderTarget ) {\n\n\tthis.renderer = renderer;\n\n\tif ( renderTarget === undefined ) {\n\n\t\tvar parameters = {\n\t\t\tminFilter: LinearFilter,\n\t\t\tmagFilter: LinearFilter,\n\t\t\tformat: RGBAFormat,\n\t\t\tstencilBuffer: false\n\t\t};\n\n\t\tvar size = renderer.getSize( new Vector2() );\n\t\tthis._pixelRatio = renderer.getPixelRatio();\n\t\tthis._width = size.width;\n\t\tthis._height = size.height;\n\n\t\trenderTarget = new WebGLRenderTarget( this._width * this._pixelRatio, this._height * this._pixelRatio, parameters );\n\t\trenderTarget.texture.name = 'EffectComposer.rt1';\n\n\t} else {\n\n\t\tthis._pixelRatio = 1;\n\t\tthis._width = renderTarget.width;\n\t\tthis._height = renderTarget.height;\n\n\t}\n\n\tthis.renderTarget1 = renderTarget;\n\tthis.renderTarget2 = renderTarget.clone();\n\tthis.renderTarget2.texture.name = 'EffectComposer.rt2';\n\n\tthis.writeBuffer = this.renderTarget1;\n\tthis.readBuffer = this.renderTarget2;\n\n\tthis.renderToScreen = true;\n\n\tthis.passes = [];\n\n\t// dependencies\n\n\tif ( CopyShader === undefined ) {\n\n\t\tconsole.error( 'THREE.EffectComposer relies on CopyShader' );\n\n\t}\n\n\tif ( ShaderPass === undefined ) {\n\n\t\tconsole.error( 'THREE.EffectComposer relies on ShaderPass' );\n\n\t}\n\n\tthis.copyPass = new ShaderPass( CopyShader );\n\n\tthis.clock = new Clock();\n\n};\n\nObject.assign( EffectComposer.prototype, {\n\n\tswapBuffers: function () {\n\n\t\tvar tmp = this.readBuffer;\n\t\tthis.readBuffer = this.writeBuffer;\n\t\tthis.writeBuffer = tmp;\n\n\t},\n\n\taddPass: function ( pass ) {\n\n\t\tthis.passes.push( pass );\n\n\t\tvar size = this.renderer.getDrawingBufferSize( new Vector2() );\n\t\tpass.setSize( size.width, size.height );\n\n\t},\n\n\tinsertPass: function ( pass, index ) {\n\n\t\tthis.passes.splice( index, 0, pass );\n\n\t},\n\n\tisLastEnabledPass: function ( passIndex ) {\n\n\t\tfor ( var i = passIndex + 1; i < this.passes.length; i ++ ) {\n\n\t\t\tif ( this.passes[ i ].enabled ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\trender: function ( deltaTime ) {\n\n\t\t// deltaTime value is in seconds\n\n\t\tif ( deltaTime === undefined ) {\n\n\t\t\tdeltaTime = this.clock.getDelta();\n\n\t\t}\n\n\t\tvar currentRenderTarget = this.renderer.getRenderTarget();\n\n\t\tvar maskActive = false;\n\n\t\tvar pass, i, il = this.passes.length;\n\n\t\tfor ( i = 0; i < il; i ++ ) {\n\n\t\t\tpass = this.passes[ i ];\n\n\t\t\tif ( pass.enabled === false ) continue;\n\n\t\t\tpass.renderToScreen = ( this.renderToScreen && this.isLastEnabledPass( i ) );\n\t\t\tpass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive );\n\n\t\t\tif ( pass.needsSwap ) {\n\n\t\t\t\tif ( maskActive ) {\n\n\t\t\t\t\tvar context = this.renderer.context;\n\n\t\t\t\t\tcontext.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );\n\n\t\t\t\t\tthis.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime );\n\n\t\t\t\t\tcontext.stencilFunc( context.EQUAL, 1, 0xffffffff );\n\n\t\t\t\t}\n\n\t\t\t\tthis.swapBuffers();\n\n\t\t\t}\n\n\t\t\tif ( MaskPass !== undefined ) {\n\n\t\t\t\tif ( pass instanceof MaskPass ) {\n\n\t\t\t\t\tmaskActive = true;\n\n\t\t\t\t} else if ( pass instanceof ClearMaskPass ) {\n\n\t\t\t\t\tmaskActive = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.renderer.setRenderTarget( currentRenderTarget );\n\n\t},\n\n\treset: function ( renderTarget ) {\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\tvar size = this.renderer.getSize( new Vector2() );\n\t\t\tthis._pixelRatio = this.renderer.getPixelRatio();\n\t\t\tthis._width = size.width;\n\t\t\tthis._height = size.height;\n\n\t\t\trenderTarget = this.renderTarget1.clone();\n\t\t\trenderTarget.setSize( this._width * this._pixelRatio, this._height * this._pixelRatio );\n\n\t\t}\n\n\t\tthis.renderTarget1.dispose();\n\t\tthis.renderTarget2.dispose();\n\t\tthis.renderTarget1 = renderTarget;\n\t\tthis.renderTarget2 = renderTarget.clone();\n\n\t\tthis.writeBuffer = this.renderTarget1;\n\t\tthis.readBuffer = this.renderTarget2;\n\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tvar effectiveWidth = this._width * this._pixelRatio;\n\t\tvar effectiveHeight = this._height * this._pixelRatio;\n\n\t\tthis.renderTarget1.setSize( effectiveWidth, effectiveHeight );\n\t\tthis.renderTarget2.setSize( effectiveWidth, effectiveHeight );\n\n\t\tfor ( var i = 0; i < this.passes.length; i ++ ) {\n\n\t\t\tthis.passes[ i ].setSize( effectiveWidth, effectiveHeight );\n\n\t\t}\n\n\t},\n\n\tsetPixelRatio: function ( pixelRatio ) {\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this._width, this._height );\n\n\t}\n\n} );\n\n\nvar Pass = function () {\n\n\t// if set to true, the pass is processed by the composer\n\tthis.enabled = true;\n\n\t// if set to true, the pass indicates to swap read and write buffer after rendering\n\tthis.needsSwap = true;\n\n\t// if set to true, the pass clears its buffer before rendering\n\tthis.clear = false;\n\n\t// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.\n\tthis.renderToScreen = false;\n\n};\n\nObject.assign( Pass.prototype, {\n\n\tsetSize: function ( /* width, height */ ) {},\n\n\trender: function ( /* renderer, writeBuffer, readBuffer, deltaTime, maskActive */ ) {\n\n\t\tconsole.error( 'THREE.Pass: .render() must be implemented in derived pass.' );\n\n\t}\n\n} );\n\n// Helper for passes that need to fill the viewport with a single quad.\nPass.FullScreenQuad = ( function () {\n\n\tvar camera = new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\tvar geometry = new PlaneBufferGeometry( 2, 2 );\n\n\tvar FullScreenQuad = function ( material ) {\n\n\t\tthis._mesh = new Mesh( geometry, material );\n\n\t};\n\n\tObject.defineProperty( FullScreenQuad.prototype, 'material', {\n\n\t\tget: function () {\n\n\t\t\treturn this._mesh.material;\n\n\t\t},\n\n\t\tset: function ( value ) {\n\n\t\t\tthis._mesh.material = value;\n\n\t\t}\n\n\t} );\n\n\tObject.assign( FullScreenQuad.prototype, {\n\n\t\trender: function ( renderer ) {\n\n\t\t\trenderer.render( this._mesh, camera );\n\n\t\t}\n\n\t} );\n\n\treturn FullScreenQuad;\n\n} )();\n\nexport { EffectComposer, Pass };\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\n\nimport { Pass } from \"utils/vendor/postprocessing/Pass.js\";\n\nvar RenderPass = function ( scene, camera, overrideMaterial, clearColor, clearAlpha ) {\n\n\tPass.call( this );\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.overrideMaterial = overrideMaterial;\n\n\tthis.clearColor = clearColor;\n\tthis.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;\n\n\tthis.clear = true;\n\tthis.clearDepth = false;\n\tthis.needsSwap = false;\n\n};\n\nRenderPass.prototype = Object.assign( Object.create( Pass.prototype ), {\n\n\tconstructor: RenderPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer /*, deltaTime, maskActive */ ) {\n\n\t\tvar oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\tthis.scene.overrideMaterial = this.overrideMaterial;\n\n\t\tvar oldClearColor, oldClearAlpha;\n\n\t\tif ( this.clearColor ) {\n\n\t\t\toldClearColor = renderer.getClearColor().getHex();\n\t\t\toldClearAlpha = renderer.getClearAlpha();\n\n\t\t\trenderer.setClearColor( this.clearColor, this.clearAlpha );\n\n\t\t}\n\n\t\tif ( this.clearDepth ) {\n\n\t\t\trenderer.clearDepth();\n\n\t\t}\n\n\t\trenderer.setRenderTarget( this.renderToScreen ? null : readBuffer );\n\n\t\t// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600\n\t\tif ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\t\trenderer.render( this.scene, this.camera );\n\n\t\tif ( this.clearColor ) {\n\n\t\t\trenderer.setClearColor( oldClearColor, oldClearAlpha );\n\n\t\t}\n\n\t\tthis.scene.overrideMaterial = null;\n\t\trenderer.autoClear = oldAutoClear;\n\n\t}\n\n} );\n\nexport { RenderPass };\n","/**\n * TODO\n */\n\nimport {\n\tMatrix4,\n\tVector2\n} from 'three';\n\nvar SAOShader = {\n\tdefines: {\n\t\t'NUM_SAMPLES': 7,\n\t\t'NUM_RINGS': 4,\n\t\t'NORMAL_TEXTURE': 0,\n\t\t'DIFFUSE_TEXTURE': 0,\n\t\t'DEPTH_PACKING': 1,\n\t\t'PERSPECTIVE_CAMERA': 1\n\t},\n\tuniforms: {\n\n\t\t'tDepth': { value: null },\n\t\t'tDiffuse': { value: null },\n\t\t'tNormal': { value: null },\n\t\t'size': { value: new Vector2( 512, 512 ) },\n\n\t\t'cameraNear': { value: 1 },\n\t\t'cameraFar': { value: 100 },\n\t\t'cameraProjectionMatrix': { value: new Matrix4() },\n\t\t'cameraInverseProjectionMatrix': { value: new Matrix4() },\n\n\t\t'scale': { value: 1.0 },\n\t\t'intensity': { value: 0.1 },\n\t\t'bias': { value: 0.5 },\n\n\t\t'minResolution': { value: 0.0 },\n\t\t'kernelRadius': { value: 100.0 },\n\t\t'randomSeed': { value: 0.0 }\n\t},\n\tvertexShader: [\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\t\t\"\tvUv = uv;\",\n\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\tfragmentShader: [\n\t\t\"#include <common>\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"#if DIFFUSE_TEXTURE == 1\",\n\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\"#endif\",\n\n\t\t\"uniform sampler2D tDepth;\",\n\n\t\t\"#if NORMAL_TEXTURE == 1\",\n\t\t\"uniform sampler2D tNormal;\",\n\t\t\"#endif\",\n\n\t\t\"uniform float cameraNear;\",\n\t\t\"uniform float cameraFar;\",\n\t\t\"uniform mat4 cameraProjectionMatrix;\",\n\t\t\"uniform mat4 cameraInverseProjectionMatrix;\",\n\n\t\t\"uniform float scale;\",\n\t\t\"uniform float intensity;\",\n\t\t\"uniform float bias;\",\n\t\t\"uniform float kernelRadius;\",\n\t\t\"uniform float minResolution;\",\n\t\t\"uniform vec2 size;\",\n\t\t\"uniform float randomSeed;\",\n\n\t\t\"// RGBA depth\",\n\n\t\t\"#include <packing>\",\n\n\t\t\"vec4 getDefaultColor( const in vec2 screenPosition ) {\",\n\t\t\"\t#if DIFFUSE_TEXTURE == 1\",\n\t\t\"\treturn texture2D( tDiffuse, vUv );\",\n\t\t\"\t#else\",\n\t\t\"\treturn vec4( 1.0 );\",\n\t\t\"\t#endif\",\n\t\t\"}\",\n\n\t\t\"float getDepth( const in vec2 screenPosition ) {\",\n\t\t\"\t#if DEPTH_PACKING == 1\",\n\t\t\"\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\",\n\t\t\"\t#else\",\n\t\t\"\treturn texture2D( tDepth, screenPosition ).x;\",\n\t\t\"\t#endif\",\n\t\t\"}\",\n\n\t\t\"float getViewZ( const in float depth ) {\",\n\t\t\"\t#if PERSPECTIVE_CAMERA == 1\",\n\t\t\"\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\",\n\t\t\"\t#else\",\n\t\t\"\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\",\n\t\t\"\t#endif\",\n\t\t\"}\",\n\n\t\t\"vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {\",\n\t\t\"\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\",\n\t\t\"\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );\",\n\t\t\"\tclipPosition *= clipW; // unprojection.\",\n\n\t\t\"\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;\",\n\t\t\"}\",\n\n\t\t\"vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {\",\n\t\t\"\t#if NORMAL_TEXTURE == 1\",\n\t\t\"\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );\",\n\t\t\"\t#else\",\n\t\t\"\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );\",\n\t\t\"\t#endif\",\n\t\t\"}\",\n\n\t\t\"float scaleDividedByCameraFar;\",\n\t\t\"float minResolutionMultipliedByCameraFar;\",\n\n\t\t\"float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {\",\n\t\t\"\tvec3 viewDelta = sampleViewPosition - centerViewPosition;\",\n\t\t\"\tfloat viewDistance = length( viewDelta );\",\n\t\t\"\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;\",\n\n\t\t\"\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );\",\n\t\t\"}\",\n\n\t\t\"// moving costly divides into consts\",\n\t\t\"const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );\",\n\t\t\"const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );\",\n\n\t\t\"float getAmbientOcclusion( const in vec3 centerViewPosition ) {\",\n\t\t\"\t// precompute some variables require in getOcclusion.\",\n\t\t\"\tscaleDividedByCameraFar = scale / cameraFar;\",\n\t\t\"\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;\",\n\t\t\"\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );\",\n\n\t\t\"\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/\",\n\t\t\"\tfloat angle = rand( vUv + randomSeed ) * PI2;\",\n\t\t\"\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;\",\n\t\t\"\tvec2 radiusStep = radius;\",\n\n\t\t\"\tfloat occlusionSum = 0.0;\",\n\t\t\"\tfloat weightSum = 0.0;\",\n\n\t\t\"\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {\",\n\t\t\"\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;\",\n\t\t\"\t\tradius += radiusStep;\",\n\t\t\"\t\tangle += ANGLE_STEP;\",\n\n\t\t\"\t\tfloat sampleDepth = getDepth( sampleUv );\",\n\t\t\"\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {\",\n\t\t\"\t\t\tcontinue;\",\n\t\t\"\t\t}\",\n\n\t\t\"\t\tfloat sampleViewZ = getViewZ( sampleDepth );\",\n\t\t\"\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );\",\n\t\t\"\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );\",\n\t\t\"\t\tweightSum += 1.0;\",\n\t\t\"\t}\",\n\n\t\t\"\tif( weightSum == 0.0 ) discard;\",\n\n\t\t\"\treturn occlusionSum * ( intensity / weightSum );\",\n\t\t\"}\",\n\n\n\t\t\"void main() {\",\n\t\t\"\tfloat centerDepth = getDepth( vUv );\",\n\t\t\"\tif( centerDepth >= ( 1.0 - EPSILON ) ) {\",\n\t\t\"\t\tdiscard;\",\n\t\t\"\t}\",\n\n\t\t\"\tfloat centerViewZ = getViewZ( centerDepth );\",\n\t\t\"\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );\",\n\n\t\t\"\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );\",\n\n\t\t\"\tgl_FragColor = getDefaultColor( vUv );\",\n\t\t\"\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;\",\n\t\t\"}\"\n\t].join( \"\\n\" )\n};\n\nexport { SAOShader };\n","/**\n * TODO\n */\n\nimport {\n\tVector2\n} from 'three';\n\nvar DepthLimitedBlurShader = {\n\tdefines: {\n\t\t'KERNEL_RADIUS': 4,\n\t\t'DEPTH_PACKING': 1,\n\t\t'PERSPECTIVE_CAMERA': 1\n\t},\n\tuniforms: {\n\t\t'tDiffuse': { value: null },\n\t\t'size': { value: new Vector2( 512, 512 ) },\n\t\t'sampleUvOffsets': { value: [ new Vector2( 0, 0 ) ] },\n\t\t'sampleWeights': { value: [ 1.0 ] },\n\t\t'tDepth': { value: null },\n\t\t'cameraNear': { value: 10 },\n\t\t'cameraFar': { value: 1000 },\n\t\t'depthCutoff': { value: 10 },\n\t},\n\tvertexShader: [\n\t\t\"#include <common>\",\n\n\t\t\"uniform vec2 size;\",\n\n\t\t\"varying vec2 vUv;\",\n\t\t\"varying vec2 vInvSize;\",\n\n\t\t\"void main() {\",\n\t\t\"\tvUv = uv;\",\n\t\t\"\tvInvSize = 1.0 / size;\",\n\n\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\tfragmentShader: [\n\t\t\"#include <common>\",\n\t\t\"#include <packing>\",\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\t\t\"uniform sampler2D tDepth;\",\n\n\t\t\"uniform float cameraNear;\",\n\t\t\"uniform float cameraFar;\",\n\t\t\"uniform float depthCutoff;\",\n\n\t\t\"uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];\",\n\t\t\"uniform float sampleWeights[ KERNEL_RADIUS + 1 ];\",\n\n\t\t\"varying vec2 vUv;\",\n\t\t\"varying vec2 vInvSize;\",\n\n\t\t\"float getDepth( const in vec2 screenPosition ) {\",\n\t\t\"\t#if DEPTH_PACKING == 1\",\n\t\t\"\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\",\n\t\t\"\t#else\",\n\t\t\"\treturn texture2D( tDepth, screenPosition ).x;\",\n\t\t\"\t#endif\",\n\t\t\"}\",\n\n\t\t\"float getViewZ( const in float depth ) {\",\n\t\t\"\t#if PERSPECTIVE_CAMERA == 1\",\n\t\t\"\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\",\n\t\t\"\t#else\",\n\t\t\"\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\",\n\t\t\"\t#endif\",\n\t\t\"}\",\n\n\t\t\"void main() {\",\n\t\t\"\tfloat depth = getDepth( vUv );\",\n\t\t\"\tif( depth >= ( 1.0 - EPSILON ) ) {\",\n\t\t\"\t\tdiscard;\",\n\t\t\"\t}\",\n\n\t\t\"\tfloat centerViewZ = -getViewZ( depth );\",\n\t\t\"\tbool rBreak = false, lBreak = false;\",\n\n\t\t\"\tfloat weightSum = sampleWeights[0];\",\n\t\t\"\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;\",\n\n\t\t\"\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {\",\n\n\t\t\"\t\tfloat sampleWeight = sampleWeights[i];\",\n\t\t\"\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;\",\n\n\t\t\"\t\tvec2 sampleUv = vUv + sampleUvOffset;\",\n\t\t\"\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );\",\n\n\t\t\"\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;\",\n\n\t\t\"\t\tif( ! rBreak ) {\",\n\t\t\"\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;\",\n\t\t\"\t\t\tweightSum += sampleWeight;\",\n\t\t\"\t\t}\",\n\n\t\t\"\t\tsampleUv = vUv - sampleUvOffset;\",\n\t\t\"\t\tviewZ = -getViewZ( getDepth( sampleUv ) );\",\n\n\t\t\"\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;\",\n\n\t\t\"\t\tif( ! lBreak ) {\",\n\t\t\"\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;\",\n\t\t\"\t\t\tweightSum += sampleWeight;\",\n\t\t\"\t\t}\",\n\n\t\t\"\t}\",\n\n\t\t\"\tgl_FragColor = diffuseSum / weightSum;\",\n\t\t\"}\"\n\t].join( \"\\n\" )\n};\n\nvar BlurShaderUtils = {\n\n\tcreateSampleWeights: function ( kernelRadius, stdDev ) {\n\n\t\tvar gaussian = function ( x, stdDev ) {\n\n\t\t\treturn Math.exp( - ( x * x ) / ( 2.0 * ( stdDev * stdDev ) ) ) / ( Math.sqrt( 2.0 * Math.PI ) * stdDev );\n\n\t\t};\n\n\t\tvar weights = [];\n\n\t\tfor ( var i = 0; i <= kernelRadius; i ++ ) {\n\n\t\t\tweights.push( gaussian( i, stdDev ) );\n\n\t\t}\n\n\t\treturn weights;\n\n\t},\n\n\tcreateSampleOffsets: function ( kernelRadius, uvIncrement ) {\n\n\t\tvar offsets = [];\n\n\t\tfor ( var i = 0; i <= kernelRadius; i ++ ) {\n\n\t\t\toffsets.push( uvIncrement.clone().multiplyScalar( i ) );\n\n\t\t}\n\n\t\treturn offsets;\n\n\t},\n\n\tconfigure: function ( material, kernelRadius, stdDev, uvIncrement ) {\n\n\t\tmaterial.defines[ 'KERNEL_RADIUS' ] = kernelRadius;\n\t\tmaterial.uniforms[ 'sampleUvOffsets' ].value = BlurShaderUtils.createSampleOffsets( kernelRadius, uvIncrement );\n\t\tmaterial.uniforms[ 'sampleWeights' ].value = BlurShaderUtils.createSampleWeights( kernelRadius, stdDev );\n\t\tmaterial.needsUpdate = true;\n\n\t}\n\n};\n\nexport { DepthLimitedBlurShader, BlurShaderUtils };\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Unpack RGBA depth shader\n * - show RGBA encoded depth as monochrome color\n */\n\n\n\nvar UnpackDepthRGBAShader = {\n\n\tuniforms: {\n\n\t\t\"tDiffuse\": { value: null },\n\t\t\"opacity\": { value: 1.0 }\n\n\t},\n\n\tvertexShader: [\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"vUv = uv;\",\n\t\t\t\"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" ),\n\n\tfragmentShader: [\n\n\t\t\"uniform float opacity;\",\n\n\t\t\"uniform sampler2D tDiffuse;\",\n\n\t\t\"varying vec2 vUv;\",\n\n\t\t\"#include <packing>\",\n\n\t\t\"void main() {\",\n\n\t\t\t\"float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );\",\n\t\t\t\"gl_FragColor = vec4( vec3( depth ), opacity );\",\n\n\t\t\"}\"\n\n\t].join( \"\\n\" )\n\n};\n\nexport { UnpackDepthRGBAShader };\n","/**\n * @author ludobaka / ludobaka.github.io\n * SAO implementation inspired from bhouston previous SAO work\n */\n\nimport {\n\tAddEquation,\n\tColor,\n\tCustomBlending,\n\tDepthTexture,\n\tDstAlphaFactor,\n\tDstColorFactor,\n\tLinearFilter,\n\tMeshDepthMaterial,\n\tMeshNormalMaterial,\n\tNearestFilter,\n\tNoBlending,\n\tRGBADepthPacking,\n\tRGBAFormat,\n\tShaderMaterial,\n\tUniformsUtils,\n\tUnsignedShortType,\n\tVector2,\n\tWebGLRenderTarget,\n\tZeroFactor\n} from 'three';\nimport { Pass } from \"../postprocessing/Pass.js\";\nimport { SAOShader } from \"../shaders/SAOShader.js\";\nimport { DepthLimitedBlurShader, BlurShaderUtils } from \"../shaders/DepthLimitedBlurShader.js\";\nimport { CopyShader } from \"../shaders/CopyShader.js\";\nimport { UnpackDepthRGBAShader } from \"../shaders/UnpackDepthRGBAShader.js\";\n\nvar SAOPass = function ( scene, camera, depthTexture, useNormals, resolution ) {\n\n\tPass.call( this );\n\n\tthis.scene = scene;\n\tthis.camera = camera;\n\n\tthis.clear = true;\n\tthis.needsSwap = false;\n\n\tthis.supportsDepthTextureExtension = ( depthTexture !== undefined ) ? depthTexture : false;\n\tthis.supportsNormalTexture = ( useNormals !== undefined ) ? useNormals : false;\n\n\tthis.originalClearColor = new Color();\n\tthis.oldClearColor = new Color();\n\tthis.oldClearAlpha = 1;\n\n\tthis.params = {\n\t\toutput: 0,\n\t\tsaoBias: 0.5,\n\t\tsaoIntensity: 0.18,\n\t\tsaoScale: 1,\n\t\tsaoKernelRadius: 100,\n\t\tsaoMinResolution: 0,\n\t\tsaoBlur: true,\n\t\tsaoBlurRadius: 8,\n\t\tsaoBlurStdDev: 4,\n\t\tsaoBlurDepthCutoff: 0.01\n\t};\n\n\tthis.resolution = ( resolution !== undefined ) ? new Vector2( resolution.x, resolution.y ) : new Vector2( 256, 256 );\n\n\tthis.saoRenderTarget = new WebGLRenderTarget( this.resolution.x, this.resolution.y, {\n\t\tminFilter: LinearFilter,\n\t\tmagFilter: LinearFilter,\n\t\tformat: RGBAFormat\n\t} );\n\tthis.blurIntermediateRenderTarget = this.saoRenderTarget.clone();\n\tthis.beautyRenderTarget = this.saoRenderTarget.clone();\n\n\tthis.normalRenderTarget = new WebGLRenderTarget( this.resolution.x, this.resolution.y, {\n\t\tminFilter: NearestFilter,\n\t\tmagFilter: NearestFilter,\n\t\tformat: RGBAFormat\n\t} );\n\tthis.depthRenderTarget = this.normalRenderTarget.clone();\n\n\tif ( this.supportsDepthTextureExtension ) {\n\n\t\tvar depthTexture = new DepthTexture();\n\t\tdepthTexture.type = UnsignedShortType;\n\t\tdepthTexture.minFilter = NearestFilter;\n\t\tdepthTexture.maxFilter = NearestFilter;\n\n\t\tthis.beautyRenderTarget.depthTexture = depthTexture;\n\t\tthis.beautyRenderTarget.depthBuffer = true;\n\n\t}\n\n\tthis.depthMaterial = new MeshDepthMaterial();\n\tthis.depthMaterial.depthPacking = RGBADepthPacking;\n\tthis.depthMaterial.blending = NoBlending;\n\n\tthis.normalMaterial = new MeshNormalMaterial();\n\tthis.normalMaterial.blending = NoBlending;\n\n\tif ( SAOShader === undefined ) {\n\n\t\tconsole.error( 'THREE.SAOPass relies on SAOShader' );\n\n\t}\n\n\tthis.saoMaterial = new ShaderMaterial( {\n\t\tdefines: Object.assign( {}, SAOShader.defines ),\n\t\tfragmentShader: SAOShader.fragmentShader,\n\t\tvertexShader: SAOShader.vertexShader,\n\t\tuniforms: UniformsUtils.clone( SAOShader.uniforms )\n\t} );\n\tthis.saoMaterial.extensions.derivatives = true;\n\tthis.saoMaterial.defines[ 'DEPTH_PACKING' ] = this.supportsDepthTextureExtension ? 0 : 1;\n\tthis.saoMaterial.defines[ 'NORMAL_TEXTURE' ] = this.supportsNormalTexture ? 1 : 0;\n\tthis.saoMaterial.defines[ 'PERSPECTIVE_CAMERA' ] = this.camera.isPerspectiveCamera ? 1 : 0;\n\tthis.saoMaterial.uniforms[ 'tDepth' ].value = ( this.supportsDepthTextureExtension ) ? depthTexture : this.depthRenderTarget.texture;\n\tthis.saoMaterial.uniforms[ 'tNormal' ].value = this.normalRenderTarget.texture;\n\tthis.saoMaterial.uniforms[ 'size' ].value.set( this.resolution.x, this.resolution.y );\n\tthis.saoMaterial.uniforms[ 'cameraInverseProjectionMatrix' ].value.getInverse( this.camera.projectionMatrix );\n\tthis.saoMaterial.uniforms[ 'cameraProjectionMatrix' ].value = this.camera.projectionMatrix;\n\tthis.saoMaterial.blending = NoBlending;\n\n\tif ( DepthLimitedBlurShader === undefined ) {\n\n\t\tconsole.error( 'THREE.SAOPass relies on DepthLimitedBlurShader' );\n\n\t}\n\n\tthis.vBlurMaterial = new ShaderMaterial( {\n\t\tuniforms: UniformsUtils.clone( DepthLimitedBlurShader.uniforms ),\n\t\tdefines: Object.assign( {}, DepthLimitedBlurShader.defines ),\n\t\tvertexShader: DepthLimitedBlurShader.vertexShader,\n\t\tfragmentShader: DepthLimitedBlurShader.fragmentShader\n\t} );\n\tthis.vBlurMaterial.defines[ 'DEPTH_PACKING' ] = this.supportsDepthTextureExtension ? 0 : 1;\n\tthis.vBlurMaterial.defines[ 'PERSPECTIVE_CAMERA' ] = this.camera.isPerspectiveCamera ? 1 : 0;\n\tthis.vBlurMaterial.uniforms[ 'tDiffuse' ].value = this.saoRenderTarget.texture;\n\tthis.vBlurMaterial.uniforms[ 'tDepth' ].value = ( this.supportsDepthTextureExtension ) ? depthTexture : this.depthRenderTarget.texture;\n\tthis.vBlurMaterial.uniforms[ 'size' ].value.set( this.resolution.x, this.resolution.y );\n\tthis.vBlurMaterial.blending = NoBlending;\n\n\tthis.hBlurMaterial = new ShaderMaterial( {\n\t\tuniforms: UniformsUtils.clone( DepthLimitedBlurShader.uniforms ),\n\t\tdefines: Object.assign( {}, DepthLimitedBlurShader.defines ),\n\t\tvertexShader: DepthLimitedBlurShader.vertexShader,\n\t\tfragmentShader: DepthLimitedBlurShader.fragmentShader\n\t} );\n\tthis.hBlurMaterial.defines[ 'DEPTH_PACKING' ] = this.supportsDepthTextureExtension ? 0 : 1;\n\tthis.hBlurMaterial.defines[ 'PERSPECTIVE_CAMERA' ] = this.camera.isPerspectiveCamera ? 1 : 0;\n\tthis.hBlurMaterial.uniforms[ 'tDiffuse' ].value = this.blurIntermediateRenderTarget.texture;\n\tthis.hBlurMaterial.uniforms[ 'tDepth' ].value = ( this.supportsDepthTextureExtension ) ? depthTexture : this.depthRenderTarget.texture;\n\tthis.hBlurMaterial.uniforms[ 'size' ].value.set( this.resolution.x, this.resolution.y );\n\tthis.hBlurMaterial.blending = NoBlending;\n\n\tif ( CopyShader === undefined ) {\n\n\t\tconsole.error( 'THREE.SAOPass relies on CopyShader' );\n\n\t}\n\n\tthis.materialCopy = new ShaderMaterial( {\n\t\tuniforms: UniformsUtils.clone( CopyShader.uniforms ),\n\t\tvertexShader: CopyShader.vertexShader,\n\t\tfragmentShader: CopyShader.fragmentShader,\n\t\tblending: NoBlending\n\t} );\n\tthis.materialCopy.transparent = true;\n\tthis.materialCopy.depthTest = false;\n\tthis.materialCopy.depthWrite = false;\n\tthis.materialCopy.blending = CustomBlending;\n\tthis.materialCopy.blendSrc = DstColorFactor;\n\tthis.materialCopy.blendDst = ZeroFactor;\n\tthis.materialCopy.blendEquation = AddEquation;\n\tthis.materialCopy.blendSrcAlpha = DstAlphaFactor;\n\tthis.materialCopy.blendDstAlpha = ZeroFactor;\n\tthis.materialCopy.blendEquationAlpha = AddEquation;\n\n\tif ( UnpackDepthRGBAShader === undefined ) {\n\n\t\tconsole.error( 'THREE.SAOPass relies on UnpackDepthRGBAShader' );\n\n\t}\n\n\tthis.depthCopy = new ShaderMaterial( {\n\t\tuniforms: UniformsUtils.clone( UnpackDepthRGBAShader.uniforms ),\n\t\tvertexShader: UnpackDepthRGBAShader.vertexShader,\n\t\tfragmentShader: UnpackDepthRGBAShader.fragmentShader,\n\t\tblending: NoBlending\n\t} );\n\n\tthis.fsQuad = new Pass.FullScreenQuad( null );\n\n};\n\nSAOPass.OUTPUT = {\n\t'Beauty': 1,\n\t'Default': 0,\n\t'SAO': 2,\n\t'Depth': 3,\n\t'Normal': 4\n};\n\nSAOPass.prototype = Object.assign( Object.create( Pass.prototype ), {\n\tconstructor: SAOPass,\n\n\trender: function ( renderer, writeBuffer, readBuffer/*, deltaTime, maskActive*/ ) {\n\n\t\t// Rendering readBuffer first when rendering to screen\n\t\tif ( this.renderToScreen ) {\n\n\t\t\tthis.materialCopy.blending = NoBlending;\n\t\t\tthis.materialCopy.uniforms[ 'tDiffuse' ].value = readBuffer.texture;\n\t\t\tthis.materialCopy.needsUpdate = true;\n\t\t\tthis.renderPass( renderer, this.materialCopy, null );\n\n\t\t}\n\n\t\tif ( this.params.output === 1 ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.oldClearColor.copy( renderer.getClearColor() );\n\t\tthis.oldClearAlpha = renderer.getClearAlpha();\n\t\tvar oldAutoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\n\t\trenderer.setRenderTarget( this.depthRenderTarget );\n\t\trenderer.clear();\n\n\t\tthis.saoMaterial.uniforms[ 'bias' ].value = this.params.saoBias;\n\t\tthis.saoMaterial.uniforms[ 'intensity' ].value = this.params.saoIntensity;\n\t\tthis.saoMaterial.uniforms[ 'scale' ].value = this.params.saoScale;\n\t\tthis.saoMaterial.uniforms[ 'kernelRadius' ].value = this.params.saoKernelRadius;\n\t\tthis.saoMaterial.uniforms[ 'minResolution' ].value = this.params.saoMinResolution;\n\t\tthis.saoMaterial.uniforms[ 'cameraNear' ].value = this.camera.near;\n\t\tthis.saoMaterial.uniforms[ 'cameraFar' ].value = this.camera.far;\n\t\t// this.saoMaterial.uniforms['randomSeed'].value = Math.random();\n\n\t\tvar depthCutoff = this.params.saoBlurDepthCutoff * ( this.camera.far - this.camera.near );\n\t\tthis.vBlurMaterial.uniforms[ 'depthCutoff' ].value = depthCutoff;\n\t\tthis.hBlurMaterial.uniforms[ 'depthCutoff' ].value = depthCutoff;\n\n\t\tthis.vBlurMaterial.uniforms[ 'cameraNear' ].value = this.camera.near;\n\t\tthis.vBlurMaterial.uniforms[ 'cameraFar' ].value = this.camera.far;\n\t\tthis.hBlurMaterial.uniforms[ 'cameraNear' ].value = this.camera.near;\n\t\tthis.hBlurMaterial.uniforms[ 'cameraFar' ].value = this.camera.far;\n\n\t\tthis.params.saoBlurRadius = Math.floor( this.params.saoBlurRadius );\n\t\tif ( ( this.prevStdDev !== this.params.saoBlurStdDev ) || ( this.prevNumSamples !== this.params.saoBlurRadius ) ) {\n\n\t\t\tBlurShaderUtils.configure( this.vBlurMaterial, this.params.saoBlurRadius, this.params.saoBlurStdDev, new Vector2( 0, 1 ) );\n\t\t\tBlurShaderUtils.configure( this.hBlurMaterial, this.params.saoBlurRadius, this.params.saoBlurStdDev, new Vector2( 1, 0 ) );\n\t\t\tthis.prevStdDev = this.params.saoBlurStdDev;\n\t\t\tthis.prevNumSamples = this.params.saoBlurRadius;\n\n\t\t}\n\n\t\t// Rendering scene to depth texture\n\t\trenderer.setClearColor( 0x000000 );\n\t\trenderer.setRenderTarget( this.beautyRenderTarget );\n\t\trenderer.clear();\n\t\trenderer.render( this.scene, this.camera );\n\n\t\t// Re-render scene if depth texture extension is not supported\n\t\tif ( ! this.supportsDepthTextureExtension ) {\n\n\t\t\t// Clear rule : far clipping plane in both RGBA and Basic encoding\n\t\t\tthis.renderOverride( renderer, this.depthMaterial, this.depthRenderTarget, 0x000000, 1.0 );\n\n\t\t}\n\n\t\tif ( this.supportsNormalTexture ) {\n\n\t\t\t// Clear rule : default normal is facing the camera\n\t\t\tthis.renderOverride( renderer, this.normalMaterial, this.normalRenderTarget, 0x7777ff, 1.0 );\n\n\t\t}\n\n\t\t// Rendering SAO texture\n\t\tthis.renderPass( renderer, this.saoMaterial, this.saoRenderTarget, 0xffffff, 1.0 );\n\n\t\t// Blurring SAO texture\n\t\tif ( this.params.saoBlur ) {\n\n\t\t\tthis.renderPass( renderer, this.vBlurMaterial, this.blurIntermediateRenderTarget, 0xffffff, 1.0 );\n\t\t\tthis.renderPass( renderer, this.hBlurMaterial, this.saoRenderTarget, 0xffffff, 1.0 );\n\n\t\t}\n\n\t\tvar outputMaterial = this.materialCopy;\n\t\t// Setting up SAO rendering\n\t\tif ( this.params.output === 3 ) {\n\n\t\t\tif ( this.supportsDepthTextureExtension ) {\n\n\t\t\t\tthis.materialCopy.uniforms[ 'tDiffuse' ].value = this.beautyRenderTarget.depthTexture;\n\t\t\t\tthis.materialCopy.needsUpdate = true;\n\n\t\t\t} else {\n\n\t\t\t\tthis.depthCopy.uniforms[ 'tDiffuse' ].value = this.depthRenderTarget.texture;\n\t\t\t\tthis.depthCopy.needsUpdate = true;\n\t\t\t\toutputMaterial = this.depthCopy;\n\n\t\t\t}\n\n\t\t} else if ( this.params.output === 4 ) {\n\n\t\t\tthis.materialCopy.uniforms[ 'tDiffuse' ].value = this.normalRenderTarget.texture;\n\t\t\tthis.materialCopy.needsUpdate = true;\n\n\t\t} else {\n\n\t\t\tthis.materialCopy.uniforms[ 'tDiffuse' ].value = this.saoRenderTarget.texture;\n\t\t\tthis.materialCopy.needsUpdate = true;\n\n\t\t}\n\n\t\t// Blending depends on output, only want a CustomBlending when showing SAO\n\t\tif ( this.params.output === 0 ) {\n\n\t\t\toutputMaterial.blending = CustomBlending;\n\n\t\t} else {\n\n\t\t\toutputMaterial.blending = NoBlending;\n\n\t\t}\n\n\t\t// Rendering SAOPass result on top of previous pass\n\t\tthis.renderPass( renderer, outputMaterial, this.renderToScreen ? null : readBuffer );\n\n\t\trenderer.setClearColor( this.oldClearColor, this.oldClearAlpha );\n\t\trenderer.autoClear = oldAutoClear;\n\n\t},\n\n\trenderPass: function ( renderer, passMaterial, renderTarget, clearColor, clearAlpha ) {\n\n\t\t// save original state\n\t\tthis.originalClearColor.copy( renderer.getClearColor() );\n\t\tvar originalClearAlpha = renderer.getClearAlpha();\n\t\tvar originalAutoClear = renderer.autoClear;\n\n\t\trenderer.setRenderTarget( renderTarget );\n\n\t\t// setup pass state\n\t\trenderer.autoClear = false;\n\t\tif ( ( clearColor !== undefined ) && ( clearColor !== null ) ) {\n\n\t\t\trenderer.setClearColor( clearColor );\n\t\t\trenderer.setClearAlpha( clearAlpha || 0.0 );\n\t\t\trenderer.clear();\n\n\t\t}\n\n\t\tthis.fsQuad.material = passMaterial;\n\t\tthis.fsQuad.render( renderer );\n\n\t\t// restore original state\n\t\trenderer.autoClear = originalAutoClear;\n\t\trenderer.setClearColor( this.originalClearColor );\n\t\trenderer.setClearAlpha( originalClearAlpha );\n\n\t},\n\n\trenderOverride: function ( renderer, overrideMaterial, renderTarget, clearColor, clearAlpha ) {\n\n\t\tthis.originalClearColor.copy( renderer.getClearColor() );\n\t\tvar originalClearAlpha = renderer.getClearAlpha();\n\t\tvar originalAutoClear = renderer.autoClear;\n\n\t\trenderer.setRenderTarget( renderTarget );\n\t\trenderer.autoClear = false;\n\n\t\tclearColor = overrideMaterial.clearColor || clearColor;\n\t\tclearAlpha = overrideMaterial.clearAlpha || clearAlpha;\n\t\tif ( ( clearColor !== undefined ) && ( clearColor !== null ) ) {\n\n\t\t\trenderer.setClearColor( clearColor );\n\t\t\trenderer.setClearAlpha( clearAlpha || 0.0 );\n\t\t\trenderer.clear();\n\n\t\t}\n\n\t\tthis.scene.overrideMaterial = overrideMaterial;\n\t\trenderer.render( this.scene, this.camera );\n\t\tthis.scene.overrideMaterial = null;\n\n\t\t// restore original state\n\t\trenderer.autoClear = originalAutoClear;\n\t\trenderer.setClearColor( this.originalClearColor );\n\t\trenderer.setClearAlpha( originalClearAlpha );\n\n\t},\n\n\tsetSize: function ( width, height ) {\n\n\t\tthis.beautyRenderTarget.setSize( width, height );\n\t\tthis.saoRenderTarget.setSize( width, height );\n\t\tthis.blurIntermediateRenderTarget.setSize( width, height );\n\t\tthis.normalRenderTarget.setSize( width, height );\n\t\tthis.depthRenderTarget.setSize( width, height );\n\n\t\tthis.saoMaterial.uniforms[ 'size' ].value.set( width, height );\n\t\tthis.saoMaterial.uniforms[ 'cameraInverseProjectionMatrix' ].value.getInverse( this.camera.projectionMatrix );\n\t\tthis.saoMaterial.uniforms[ 'cameraProjectionMatrix' ].value = this.camera.projectionMatrix;\n\t\tthis.saoMaterial.needsUpdate = true;\n\n\t\tthis.vBlurMaterial.uniforms[ 'size' ].value.set( width, height );\n\t\tthis.vBlurMaterial.needsUpdate = true;\n\n\t\tthis.hBlurMaterial.uniforms[ 'size' ].value.set( width, height );\n\t\tthis.hBlurMaterial.needsUpdate = true;\n\n\t}\n\n} );\n\nexport { SAOPass };\n","import React from 'react';\r\nimport {useState, useEffect} from 'react';\r\nimport * as THREE from 'three';\r\nimport OrbitControls from 'utils/vendor/orbitControls';\r\n\r\nimport { EffectComposer } from 'utils/vendor/postprocessing/EffectComposer';\r\nimport { RenderPass } from 'utils/vendor/postprocessing/RenderPass';\r\nimport { SAOPass } from 'utils/vendor/postprocessing/SAOPass';\r\n\r\nimport fbxUrl from 'media/models/190715_CLP_game(8).fbx';\r\n// import fbxUrl from 'media/models/190715_CLP_game(8)_bakelight.fbx';\r\n\r\nimport meatUrl from 'media/textures/meat.png';\r\nimport mildMeatUrl from 'media/textures/mid_meat.png';\r\nimport welldoneMeatUrl from 'media/textures/welldone_meat.png';\r\n\r\n// import fpsRenderer from 'components/fpsRenderer';\r\n\r\nimport './kitchenViewer.css';\r\n\r\nconst FBXLoader = require('three-fbxloader-offical');\r\n\r\nconst addShadowToChild = (object, scene) => {\r\n  let camera = null;\r\n  object.traverse( function ( child ) {\r\n    if (object !== child) {\r\n      addShadowToChild(child, scene);\r\n    }\r\n    // if ( child.isMesh ) {\r\n      \r\n      // child.need\r\n    // }\r\n    if (child.isPointLight) {\r\n      // const lightHelper = new THREE.PointLightHelper( child, 10 );\r\n      // scene.add(lightHelper);\r\n      child.castShadow = false;\r\n      child.intensity = 1;\r\n    } else if (child.isDirectionalLight) {\r\n      child.castShadow = true;\r\n      // child.receiveShadow = true;\r\n      child.shadow.mapSize.width = 1024;\r\n      child.shadow.mapSize.height = 1024;\r\n      child.shadow.camera.near = 0.5;    // default\r\n      child.shadow.camera.far = 5000;     // default\r\n      child.shadow.camera.left = -1000;\r\n      child.shadow.camera.right = 1000;\r\n      child.shadow.camera.bottom = -1000;\r\n      child.shadow.camera.top = 1000;\r\n      child.intensity = 1;\r\n      child.position.y = 340;\r\n      child.position.z = -150;\r\n      // const lightHelper = new THREE.DirectionalLightHelper( child, 10 );\r\n      // scene.add(lightHelper);\r\n    } else if (child.isCamera) {\r\n      camera = child;\r\n    } else if (child.children.length ===0) {\r\n      child.castShadow = true;\r\n      child.receiveShadow = true;\r\n    }\r\n  });\r\n  return camera;\r\n}\r\n\r\nconst executeCrossFade = (startAction, endAction, duration) => {\r\n  endAction.enabled = true;\r\n  endAction.setEffectiveTimeScale(1);\r\n  endAction.setEffectiveWeight(1);\r\n  endAction.time = 0;\r\n  startAction.crossFadeTo( endAction, duration, true );\r\n}\r\nconst pansLoader = (roomLoaded, progressCallback) => {\r\n  const loader = new FBXLoader();\r\n  const pans = [\r\n    [\r\n      require('media/models/190717_frying pan animationA_shake.fbx'),\r\n      require('media/models/190717_frying pan animationA_flip.fbx')\r\n    ],\r\n    [\r\n      require('media/models/190717_frying pan animationB_shake.fbx'),\r\n      require('media/models/190717_frying pan animationB_flip.fbx')\r\n    ],\r\n    [\r\n      require('media/models/190717_frying pan animationC_shake.fbx'),\r\n      require('media/models/190717_frying pan animationC_flip.fbx')\r\n    ]\r\n  ];\r\n  // 3 pans, fbx specific\r\n  const pansNameMapping = [\r\n    {\r\n      panName: 'frying_pan_A',\r\n      tracksRename: {\r\n        'Meat_A__Copy_.position': 'Meat_A.position',\r\n        'Meat_A__Copy_.quaternion': 'Meat_A.quaternion',\r\n        'frying_pan_A_2.position': 'frying_pan_A_2.position',\r\n        'frying_pan_A_2.quaternion': 'frying_pan_A_2.quaternion'\r\n      }\r\n    },\r\n    {\r\n      panName: 'frying_pan_B',\r\n      tracksRename: {\r\n        'Meat_B__Copy_.position': 'Meat_B.position',\r\n        'Meat_B__Copy_.quaternion': 'Meat_B.quaternion',\r\n        'frying_pan_B_2.position': 'frying_pan_B_2.position',\r\n        'frying_pan_B_2.quaternion': 'frying_pan_B_2.quaternion'\r\n      }\r\n    },\r\n    {\r\n      panName: 'frying_pan_C',\r\n      tracksRename: {\r\n        'Meat_C__Copy_.position': 'Meat_C.position',\r\n        'Meat_C__Copy_.quaternion': 'Meat_C.quaternion',\r\n        'frying_pan_C_2.position': 'frying_pan_C_2.position',\r\n        'frying_pan_C_2.quaternion': 'frying_pan_C_2.quaternion'\r\n      }\r\n    }\r\n  ];\r\n  const mixersArray = [];\r\n  let progressArray = new Array(pans.length * 2).fill(0);\r\n  const onProgress = () =>{\r\n    const totalProgress = progressArray.reduce((a, c) => a + c) / pans.length / 2;\r\n    const totalProgressPercent = ~~(totalProgress * 10000) / 100;\r\n    console.log(totalProgressPercent);\r\n    typeof(progressCallback) === 'function' && progressCallback(totalProgressPercent);\r\n  }\r\n  pans.forEach((pan, idx) => {\r\n    const currentPan = pansNameMapping[idx];\r\n    const panObject = roomLoaded.children.find(child => child.name === currentPan['panName']);\r\n    const mixer = new THREE.AnimationMixer( panObject );    \r\n    const shakePromise = new Promise((resolve, reject) => {\r\n      loader.load(pan[0], (object) => {\r\n        object.animations[ 0 ][\"tracks\"].forEach(track => {\r\n          track['name'] = currentPan['tracksRename'][track['name']];\r\n        })\r\n        const action = mixer.clipAction( object.animations[ 0 ] );\r\n        // action.loop = THREE.LoopOnce;\r\n        // action.clampWhenFinished = true;\r\n        action.play();\r\n        resolve({\r\n          shake: action\r\n        })\r\n      }, (item) => {\r\n        progressArray[idx * 2] = item.loaded / item.total;\r\n        onProgress();\r\n      }, (err) => {\r\n        console.log(err);\r\n        progressArray[idx * 2] = 1;\r\n        onProgress();        \r\n        reject(err);\r\n      });\r\n    })\r\n    const flipPromise = new Promise((resolve, reject) => {\r\n      loader.load(pan[1], (object) => {\r\n        // const mixer = new THREE.AnimationMixer( panObject );\r\n        object.animations[ 0 ][\"tracks\"].forEach(track => {\r\n          track['name'] = currentPan['tracksRename'][track['name']];\r\n        })\r\n        const action = mixer.clipAction( object.animations[ 0 ] );\r\n        action.play();\r\n        resolve({\r\n          flip: action\r\n        })\r\n      }, (item) => {\r\n        progressArray[idx * 2 + 1] = item.loaded / item.total;\r\n        onProgress();\r\n      }, (err) => {\r\n        console.log(err);\r\n        progressArray[idx * 2 + 1] = 1;\r\n        onProgress();\r\n        reject(err);\r\n      });\r\n    })\r\n\r\n    mixersArray.push(Promise.all([shakePromise, flipPromise]).then(results => {\r\n      const actions = {\r\n        ...results[0],\r\n        ...results[1]\r\n      };      \r\n      mixer.addEventListener( 'loop', onLoopFinished );\r\n      function onLoopFinished( event ) {\r\n        if ( event.action === actions['shake'] ) {\r\n          // mixer.removeEventListener( 'loop', onLoopFinished );\r\n          executeCrossFade(actions['shake'], actions['flip'], 1);\r\n        } else {\r\n          executeCrossFade(actions['flip'], actions['shake'], 1);\r\n        }\r\n      }\r\n      return {\r\n        name: currentPan['panName'],\r\n        mixer: mixer,\r\n        actions: actions\r\n      }\r\n    }))\r\n  })\r\n  return Promise.all(mixersArray);\r\n}\r\n\r\n\r\nconst KitchenViewer = ({\r\n  enableSAOPass = false\r\n}) => {\r\n  const [threeObjects, setThreeObjects] = useState({\r\n    scene: null,\r\n    camera: null,\r\n    containerEl: null,\r\n    renderer: null,\r\n    orbitControl: null,\r\n    raycaster: null,\r\n    clock: null,\r\n    mixer: null,\r\n  });\r\n  const [pansAnimation, setPansAnimation] = useState(null);\r\n  const [playingSteps, setPlayingSteps] = useState(0);\r\n  const [animatePan, setAnimatePan] = useState(0);\r\n  const [roomLoaded, setRoomLoaded] = useState(null);\r\n  const [textureLoaded, setTextureLoaded] = useState([]);\r\n  const [windowSize, setWindowSize] = useState([window.innerWidth, window.innerHeight]);\r\n  const [fpsTimer, setFpsTimer] = useState(Date.now());\r\n  let containerEl = null;\r\n  let animationFrame = null;\r\n  const setContainerEl = (ref) => containerEl = ref;\r\n  const initScene = () => {\r\n    const scene = new THREE.Scene();\r\n    const camera = new THREE.PerspectiveCamera( 36, containerEl.offsetWidth / containerEl.offsetHeight, 1, 1000 );\r\n    // camera.position.set(49, 274, -214);\r\n    // maybe use an animation clip to control the camera later\r\n    camera.position.set(0, 240, -150);\r\n    // camera.rotation.set(90, 0, 0);\r\n    camera.lookAt(0, 0, 120);\r\n    camera.useTarget = false;\r\n    camera.updateProjectionMatrix();\r\n    \r\n    // const light = new THREE.DirectionalLight(0xFFFFFF, 1);\r\n    // light.position.set(50, 100, 100);\r\n    // scene.add(light);\r\n\r\n    // light.position.set(50, 100, 100);\r\n    // const light = new THREE.AmbientLight(0xFFFFFF, 0.1);\r\n    // scene.add(light);\r\n\r\n    const renderer = new THREE.WebGLRenderer({antialias: true});\r\n    renderer.setPixelRatio( window.devicePixelRatio );\r\n    renderer.setSize( containerEl.offsetWidth, containerEl.offsetHeight );\r\n    renderer.setClearColor( 0xcccccc, 1 );\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.needsUpdate = true;\r\n    containerEl.appendChild( renderer.domElement );\r\n\r\n    // add control\r\n    const orbitControl = new OrbitControls( camera, renderer.domElement );\r\n    orbitControl.target.z = 120;\r\n\r\n    const clock = new THREE.Clock();\r\n\r\n    const loader = new FBXLoader();\r\n    // let mixer = null;\r\n    loader.load(fbxUrl, (object) => {\r\n      addShadowToChild(object, scene);\r\n      scene.add(object);\r\n      setRoomLoaded(object);\r\n      // turn the cooker face material to white\r\n      const pansArray = object.children.filter((obj) => obj.name.startsWith(\"frying_pan_\"));\r\n      pansArray.forEach(panObj => {\r\n        const cookerFace = panObj.children.find((panMesh) => panMesh.name.toLowerCase().startsWith('induction_cooker_') && panMesh.name.endsWith('2'));\r\n        cookerFace.material.color = new THREE.Color(0xffffff);\r\n      })\r\n    }, (item) => {\r\n      // console.log( item, loaded, total );\r\n      console.log(item.loaded / item.total * 100 + '%');\r\n    }, (err) => {\r\n      console.log(err);\r\n    });\r\n    \r\n    const textureLoader = new THREE.TextureLoader();\r\n    const meatTextures = [\r\n      textureLoader.load(meatUrl),\r\n      textureLoader.load(mildMeatUrl),\r\n      textureLoader.load(welldoneMeatUrl)\r\n    ];\r\n    setTextureLoaded(meatTextures);\r\n\r\n    // postprocessing sao\r\n    // https://threejs.org/examples/jsm/postprocessing/EffectComposer.js\r\n    let composer = null;\r\n    if (enableSAOPass) {\r\n      composer = new EffectComposer( renderer );\r\n      const renderPass = new RenderPass( scene, camera );\r\n      composer.addPass( renderPass );\r\n      const saoPass = new SAOPass( scene, camera, false, true );\r\n      composer.addPass( saoPass );\r\n      // debugger\r\n      // default params for the saoPass\r\n      saoPass.params.output = SAOPass.OUTPUT.Default;\r\n      saoPass.params.saoBias = 0.5;\r\n      saoPass.params.saoIntensity = 0.5;\r\n      saoPass.params.saoScale = 200;\r\n      saoPass.params.saoKernelRadius = 15;\r\n      saoPass.params.saoMinResolution = 0;\r\n      saoPass.params.saoBlur = true;\r\n      saoPass.params.saoBlurRadius = 8;\r\n      saoPass.params.saoBlurStdDev = 4;\r\n      saoPass.params.saoBlurDepthCutoff = 0.01;\r\n    }\r\n\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n    // THREE.BasicShadowMap = 0;\r\n    // THREE.PCFShadowMap = 1;\r\n    // THREE.PCFSoftShadowMap = 2;\r\n    renderer.shadowMap.needsUpdate = true;\r\n\r\n    // renderer.vr.enabled = true;\r\n    setThreeObjects({\r\n      scene: scene,\r\n      camera: camera,\r\n      containerEl: containerEl,\r\n      renderer: renderer,\r\n      orbitControl: orbitControl,\r\n      // raycaster: raycaster,\r\n      clock: clock,\r\n      composer: composer,\r\n    })\r\n  }\r\n\r\n  const loadPans = () => {\r\n    pansLoader(roomLoaded).then(result => {\r\n      setPansAnimation(result);\r\n    });\r\n      \r\n  }\r\n  const update = () => {\r\n    animationFrame = requestAnimationFrame(update);\r\n    if (pansAnimation) {\r\n      const delta = threeObjects.clock.getDelta();\r\n      for (let i = 0; i < pansAnimation.length; i++) {\r\n        const mixer = pansAnimation[i]['mixer'];\r\n        if (mixer) {\r\n          mixer.update(delta);\r\n        }\r\n      }\r\n    }\r\n    threeObjects.orbitControl.update();\r\n    // mac seems too lag for the sao pass rendering\r\n    if (enableSAOPass && threeObjects.composer) {\r\n      threeObjects.composer.render();\r\n    } else {\r\n      threeObjects.renderer.render( threeObjects.scene, threeObjects.camera );\r\n    }\r\n  };\r\n  const onResize = () => {\r\n    threeObjects.camera.aspect = threeObjects.containerEl.offsetWidth / threeObjects.containerEl.offsetHeight;\r\n    threeObjects.camera.updateProjectionMatrix();\r\n    threeObjects.renderer.setSize( threeObjects.containerEl.offsetWidth, threeObjects.containerEl.offsetHeight );\r\n  }\r\n  useEffect(() => {\r\n    initScene();\r\n  }, []);\r\n  useEffect(() => {\r\n    if (animationFrame)\r\n      cancelAnimationFrame(animationFrame);\r\n    if (threeObjects.scene) {\r\n      animationFrame = requestAnimationFrame(update);\r\n      // update();\r\n    }\r\n    return () => {\r\n      if (animationFrame) {\r\n        cancelAnimationFrame(animationFrame);\r\n      }\r\n    }\r\n  }, [threeObjects, pansAnimation]);\r\n\r\n  useEffect(() => {\r\n    if (roomLoaded) {\r\n      loadPans();\r\n    }\r\n  }, [roomLoaded])\r\n\r\n  useEffect(() => {\r\n    window.addEventListener('resize', onResize);\r\n    return () => {\r\n      window.removeEventListener('resize', onResize);\r\n    }\r\n  }, [threeObjects])\r\n  return <div ref={setContainerEl}\r\n    className=\"threeCanvas\"\r\n  />;\r\n}\r\n\r\nexport default KitchenViewer;\r\n","module.exports = __webpack_public_path__ + \"static/media/190717_frying pan animationA_shake.0f9bee90.fbx\";","import React from 'react';\r\nimport {useState, useEffect} from 'react';\r\nimport {useParams} from 'react-router-dom';\r\nimport * as THREE from 'three';\r\nimport OrbitControls from 'utils/vendor/orbitControls';\r\nimport {FBXLoader} from 'three/examples/jsm/loaders/FBXLoader';\r\n\r\nimport './fbxViewer.css';\r\n// import fbxUrl from 'media/models/Windows for Building department breaking.fbx';\r\n// import fbxUrl from 'media/models/windows.fbx';\r\n// import fbxUrl from 'media/models/190717_frying pan animationA(2).fbx';\r\n\r\n// import fbxUrl from 'media/models/190715_CLP_game(7).fbx';\r\n\r\n// const FBXLoader = require('three-fbxloader-offical');\r\n\r\nconst addShadowToChild = (object, scene) => {\r\n  // let camera = null;\r\n  // console.log(object.name);\r\n  object.traverse( function ( child ) {\r\n    // if (object !== child) {\r\n    //   child.children.forEach((c) =>\r\n    //     addShadowToChild(c, scene)\r\n    //   )\r\n    // }\r\n    if (child.isMesh) { // && child.scale.x === 0 && child.scale.y === 0 && child.scale.z === 0) {\r\n      // child.scale.x = 0.001;\r\n      // child.scale.y = 0.001;\r\n      // child.scale.z = 0.001;\r\n      child.material.side = THREE.FrontSide;\r\n      child.material.needsUpdate = true;\r\n      child.castShadow = true;\r\n      child.receiveShadow = true;\r\n    }\r\n  });\r\n  // return camera;\r\n}\r\n\r\nconst addShadowToRobotArm = (object) => {\r\n  object.traverse( function ( child ) {\r\n    if (child.isMesh) {\r\n      child.castShadow = false;\r\n      child.receiveShadow = true;\r\n    }\r\n  })\r\n}\r\n\r\nconst changeChildrenMaterialColor = (object, lvl = 0) => {\r\n  // let camera = null;\r\n  if (![\"Robot_Hand_1\", \"Hand\"].includes(object.name)) {\r\n    object.children.forEach( function ( child ) {\r\n      changeChildrenMaterialColor(child, lvl + 1);\r\n    });\r\n    if (object.isMesh) {\r\n      object.material.color = new THREE.Color(0.9098039216, 0.062745098, 0.678431373);\r\n    }\r\n  }\r\n  // return camera;\r\n}\r\nconst App = (props) => {\r\n  const [threeObjects, setThreeObjects] = useState({\r\n    scene: null,\r\n    camera: null,\r\n    containerEl: null,\r\n    renderer: null,\r\n    orbitControl: null,\r\n    raycaster: null,\r\n    clock: null,\r\n    mixer: null,\r\n  });\r\n  const [cameraPosition, setCameraPosition] = useState([0, 0, -10]);\r\n  const { fbxName } = useParams();\r\n  console.log(fbxName);\r\n  let containerEl = null;\r\n  let animationFrame = null;\r\n  const cameraDefaultPosition = [\r\n    [500, 500, 250],\r\n    [500, 500, -250],\r\n    [500, -500, -250],\r\n    [500, -500, 250],\r\n  ]\r\n  const setContainerEl = (ref) => containerEl = ref;\r\n  const initScene = () => {\r\n    const scene = new THREE.Scene();\r\n    // scene.background = new THREE.Color(0x404040);\r\n    // scene.background = new THREE.Color(\"transparent\");\r\n    const camera = new THREE.PerspectiveCamera( 50, containerEl.offsetWidth / containerEl.offsetHeight, 0.1, 10000 );\r\n    camera.position.set( 0, 2, -2);\r\n    camera.lookAt(0, 0, 0);\r\n    camera.updateProjectionMatrix();\r\n    \r\n    const dlight = new THREE.DirectionalLight(new THREE.Color('#FFFFFF'), 0.62);\r\n    dlight.position.set(0, 133.872, 0);\r\n    scene.add(dlight);\r\n\r\n    const plight1 = new THREE.PointLight(new THREE.Color('#FFFFFF'), 0.66);\r\n    plight1.position.set(-196.826, 0, -137.264);\r\n    scene.add(plight1);\r\n\r\n    const plight2 = new THREE.PointLight(new THREE.Color('#FFFFFF'), 0.22);\r\n    plight2.position.set(160.014, -56.559, 0.616);\r\n    scene.add(plight2);\r\n\r\n    const alight = new THREE.AmbientLight(new THREE.Color('#FFFFFF'), 0.42);\r\n    scene.add(alight);\r\n\r\n    // const pl100 = new THREE.PointLight(new THREE.Color(1,1,1), 1, 0, 0);\r\n    // pl100.position.set(45.925, 16.159, -95.215);\r\n    // pl100.castShadow = true;\r\n    // scene.add(pl100);\r\n\r\n    // const pl50c = new THREE.PointLight(new THREE.Color(1,1,1), 0.5, 0, 0);\r\n    // pl50c.position.set(0, 171.974, -107.009);\r\n    // pl50c.castShadow = true;\r\n    // scene.add(pl50c);\r\n\r\n    // const pl50b = new THREE.PointLight(new THREE.Color(1,1,1), 0.5, 0, 0);\r\n    // pl50b.position.set(-139.051, 98.463, -73.829);\r\n    // pl50b.castShadow = true;\r\n    // scene.add(pl50b);\r\n\r\n    // const pl50a = new THREE.PointLight(new THREE.Color(1,1,1), 0.5, 0, 0);\r\n    // pl50a.position.set(49.707, 56.062, -29.082);\r\n    // pl50a.castShadow = true;\r\n    // scene.add(pl50a);\r\n\r\n    const renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true } );\r\n    renderer.setPixelRatio( window.devicePixelRatio );\r\n    renderer.setSize( containerEl.offsetWidth, containerEl.offsetHeight );\r\n    renderer.setClearColor( 0xffffff, 0 );\r\n    containerEl.appendChild( renderer.domElement );\r\n\r\n    // renderer.shadowMap.enabled = true;\r\n    // renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n    // renderer.shadowMap.type = THREE.VSMShadowMap;\r\n\r\n    // add control\r\n    const orbitControl = new OrbitControls( camera, renderer.domElement );\r\n    // dampling\r\n    // orbitControl.enableDamping = true;\r\n    // orbitControl.dampingFactor = 0.05;\r\n    // // to cancel out the super fast rotation after enabled damping\r\n    // // orbitControl.enableRotate = false;\r\n    // orbitControl.rotateSpeed = 0.02;\r\n    // orbitControl.autoRotateSpeed = 0.05;\r\n    \r\n    /**\r\n     * limit the vertical rotation\r\n     * https://stackoverflow.com/questions/25308943/limit-orbitcontrols-horizontal-rotation/25311658#25311658\r\n     **/ \r\n    // How far you can orbit vertically, upper and lower limits.\r\n    // Range is 0 to Math.PI radians\r\n    // orbitControl.minPolarAngle = Math.PI / 8;\r\n    // orbitControl.maxPolarAngle = Math.PI * 3 / 8;\r\n    // // How far you can orbit horizontally, upper and lower limits.\r\n    // // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\r\n    // orbitControl.minAzimuthAngle = Math.PI / 4;\r\n    // orbitControl.maxAzimuthAngle = Math.PI / 4; \r\n    \r\n    // // to disable zoom\r\n    // orbitControl.enableZoom = false;\r\n    // orbitControl.minDistance = 5;\r\n    // orbitControl.maxDistance = 5;\r\n    // to disable rotation\r\n    // orbitControl.enableRotate = false;\r\n    // to disable pan\r\n    // orbitControl.enablePan = false;\r\n    // orbitControl.panSpeed = 0.05;\r\n    // raycaster\r\n    const raycaster = new THREE.Raycaster(camera.position, new THREE.Vector3(0, 0, 0), 0, orbitControl.maxDistance * 2);\r\n\r\n    const clock = new THREE.Clock();\r\n\r\n    const loader = new FBXLoader();\r\n    let mixer = null;\r\n    loader.load(`./media/fbx/test1000.fbx`, (object) => {\r\n      mixer = new THREE.AnimationMixer( object );\r\n      let action = null;\r\n      if (object.animations.length) {\r\n        action = mixer.clipAction( object.animations[ 0 ] );\r\n        action.play();\r\n      }\r\n      // const cameraOfFbx = object.getObjectByName('Camera');\r\n      // if (cameraOfFbx) {\r\n      //   setCameraPosition([\r\n      //     cameraOfFbx.position.x,\r\n      //     cameraOfFbx.position.y,\r\n      //     cameraOfFbx.position.z\r\n      //   ]);\r\n      //   camera.position.set(\r\n      //     cameraOfFbx.position.x,\r\n      //     cameraOfFbx.position.y,\r\n      //     cameraOfFbx.position.z\r\n      //   );\r\n      // } else {\r\n      //   camera.position.set(\r\n      //     cameraPosition[0],\r\n      //     cameraPosition[1],\r\n      //     cameraPosition[2]\r\n      //   );\r\n        \r\n      // }\r\n\r\n      const wrapElement = object.getObjectByName(`Default_6`, true);\r\n      if (wrapElement) {\r\n        const wrapElementTexture = new THREE.TextureLoader().load( './media/fbx/mask2.png' );\r\n        wrapElement.material = new THREE.MeshStandardMaterial({\r\n          color: new THREE.Color('#72BDCB'),\r\n          roughness: 0.38,\r\n          metalness: 0.24,\r\n          // emissive: new THREE.Color('#ffffff'),\r\n          emissive: new THREE.Color('#2d4848'),\r\n          emissiveIntensity: 0.58,\r\n          opacity: 1,\r\n          alphaMap: wrapElementTexture,\r\n          transparent: true,\r\n          // side: THREE.DoubleSide\r\n        });\r\n      }\r\n      // wrapElement.material.side = THREE.DoubleSide;\r\n        // wrapElement.renderOrder = 10;\r\n      wrapElement.needsUpdate = true;\r\n\r\n      // addShadowToChild(object, scene);\r\n      \r\n      object.scale.set(0.01, 0.01, 0.01);\r\n\r\n      scene.add(object);\r\n\r\n      setThreeObjects((prevThreeObjects) => {\r\n        return {\r\n          ...prevThreeObjects,\r\n          mixer: mixer,\r\n          action: action,\r\n        }\r\n      })\r\n    }, (item) => {\r\n      // console.log( item, loaded, total );\r\n      console.log(item.loaded / item.total * 100 + '%');\r\n    }, (err) => {\r\n      console.log(err);\r\n    });\r\n\r\n    loader.load(`./media/fbx/webmb.fbx`, (object) => {\r\n      mixer = new THREE.AnimationMixer( object );\r\n      let action = null;\r\n      if (object.animations.length) {\r\n        action = mixer.clipAction( object.animations[ 0 ] );\r\n        action.play();\r\n      }\r\n      \r\n      const innerElement = object.getObjectByName(`webmb`, true);\r\n      if (innerElement) {\r\n        let texReady = false;\r\n        let disReady = false;\r\n        const texVideo = document.createElement('video');\r\n        texVideo.oncanplay = () => {\r\n          texReady = true;\r\n          if (texReady && disReady) {\r\n            texVideo.play();\r\n            dispVideo.play();\r\n          }\r\n        }\r\n        texVideo.muted = true;\r\n        texVideo.loop = true;\r\n        texVideo.autoplay = true;\r\n        texVideo.src = `./media/fbx/webmTex.webm`;\r\n        const vidTexture = new THREE.VideoTexture( texVideo );\r\n        vidTexture.format = THREE.RGBAFormat;\r\n        innerElement.material.map = vidTexture;\r\n        innerElement.material.alphaTest = 0.2;\r\n        // innerElement.material.alphaMap = vidTexture;\r\n\r\n\r\n        const dispVideo = document.createElement('video');\r\n        dispVideo.oncanplay = () => {\r\n          disReady = true;\r\n          if (texReady && disReady) {\r\n            texVideo.play();\r\n            dispVideo.play();\r\n          }\r\n        }\r\n        dispVideo.muted = true;\r\n        dispVideo.loop = true;\r\n        dispVideo.autoplay = true;\r\n        dispVideo.src = `./media/fbx/webmDisp.mp4`;\r\n        const dispTexture = new THREE.VideoTexture( dispVideo );\r\n        // test.displacementMap\r\n        innerElement.material.displacementMap = dispTexture;\r\n        innerElement.material.displacementScale = 8;\r\n\r\n        // innerElement.material.side = THREE.FrontSide;\r\n        // innerElement.material.side = THREE.DoubleSide;\r\n\r\n        // innerElement.material.transparent = true;\r\n        innerElement.material.transparent = true;\r\n        // innerElement.material.emissive = new THREE.Color('#2d4848');\r\n        // innerElement.material.emissiveIntensity = 1;\r\n\r\n        // innerElement.renderOrder = 1;\r\n        innerElement.material.needsUpdate = true;\r\n    }\r\n\r\n      // addShadowToChild(object, scene);\r\n      \r\n      object.scale.set(0.01, 0.01, 0.01);\r\n\r\n      scene.add(object);\r\n\r\n      setThreeObjects((prevThreeObjects) => {\r\n        return {\r\n          ...prevThreeObjects,\r\n          mixer: mixer,\r\n          action: action,\r\n        }\r\n      })\r\n    }, (item) => {\r\n      // console.log( item, loaded, total );\r\n      console.log(item.loaded / item.total * 100 + '%');\r\n    }, (err) => {\r\n      console.log(err);\r\n    })\r\n    \r\n    setThreeObjects({\r\n      scene: scene,\r\n      camera: camera,\r\n      containerEl: containerEl,\r\n      renderer: renderer,\r\n      orbitControl: orbitControl,\r\n      raycaster: raycaster,\r\n      clock: clock,\r\n    })\r\n  }\r\n  const update = () => {\r\n    animationFrame = requestAnimationFrame(() => update());\r\n    // animationFrame = setTimeout(() => update(), 1000 / 30);\r\n    // fix the animation step to 30fps\r\n    // const delta = 1 / 30; //threeObjects.clock.getDelta();\r\n    const delta = threeObjects.clock.getDelta();\r\n    if (threeObjects.mixer) {\r\n      threeObjects.mixer.update(delta);\r\n    }\r\n    // try move camera to new position\r\n    // const newCamPos = cameraPosition;\r\n    // const oldCamPos = threeObjects.camera.position;\r\n    // if (newCamPos[0] !== oldCamPos.x ||\r\n    //   newCamPos[1] !== oldCamPos.y||\r\n    //   newCamPos[2] !== oldCamPos.z) {\r\n    //   oldCamPos.x = (newCamPos[0] - oldCamPos.x) * 0.15 + oldCamPos.x;\r\n    //   oldCamPos.y = (newCamPos[1] - oldCamPos.y) * 0.15 + oldCamPos.y;\r\n    //   oldCamPos.z = (newCamPos[2] - oldCamPos.z) * 0.15 + oldCamPos.z;\r\n    // }\r\n    threeObjects.orbitControl.update();\r\n    threeObjects.renderer.render( threeObjects.scene, threeObjects.camera );\r\n  };\r\n  // const doCameraAnimation = () => {\r\n  //   setCameraPosition((prevCameraPosition) => {\r\n  //     return (prevCameraPosition + 1) % cameraDefaultPosition.length;\r\n  //   });\r\n  // };\r\n  const onResize = () => {\r\n    threeObjects.camera.aspect = threeObjects.containerEl.offsetWidth / threeObjects.containerEl.offsetHeight;\r\n    threeObjects.camera.updateProjectionMatrix();\r\n    threeObjects.renderer.setSize( threeObjects.containerEl.offsetWidth, threeObjects.containerEl.offsetHeight );\r\n  }\r\n  useEffect(() => {\r\n    initScene();\r\n  }, []);\r\n  useEffect(() => {\r\n    window.addEventListener('resize', onResize);\r\n    return () => {\r\n      window.removeEventListener('resize', onResize);\r\n    }\r\n  }, [threeObjects])\r\n  useEffect(() => {\r\n    if (animationFrame)\r\n      // cancelAnimationFrame(animationFrame);\r\n      clearTimeout(animationFrame);\r\n    // console.log(threeObjects);\r\n    if (threeObjects.scene) {\r\n      animationFrame = setTimeout(() => update(), 1000 / 30);//update();\r\n    }\r\n    return () => {\r\n      if (animationFrame)\r\n        // cancelAnimationFrame(animationFrame);\r\n        clearTimeout(animationFrame);\r\n    }\r\n  }, [threeObjects, cameraPosition]);\r\n  const backToInitialView = () => {\r\n    threeObjects.orbitControl.reset();\r\n    threeObjects.camera.position.set(\r\n      cameraPosition[0],\r\n      cameraPosition[1],\r\n      cameraPosition[2]\r\n    );\r\n    debugger\r\n    threeObjects.camera.lookAt(threeObjects.scene.children[0].children[0]);\r\n  }\r\n  return <div ref={setContainerEl}\r\n    // onClick={doCameraAnimation}\r\n    className=\"threeCanvas\"\r\n    style={{\r\n      height: '100vh',\r\n    }}>\r\n    <div className=\"hintsText\">\r\n      <ul>\r\n        <li>Left button to rotate</li>\r\n        <li>Wheel button to zoom</li>\r\n        <li>Right button to pan</li>\r\n      </ul>\r\n      <div className=\"backToInitialView\"\r\n        onClick={backToInitialView}\r\n      >\r\n        Back to default view\r\n      </div>\r\n    </div>\r\n  </div>;\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport {useState, useEffect} from 'react';\r\nimport {useParams} from 'react-router-dom';\r\nimport * as THREE from 'three';\r\nimport OrbitControls from 'utils/vendor/orbitControls';\r\n// import {FBXLoader} from 'three/examples/jsm/loaders/FBXLoader';\r\nimport {OBJLoader as ObjectLoader} from 'three/examples/jsm/loaders/OBJLoader';\r\n\r\nimport './fbxViewer.css';\r\n// import fbxUrl from 'media/models/Windows for Building department breaking.fbx';\r\n// import fbxUrl from 'media/models/windows.fbx';\r\n// import fbxUrl from 'media/models/190717_frying pan animationA(2).fbx';\r\n\r\n// import fbxUrl from 'media/models/190715_CLP_game(7).fbx';\r\n\r\n// const FBXLoader = require('three-fbxloader-offical');\r\n\r\nconst addShadowToChild = (object, scene) => {\r\n  // let camera = null;\r\n  // console.log(object.name);\r\n  object.traverse( function ( child ) {\r\n    // if (object !== child) {\r\n    //   child.children.forEach((c) =>\r\n    //     addShadowToChild(c, scene)\r\n    //   )\r\n    // }\r\n    if (child.isMesh) { // && child.scale.x === 0 && child.scale.y === 0 && child.scale.z === 0) {\r\n      // child.scale.x = 0.001;\r\n      // child.scale.y = 0.001;\r\n      // child.scale.z = 0.001;\r\n      child.material.side = THREE.FrontSide;\r\n      child.material.needsUpdate = true;\r\n      child.castShadow = true;\r\n      child.receiveShadow = true;\r\n    }\r\n  });\r\n  // return camera;\r\n}\r\n\r\nconst addShadowToRobotArm = (object) => {\r\n  object.traverse( function ( child ) {\r\n    if (child.isMesh) {\r\n      child.castShadow = false;\r\n      child.receiveShadow = true;\r\n    }\r\n  })\r\n}\r\n\r\nconst changeChildrenMaterialColor = (object, lvl = 0) => {\r\n  // let camera = null;\r\n  if (![\"Robot_Hand_1\", \"Hand\"].includes(object.name)) {\r\n    object.children.forEach( function ( child ) {\r\n      changeChildrenMaterialColor(child, lvl + 1);\r\n    });\r\n    if (object.isMesh) {\r\n      object.material.color = new THREE.Color(0.9098039216, 0.062745098, 0.678431373);\r\n    }\r\n  }\r\n  // return camera;\r\n}\r\nconst App = (props) => {\r\n  const [threeObjects, setThreeObjects] = useState({\r\n    scene: null,\r\n    camera: null,\r\n    containerEl: null,\r\n    renderer: null,\r\n    orbitControl: null,\r\n    raycaster: null,\r\n    clock: null,\r\n    mixer: null,\r\n  });\r\n  const [cameraPosition, setCameraPosition] = useState([0, 0, -10]);\r\n  const { jsonName } = useParams();\r\n  console.log(jsonName);\r\n  let containerEl = null;\r\n  let animationFrame = null;\r\n  const cameraDefaultPosition = [\r\n    [500, 500, 250],\r\n    [500, 500, -250],\r\n    [500, -500, -250],\r\n    [500, -500, 250],\r\n  ]\r\n  const setContainerEl = (ref) => containerEl = ref;\r\n  const initScene = () => {\r\n    const scene = new THREE.Scene();\r\n    scene.background = new THREE.Color(0x404040);\r\n    // scene.background = new THREE.Color(\"transparent\");\r\n    const camera = new THREE.PerspectiveCamera( 50, containerEl.offsetWidth / containerEl.offsetHeight, 0.1, 10000 );\r\n    // camera.position.set(500, 500, 250);\r\n    camera.lookAt(0, 0, 0);\r\n    camera.updateProjectionMatrix();\r\n    \r\n    // const pl100 = new THREE.PointLight(new THREE.Color(1,1,1), 1, 0, 0);\r\n    // pl100.position.set(45.925, 16.159, -95.215);\r\n    // pl100.castShadow = true;\r\n    // scene.add(pl100);\r\n\r\n    // const pl50c = new THREE.PointLight(new THREE.Color(1,1,1), 0.5, 0, 0);\r\n    // pl50c.position.set(0, 171.974, -107.009);\r\n    // pl50c.castShadow = true;\r\n    // scene.add(pl50c);\r\n\r\n    // const pl50b = new THREE.PointLight(new THREE.Color(1,1,1), 0.5, 0, 0);\r\n    // pl50b.position.set(-139.051, 98.463, -73.829);\r\n    // pl50b.castShadow = true;\r\n    // scene.add(pl50b);\r\n\r\n    // const pl50a = new THREE.PointLight(new THREE.Color(1,1,1), 0.5, 0, 0);\r\n    // pl50a.position.set(49.707, 56.062, -29.082);\r\n    // pl50a.castShadow = true;\r\n    // scene.add(pl50a);\r\n\r\n    const renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true } );\r\n    renderer.setPixelRatio( window.devicePixelRatio );\r\n    renderer.setSize( containerEl.offsetWidth, containerEl.offsetHeight );\r\n    renderer.setClearColor( 0xcccccc, 0 );\r\n    containerEl.appendChild( renderer.domElement );\r\n\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n    // renderer.shadowMap.type = THREE.VSMShadowMap;\r\n\r\n    // add control\r\n    const orbitControl = new OrbitControls( camera, renderer.domElement );\r\n    // dampling\r\n    // orbitControl.enableDamping = true;\r\n    // orbitControl.dampingFactor = 0.05;\r\n    // // to cancel out the super fast rotation after enabled damping\r\n    // // orbitControl.enableRotate = false;\r\n    // orbitControl.rotateSpeed = 0.02;\r\n    // orbitControl.autoRotateSpeed = 0.05;\r\n    \r\n    /**\r\n     * limit the vertical rotation\r\n     * https://stackoverflow.com/questions/25308943/limit-orbitcontrols-horizontal-rotation/25311658#25311658\r\n     **/ \r\n    // How far you can orbit vertically, upper and lower limits.\r\n    // Range is 0 to Math.PI radians\r\n    // orbitControl.minPolarAngle = Math.PI / 8;\r\n    // orbitControl.maxPolarAngle = Math.PI * 3 / 8;\r\n    // // How far you can orbit horizontally, upper and lower limits.\r\n    // // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\r\n    // orbitControl.minAzimuthAngle = Math.PI / 4;\r\n    // orbitControl.maxAzimuthAngle = Math.PI / 4; \r\n    \r\n    // // to disable zoom\r\n    // orbitControl.enableZoom = false;\r\n    // orbitControl.minDistance = 5;\r\n    // orbitControl.maxDistance = 5;\r\n    // to disable rotation\r\n    // orbitControl.enableRotate = false;\r\n    // to disable pan\r\n    // orbitControl.enablePan = false;\r\n    // orbitControl.panSpeed = 0.05;\r\n    // raycaster\r\n    const raycaster = new THREE.Raycaster(camera.position, new THREE.Vector3(0, 0, 0), 0, orbitControl.maxDistance * 2);\r\n\r\n    const clock = new THREE.Clock();\r\n\r\n    const loader = new ObjectLoader();\r\n    let mixer = null;\r\n    loader.load(`./media/json/${jsonName}.json`, (object) => {\r\n      mixer = new THREE.AnimationMixer( object );\r\n      let action = null;\r\n      if (object.animations.length) {\r\n        action = mixer.clipAction( object.animations[ 0 ] );\r\n        action.play();\r\n      }\r\n      const cameraOfFbx = object.getObjectByName('Camera');\r\n      if (cameraOfFbx) {\r\n        setCameraPosition([\r\n          cameraOfFbx.position.x,\r\n          cameraOfFbx.position.y,\r\n          cameraOfFbx.position.z\r\n        ]);\r\n        camera.position.set(\r\n          cameraOfFbx.position.x,\r\n          cameraOfFbx.position.y,\r\n          cameraOfFbx.position.z\r\n        );\r\n      } else {\r\n        camera.position.set(\r\n          cameraPosition[0],\r\n          cameraPosition[1],\r\n          cameraPosition[2]\r\n        );\r\n        \r\n      }\r\n\r\n      for (let i = 'a'.charCodeAt(0); i <= 'z'.charCodeAt(0); i++) {\r\n        const currentChar = String.fromCharCode(i);\r\n        const videoElement = object.getObjectByName(`video${currentChar}`, true);\r\n        if (videoElement) {\r\n          const video = document.createElement('video');\r\n          video.oncanplay = () => {\r\n            video.play();\r\n          }\r\n          video.muted = true;\r\n          video.loop = true;\r\n          video.autoplay = true;\r\n          video.src = `./media/json/video${currentChar}.mp4`;\r\n          const texture = new THREE.VideoTexture( video );\r\n            texture.minFilter = THREE.LinearFilter;\r\n            texture.magFilter = THREE.LinearFilter;\r\n            texture.format = THREE.RGBFormat;\r\n            videoElement.material.map = texture;\r\n        }\r\n      }\r\n      addShadowToChild(object, scene);\r\n      scene.add(object);\r\n      // camera.lookAt(object);\r\n      setThreeObjects((prevThreeObjects) => {\r\n        return {\r\n          ...prevThreeObjects,\r\n          mixer: mixer,\r\n          action: action,\r\n        }\r\n      })\r\n    }, (item) => {\r\n      // console.log( item, loaded, total );\r\n      console.log(item.loaded / item.total * 100 + '%');\r\n    }, (err) => {\r\n      console.log(err);\r\n    });\r\n    \r\n    setThreeObjects({\r\n      scene: scene,\r\n      camera: camera,\r\n      containerEl: containerEl,\r\n      renderer: renderer,\r\n      orbitControl: orbitControl,\r\n      raycaster: raycaster,\r\n      clock: clock,\r\n    })\r\n  }\r\n  const update = () => {\r\n    animationFrame = requestAnimationFrame(() => update());\r\n    // animationFrame = setTimeout(() => update(), 1000 / 30);\r\n    // fix the animation step to 30fps\r\n    // const delta = 1 / 30; //threeObjects.clock.getDelta();\r\n    const delta = threeObjects.clock.getDelta();\r\n    if (threeObjects.mixer) {\r\n      threeObjects.mixer.update(delta);\r\n    }\r\n    // try move camera to new position\r\n    // const newCamPos = cameraPosition;\r\n    // const oldCamPos = threeObjects.camera.position;\r\n    // if (newCamPos[0] !== oldCamPos.x ||\r\n    //   newCamPos[1] !== oldCamPos.y||\r\n    //   newCamPos[2] !== oldCamPos.z) {\r\n    //   oldCamPos.x = (newCamPos[0] - oldCamPos.x) * 0.15 + oldCamPos.x;\r\n    //   oldCamPos.y = (newCamPos[1] - oldCamPos.y) * 0.15 + oldCamPos.y;\r\n    //   oldCamPos.z = (newCamPos[2] - oldCamPos.z) * 0.15 + oldCamPos.z;\r\n    // }\r\n    threeObjects.orbitControl.update();\r\n    threeObjects.renderer.render( threeObjects.scene, threeObjects.camera );\r\n  };\r\n  // const doCameraAnimation = () => {\r\n  //   setCameraPosition((prevCameraPosition) => {\r\n  //     return (prevCameraPosition + 1) % cameraDefaultPosition.length;\r\n  //   });\r\n  // };\r\n  const onResize = () => {\r\n    threeObjects.camera.aspect = threeObjects.containerEl.offsetWidth / threeObjects.containerEl.offsetHeight;\r\n    threeObjects.camera.updateProjectionMatrix();\r\n    threeObjects.renderer.setSize( threeObjects.containerEl.offsetWidth, threeObjects.containerEl.offsetHeight );\r\n  }\r\n  useEffect(() => {\r\n    initScene();\r\n  }, []);\r\n  useEffect(() => {\r\n    window.addEventListener('resize', onResize);\r\n    return () => {\r\n      window.removeEventListener('resize', onResize);\r\n    }\r\n  }, [threeObjects])\r\n  useEffect(() => {\r\n    if (animationFrame)\r\n      // cancelAnimationFrame(animationFrame);\r\n      clearTimeout(animationFrame);\r\n    // console.log(threeObjects);\r\n    if (threeObjects.scene) {\r\n      animationFrame = setTimeout(() => update(), 1000 / 30);//update();\r\n    }\r\n    return () => {\r\n      if (animationFrame)\r\n        // cancelAnimationFrame(animationFrame);\r\n        clearTimeout(animationFrame);\r\n    }\r\n  }, [threeObjects, cameraPosition]);\r\n  const backToInitialView = () => {\r\n    threeObjects.orbitControl.reset();\r\n    threeObjects.camera.position.set(\r\n      cameraPosition[0],\r\n      cameraPosition[1],\r\n      cameraPosition[2]\r\n    );\r\n    debugger\r\n    threeObjects.camera.lookAt(threeObjects.scene.children[0].children[0]);\r\n  }\r\n  return <div ref={setContainerEl}\r\n    // onClick={doCameraAnimation}\r\n    className=\"threeCanvas\"\r\n    style={{\r\n      height: '100vh',\r\n    }}>\r\n    <div className=\"hintsText\">\r\n      <ul>\r\n        <li>Left button to rotate</li>\r\n        <li>Wheel button to zoom</li>\r\n        <li>Right button to pan</li>\r\n      </ul>\r\n      <div className=\"backToInitialView\"\r\n        onClick={backToInitialView}\r\n      >\r\n        Back to default view\r\n      </div>\r\n    </div>\r\n  </div>;\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport {Link} from 'react-router-dom';\r\nimport routes from 'globals/routes';\r\n\r\nconst IndexPage = () => {\r\n  return <ul className=\"client\">\r\n    <li><Link to={routes.fbxViewer}>Windows Animation</Link></li>\r\n    <li><Link to={routes.kitchenViewer}>Kitchen Animation</Link></li>\r\n    <li><Link to={routes.homePage}>Game</Link></li>\r\n    <li><Link to={routes.touchTableViewer}>Touch Table Testing</Link></li>\r\n    <li><Link to={routes.svgAnimator}>svg Testing</Link></li>\r\n  </ul>\r\n}\r\n\r\nexport default IndexPage;","import React, {useState, useEffect} from 'react';\r\nimport routes from 'globals/routes';\r\n\r\nconst TouchTableViewer = () => {\r\n  const [targetWinSize, setTargetWinSize] = useState([1920, 1080]);\r\n  const [winSize, setWinSize] = useState([window.innerWidth, window.innerHeight]);\r\n  const [winScale, setWinScale] = useState(1);\r\n  useEffect(() => {\r\n    window.addEventListener('resize', () => {\r\n      setWinSize([window.innerWidth, window.innerHeight]);\r\n    });\r\n  }, []);\r\n  useEffect(() => {\r\n    setWinScale(\r\n      Math.min((window.innerWidth) / targetWinSize[0], (window.innerHeight) / targetWinSize[1])\r\n    );\r\n  }, [winSize, targetWinSize])\r\n  return <div style={{\r\n    width: '100%',\r\n    height: '100%',\r\n    overflow: 'hidden'\r\n  }}>\r\n    <iframe src={`#${routes.touchTable}`} style={{\r\n      width: targetWinSize[0],\r\n      height: targetWinSize[1],\r\n      transform: `scale(${winScale})`,\r\n      transformOrigin: 'top left',\r\n      overflow: 'hidden',\r\n      border: 0,\r\n      transition: 'all 0.3s'\r\n    }} />\r\n    <div\r\n      style={{\r\n        position: 'absolute',\r\n        zIndex: 1,\r\n        bottom: 15,\r\n        right: 15,\r\n        cursor: 'pointer'\r\n      }}\r\n      onClick={()=>{\r\n        setTargetWinSize((prevTargerWinSize) => {\r\n          if (prevTargerWinSize[0] === 3840) {\r\n            return [1920, 1080];\r\n          } else {\r\n            return [3840, 2160];\r\n          }\r\n        })\r\n      }}\r\n    >\r\n      current monitor<br />resolution:<br />\r\n      {`${targetWinSize[0]} x ${targetWinSize[1]} `}\r\n    </div>\r\n  </div>;\r\n};\r\n\r\nexport default TouchTableViewer;","import React from 'react';\r\nimport {useState, useEffect} from 'react';\r\nconst App = (props) => {\r\n  const [fps, setFps] = useState(30);\r\n  let containerEl;\r\n  let canvasEl;\r\n  let animationFrame;\r\n  const setContainerEl = (ref) => containerEl = ref;\r\n  const setCanvasEl = (ref) => canvasEl = ref;\r\n  const draw = () => {\r\n\r\n  }\r\n  const update = () => {\r\n    // the animation step\r\n    animationFrame = setTimeout(() => update(), 1000 / fps);\r\n  };\r\n\r\n  useEffect(() => {\r\n    // initScene();\r\n  }, []);\r\n  \r\n  return <div ref={setContainerEl}>\r\n    <canvas ref={setCanvasEl}/>\r\n  </div>;\r\n}\r\n\r\nexport default App;","import React, {useEffect, useState, useRef} from 'react';\r\nimport finder from '@medv/finder';\r\n\r\nimport './svgAnimator.css';\r\nimport './custom-inputbox.css';\r\nconst SvgAnimator = (props) => {\r\n  const [svgEl, setSvgEl] = useState(null);\r\n  const [elList, setElList] = useState([]);\r\n  const [clickedEl, setClickedEl] = useState(null);\r\n  const [clickedElInfo, setClickedElInfo] = useState({});\r\n  const [svgStr, setSvgStr] = useState('');\r\n  const [curveStr, setCurveStr] = useState('0,0,1,1');\r\n  // const [clickedQueue, setclickedQueue] = useState(false);\r\n  useEffect(() => {\r\n    const htmlEl = document.querySelector('html');\r\n    htmlEl.addEventListener('dragover', dragoverHandler);\r\n    htmlEl.addEventListener('drop', dropHandler);\r\n    return () => {\r\n      const htmlEl = document.querySelector('html');\r\n      htmlEl.removeEventListener('dragover', dragoverHandler);\r\n      htmlEl.removeEventListener('drop', dropHandler)\r\n    }\r\n  }, [])\r\n  const dragoverHandler = (e) => {\r\n    e.preventDefault();\r\n  }\r\n  const dropHandler = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    let file = null;\r\n    if (e.dataTransfer.items) {\r\n      // Use DataTransferItemList interface to access the file(s)\r\n      // for (var i = 0; i < e.dataTransfer.items.length; i++) {\r\n        // If dropped items aren't files, reject them\r\n        if (e.dataTransfer.items[0].kind === 'file') {\r\n          file = e.dataTransfer.items[0].getAsFile();\r\n        }\r\n      // }\r\n    } else {\r\n      // Use DataTransfer interface to access the file(s)\r\n      for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n        file = e.dataTransfer.files[0];\r\n      }\r\n    }\r\n    if (file.type === 'image/svg+xml') {\r\n      // update svg\r\n      const reader = new FileReader();\r\n\r\n      reader.readAsBinaryString(file);\r\n\r\n      reader.onloadend = function(){\r\n        setSvgStr(reader.result);\r\n      }\r\n      setClickedEl(null);\r\n      setElList([]);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    if (svgEl) {\r\n      // https://hackernoon.com/htmlcollection-nodelist-and-array-of-objects-da42737181f9\r\n      // node list to array\r\n      // Array.from(NodeList)\r\n      // Array.prototype.slice.call(NodeList)\r\n      // [...NodeList]\r\n      // const ElArray = Array.from(svgEl.querySelectorAll('*'));\r\n      // ElArray.forEach(...)\r\n      // or just keep iterable\r\n      // console.log('building');\r\n      const ElListWithSelector = [];\r\n      const ElList = svgEl.querySelectorAll('*');\r\n      svgEl.addEventListener('click', svgOnClick);\r\n      for (let el of ElList) {\r\n        if (el.getBBox) {\r\n          el.addEventListener('click', elOnClick);\r\n          const boundBox = el.getBBox();\r\n          el.style.transformOrigin = `${boundBox.x + boundBox.width / 2}px ${boundBox.y + boundBox.height / 2}px`;\r\n          const selector = finder(el, {\r\n            root: svgEl\r\n          })\r\n          el.data = {selector: selector};\r\n          ElListWithSelector.push({\r\n            selector: selector,\r\n            element: el\r\n          });\r\n        }\r\n      }\r\n      setElList(ElListWithSelector);\r\n    }\r\n    return () => {\r\n      if (svgEl) {\r\n        svgEl.removeEventListener('click', svgOnClick);\r\n        elList.forEach(item => item.element.removeEventListener('click', elOnClick));\r\n        setClickedEl(null);\r\n        setElList([]);\r\n      }\r\n    }\r\n  }, [svgEl]);\r\n\r\n  const svgOnClick = (e) => {\r\n    e.stopPropagation();\r\n    setClickedEl(null);\r\n  }\r\n  const elOnClick = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setClickedEl(e.currentTarget);\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (svgEl && clickedEl) {\r\n      const selectorStr = finder(clickedEl, {\r\n        root: svgEl\r\n      })\r\n      clickedEl.classList.add('selected');\r\n      let parentNode = clickedEl.parentNode;\r\n      while (parentNode !== svgEl && parentNode !== document.body) {\r\n        parentNode.classList.add('selected');\r\n        parentNode = parentNode.parentNode;\r\n      }\r\n      svgEl.classList.add('selecting');\r\n      /**\r\n       * try to get the element info\r\n       */\r\n      const elementInfo = {\r\n        selectorStr: selectorStr,\r\n        transformOrigin: window.getComputedStyle(clickedEl)['transformOrigin'],\r\n        x: clickedEl.getAttribute('x'),\r\n        y: clickedEl.getAttribute('y'),\r\n        width: clickedEl.getAttribute('width'),\r\n        height: clickedEl.getAttribute('height'),\r\n        animation: [\r\n          // {\r\n          //   calcMode: 'discrete|linear|spline', // timingMode\r\n          //   values: ['360', '0'], // keyframes\r\n          //   keySplines: '0 0 1 1', // timingFunction for spline only\r\n          //   type: 'translate|rotate|scale',\r\n          //   repeatCount: 'indefinite|n',\r\n          //   fill: 'remove|freeze', // status on complete\r\n          //   dur: '3s', // duration\r\n          //   begin: '0s', // delay\r\n          // }\r\n        ]\r\n      };\r\n      // https://stackoverflow.com/questions/3680876/using-queryselectorall-to-retrieve-direct-children\r\n      const animationEls = clickedEl.querySelectorAll(\":scope > animateTransform\");\r\n      Array.from(animationEls).forEach(animationEl => {\r\n        const animationAttrs = {\r\n          calcMode: animationEl.getAttribute('calcMode'),\r\n          values: animationEl.getAttribute('values'),\r\n          keySplines: animationEl.getAttribute('keySplines'),\r\n          type: animationEl.getAttribute('type'),\r\n          repeatCount: animationEl.getAttribute('repeatCount'),\r\n          fill: animationEl.getAttribute('fill'),\r\n          dur: animationEl.getAttribute('dur'),\r\n          begin: animationEl.getAttribute('begin'),\r\n        };\r\n        elementInfo['animation'].push(animationAttrs);\r\n      })\r\n      setClickedElInfo(elementInfo);\r\n    } else if (svgEl) {\r\n      const elementInfo = {\r\n        selectorStr: '',\r\n      }\r\n      setClickedElInfo(elementInfo);\r\n      svgEl.classList.remove('selecting');\r\n    }\r\n    return () => {\r\n      if (svgEl && clickedEl) {\r\n        clickedEl.classList.remove('selected');\r\n        let parentNode = clickedEl.parentNode;\r\n        while (parentNode !== svgEl) {\r\n          parentNode.classList.remove('selected');\r\n          parentNode = parentNode.parentNode;\r\n        }\r\n      }\r\n    }\r\n  }, [svgEl, clickedEl]);\r\n\r\n  useEffect(() => {\r\n    if (svgStr) {\r\n      setSvgEl(document.querySelector('#svgAnimator .svgWrapper svg'));\r\n      // console.log(svgEl);\r\n    }\r\n  }, [svgStr]);\r\n  return <div id=\"svgAnimator\">\r\n    <div className=\"svgWrapper\">\r\n      {clickedEl && clickedElInfo['selectorStr']? \r\n        <div style={{\r\n          border: '2px solid #F00',\r\n          position: 'absolute',\r\n          top: clickedEl.getBoundingClientRect().y - 2,\r\n          left: clickedEl.getBoundingClientRect().x - 2,\r\n          width: clickedEl.getBoundingClientRect().width,\r\n          height: clickedEl.getBoundingClientRect().height,\r\n          pointerEvents: 'none'\r\n        }}>\r\n          <div style={{\r\n            position: 'absolute',\r\n            left: (clickedEl.getBoundingClientRect().width / clickedElInfo['width']) * clickedElInfo['transformOrigin'].split(' ')[0].replace('px',''),\r\n            top: (clickedEl.getBoundingClientRect().width / clickedElInfo['width']) * clickedElInfo['transformOrigin'].split(' ')[1].replace('px','')\r\n          }} />\r\n        </div>\r\n        :\r\n        null\r\n      }\r\n      <span dangerouslySetInnerHTML={{__html: svgStr}} />\r\n    </div>\r\n    <div className=\"editorWrapper\">\r\n      <div className=\"svgElements\">\r\n        <select onChange={(e) => {\r\n            {/* console.log(e.currentTarget.value); */}\r\n            const selected = elList.find(el => el.selector === e.currentTarget.value);\r\n            if (selected) {\r\n              setClickedEl(selected.element);\r\n            }\r\n          }}value={clickedEl? clickedEl.data.selector: \"\"}>\r\n          <option value=\"\">Click to select an element</option>\r\n          {elList.map((el, idx)=> <option key={idx} value={el.selector}>{el.element.tagName}</option>)}\r\n        </select>\r\n      </div>\r\n      {clickedElInfo['selectorStr'] && \r\n        <div className=\"svgAnimation\">\r\n          <div className=\"custom-inputbox filled\">\r\n            <label>unique selector</label>\r\n            <input readOnly value={clickedElInfo['selectorStr']} />\r\n          </div>\r\n          <div className=\"custom-inputbox filled\">\r\n            <label>transformOrigin</label>\r\n            <input readOnly value={clickedElInfo['transformOrigin']} />\r\n          </div>\r\n          <div className=\"svgAnimations\">\r\n            {clickedElInfo['animation'].map((animationData, idx) => {\r\n              return <div className=\"animation\">\r\n                <div className=\"custom-inputbox filled\">\r\n                  <label>type</label>\r\n                  <input value={animationData['type']} />\r\n                </div>\r\n                <div className=\"custom-inputbox filled\">\r\n                  <label>timingMode</label>\r\n                  <input value={animationData['calcMode']} />\r\n                </div>\r\n                <div className=\"custom-inputbox filled\">\r\n                  <label>timingFunction</label>\r\n                  <input value={animationData['keySplines']} />\r\n                </div>\r\n                <div className=\"custom-inputbox filled\">\r\n                  <label>start</label>\r\n                  <input value={animationData['begin']} />\r\n                </div>\r\n                <div className=\"custom-inputbox filled\">\r\n                  <label>duration</label>\r\n                  <input value={animationData['dur']} />\r\n                </div>\r\n                <div className=\"custom-inputbox filled\">\r\n                  <label>repeatCount</label>\r\n                  <input value={animationData['repeatCount']} />\r\n                </div>\r\n                <div className=\"custom-inputbox filled\">\r\n                  <label>onComplete behaviour</label>\r\n                  <input value={animationData['fill']} />\r\n                </div>\r\n                <div className=\"custom-inputbox filled\">\r\n                  <label>animation values</label>\r\n                  <input value={animationData['values']} />\r\n                </div>\r\n                <svg\r\n                  style={{\r\n                    width: 100,\r\n                    height: 200,\r\n                    overflow: 'visible'\r\n                  }}\r\n                  viewBox=\"0 0 1 1\"\r\n                >\r\n                  <rect x=\"0\" y=\"0\" width=\"1\" height=\"1\" fill=\"none\" stroke=\"#DDD\" vectorEffect=\"non-scaling-stroke\" />\r\n                  <path d={`m0,0 C${animationData['keySplines']} 1,1`} style={{\r\n                    stroke: '#000',\r\n                    fill: 'none',\r\n                    strokeWidth: 2,\r\n                    transformOrigin: 'center',\r\n                    transform: 'scaleY(-1)'\r\n                  }} vectorEffect=\"non-scaling-stroke\" />\r\n                </svg>\r\n                <input readOnly value={animationData['keySplines']} />  \r\n              </div>;\r\n            })}\r\n          </div>\r\n        </div>\r\n      }\r\n    </div>\r\n  </div>;\r\n}\r\n\r\nexport default SvgAnimator;\r\n\r\n/** some svg attributes and functions\r\n \r\n<animateTransform attributeName=\"transform\" type=\"rotate\" repeatCount=\"10\" begin=\"5s\" dur=\"5s\" values=\"360 24.45 23.45;0 24.45 23.45\"></animateTransform>\r\n\r\n<animateTransform \r\nattributeName=\"transform\" \r\nid=\"el_st0_nth_child_4_\" \r\ntype=\"rotate\" \r\nrepeatCount=\"1\" \r\nbegin=\"1s;el_st0_nth_child_4_.end+7s\" \r\ndur=\"1s\" \r\nvalues=\"360 -1 -1;0 -1 -1\"\r\nfill=\"freeze|remove\"\r\ncalcMode=\"spline\"\r\nkeySplines=\"0.4 0 0.2 1\" <!-- https://cubic-bezier.com/ -->\r\n></animateTransform>\r\n\r\nsvg.pauseAnimations()\r\nsvg.unpauseAnimations()\r\nsvg.setCurrentTime(0)\r\n\r\nanimation.beginElementAt(time)\r\nanimation.beginElement()\r\nanimation.endElement()\r\n\r\nelement.getBBox()\r\n\r\n\r\n */","import React from 'react';\r\nimport {useState, useEffect, useCallback} from 'react';\r\n\r\n\r\n// https://www.raymondcamden.com/2017/04/25/using-device-motion-on-the-web\r\nconst UseDeviceMotion = (props) => {\r\n  const [threshold, setThreshold] = useState(45);\r\n  // const [lastAccVec3, setLastAccVec3] = useState([null, null, null]);\r\n  const [moveCounter, setMoveCounter] = useState(0);\r\n  const [permissionGranted, setPermissionGranted] = useState(false);\r\n  // const [shakeCounter, setShakeCounter] = useState(0);\r\n  \r\n  let lastAccVec3 = [null, null, null];\r\n  const onMotion = (event) => {\r\n    // event.alpha\r\n    // event.beta\r\n    // event.gamma\r\n    const {alpha, beta, gamma} = event;\r\n    //console.log('motion', acc);\r\n    // if (lastAccVec3[0] === null) {\r\n    //   setLastAccVec3([alpha, beta, gamma]);\r\n    //   return;\r\n    // }\r\n    // dunno why there exist some wrong result\r\n    //  - alpha, bata, gamma all zero randomly\r\n    if (!(alpha && beta && gamma)) { return; }\r\n    let deltaX = Math.abs(alpha - lastAccVec3[0]);\r\n    let deltaY = Math.abs(beta - lastAccVec3[1]);\r\n    let deltaZ = Math.abs(gamma - lastAccVec3[2]);\r\n  \r\n    if(deltaX + deltaY + deltaZ > threshold) {\r\n      setMoveCounter((prevMoveCounter) => {\r\n        return prevMoveCounter + 1;\r\n      })\r\n    } else {\r\n      setMoveCounter((prevMoveCounter) => {\r\n        return Math.max(0, prevMoveCounter - 1);\r\n      })\r\n    }\r\n    // setLastAccVec3([alpha, beta, gamma]);\r\n    lastAccVec3 = [alpha, beta, gamma];\r\n  };\r\n  useEffect(() => {\r\n    if (props.threshold) {\r\n      setThreshold(props.threshold);\r\n    }\r\n    return () => {\r\n\r\n    }\r\n  }, [props.threshold])\r\n\r\n  useEffect(() => {\r\n    if (permissionGranted) {\r\n      window.addEventListener('deviceorientation', onMotion, false);\r\n    }\r\n    return () => {\r\n      window.removeEventListener('deviceorientation', onMotion, false);\r\n    }\r\n  }, [permissionGranted])\r\n\r\n  useEffect(() => {\r\n    if(moveCounter > 2) {\r\n      console.log('SHAKE!!!');\r\n      // setShakeCounter((prevShakeCounter => {\r\n      //   return prevShakeCounter + 1;\r\n      // }));\r\n      if (props.onShake && typeof(props.onShake) === 'function') {\r\n        props.onShake();\r\n      }\r\n\t\t\tsetMoveCounter(0);\r\n\t\t}\r\n  }, [moveCounter, props]);\r\n\r\n  const requestDeviceOrientationPermission = () => {\r\n    if (DeviceOrientationEvent.requestPermission) {\r\n      // alert('DeviceOrientationEvent.requestPermission');\r\n      DeviceOrientationEvent.requestPermission().then(response => {\r\n          if (response == 'granted') {\r\n            setPermissionGranted(true);\r\n            // window.addEventListener('deviceorientation', onMotion, false);\r\n            // window.addEventListener('deviceorientation', (e) => {\r\n            //   // do something with e\r\n            // })\r\n          }\r\n        })\r\n        .catch(console.error);\r\n    } else {\r\n      setPermissionGranted(true);\r\n      // alert('no DeviceOrientationEvent.requestPermission');\r\n      // window.addEventListener('deviceorientation', onMotion, false);\r\n    }\r\n  }\r\n  // return <div>\r\n  //   {lastAccVec3.map(v => v + ', ')}\r\n  // </div>;\r\n\r\n  // return shakeCounter;\r\n  return permissionGranted? \r\n    <></>:\r\n    <div onClick={requestDeviceOrientationPermission}>Request Permission</div>;\r\n}\r\n\r\nexport default UseDeviceMotion;","import React from 'react';\r\nimport {useState, useEffect} from 'react';\r\nimport io from 'socket.io-client';\r\n\r\nimport {serverPath, serverPort} from 'globals/config';\r\n\r\nimport UseDeviceMotion from 'components/useDeviceMotion';\r\n\r\nconst App = (props) => {\r\n  const STATUS = Object.freeze({\r\n    CONNECTING: 0, \r\n    IDLE: 1, \r\n    SHAKING: 2, \r\n    ENDGAME: 3,\r\n    INVALID: 4, \r\n  });\r\n  const [socket, setSocket] = useState(null);\r\n  const [playersInfo, setPlayersInfo] = useState([]);\r\n  // const [shakeCount, setShakeCount] = useState(0);\r\n  const [statusDisplay, setStatusDisplay] = useState(STATUS.CONNECTING);\r\n  let lastShakeTime = null;\r\n  useEffect(() => {\r\n    // const serverPath = 'http://localhost';\r\n    // get the ip and port from ipc\r\n    // const socket = io(window.location.origin);\r\n    const serverUrl = `${serverPath}:${serverPort}`;\r\n    const socket = io(serverUrl);\r\n    setSocket(socket);\r\n    return () => {\r\n\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on('connect', () => {\r\n        console.log('connected !');\r\n        socket.emit('joinRoom', props.match.match.params.userId);\r\n        // wait join result msg from server\r\n      })\r\n      socket.on('playerStatus', (joinStatus) => {\r\n        setStatusDisplay(STATUS[joinStatus.status]);\r\n        // if (joinStatus.roomJoined) {\r\n        //   setStatusDisplay(STATUS.IDLE);\r\n        // } else {\r\n        //   setStatusDisplay(STATUS.INVALID);\r\n        // }\r\n      });\r\n      socket.on('*', (msg) => {\r\n        console.log(msg);\r\n      })\r\n    }\r\n  }, [socket]);\r\n  const onShake = () => {\r\n    /* send signal to server */\r\n    socket.emit('shake');\r\n    setStatusDisplay(STATUS.SHAKING);\r\n    if (lastShakeTime) {\r\n      clearTimeout(lastShakeTime);\r\n    }\r\n    lastShakeTime = setTimeout(() => {\r\n      setStatusDisplay(STATUS.IDLE);\r\n    },1000);\r\n  }\r\n  return <div>\r\n    {(() => {\r\n      switch (statusDisplay) {\r\n        /* case STATUS.IDLE:\r\n          return <div className=\"status statusIdle\">\r\n            Waiting for others players\r\n          </div>;\r\n        case STATUS.CONNECTING:\r\n          return <div className=\"status statusConnecting\">\r\n            Connecting\r\n          </div>; */\r\n        case STATUS.IDLE:\r\n        case STATUS.SHAKING:\r\n          return <div className=\"status statusShaking\">\r\n            <UseDeviceMotion onShake={onShake} />\r\n            Keep Shaking\r\n          </div>;\r\n        case STATUS.INVALID:\r\n          return <div className=\"status statusInvalid\">\r\n            Game not found, please scan the QR code again\r\n          </div>;\r\n        case STATUS.ENDGAME:\r\n          return <div className=\"status statusGameend\">\r\n            Finished, thanks for playing.\r\n          </div>;\r\n      }\r\n    })()}\r\n  </div>;\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport {generatePath} from 'react-router-dom';\r\nimport {useState, useEffect} from 'react';\r\nimport io from 'socket.io-client';\r\nimport QRCode from 'qrcode';\r\n\r\nimport routes from 'globals/routes';\r\n\r\nimport {serverPath, serverPort} from 'globals/config';\r\n\r\nimport ShakeGame from 'containers/shakeGame';\r\nimport CreateGame from 'pages/createGame';\r\n\r\nimport KitchenViewer from 'pages/kitchenViewer';\r\n\r\nimport './homePage.css';\r\n\r\n// const serverPath = 'https://socketio-testing.herokuapp.com';\r\n// const serverPort = 443;\r\n\r\nconst App = (props) => {\r\n  const [socket, setSocket] = useState(null);\r\n  const [playersInfo, setPlayersInfo] = useState([]);\r\n  useEffect(() => {\r\n    // const serverPath = 'http://localhost';\r\n    // get the ip and port from ipc\r\n    // const socket = io(window.location.origin);\r\n    const serverUrl = `${serverPath}:${serverPort}`;\r\n    const socket = io(serverUrl);\r\n    setSocket(socket);\r\n    return () => {\r\n\r\n    }\r\n  }, []);\r\n  const startGame = () => {\r\n    socket.emit('startGame');\r\n  }\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on('connect', () => {\r\n        console.log('connected !');\r\n        socket.emit('createRoom');\r\n      });\r\n      socket.on('playersInfo', (playersInfo) => {\r\n        for (let i = 0; i < playersInfo.length; i++) {\r\n          const playerIdx = i;\r\n          const playerInfo = playersInfo[playerIdx];\r\n          // const joinGamePath = window.location.origin + '/#' + routes.joinGame.replace(':userId', playerInfo['playerId']);\r\n          const joinGamePath = window.location.origin + window.location.pathname + '#' + generatePath(routes.joinGame, {userId: playerInfo['playerId']});\r\n          QRCode.toDataURL(\r\n            joinGamePath,\r\n            {\r\n              width: 300,\r\n              color: {\r\n                dark: '#000000FF',\r\n                light: '#FFFFFFFF'\r\n              },\r\n              margin: 0,\r\n            }\r\n          )\r\n          .then(url => {\r\n            setPlayersInfo((prevPlayersInfo) => {\r\n              const newPlayerInfo = [...prevPlayersInfo];\r\n              newPlayerInfo[playerIdx] = {\r\n                ...playerInfo,\r\n                url: joinGamePath,\r\n                img: url\r\n              };\r\n              return newPlayerInfo;\r\n            })\r\n            // this.qrcodeImage[idx][platform].setAttribute('src', url);\r\n          })\r\n        }\r\n      })\r\n      socket.on('*', (msg) => {\r\n        console.log(msg);\r\n      })\r\n      socket.on('playerInfo', (playerInfo) => {\r\n        console.log(playerInfo);\r\n      })\r\n    }\r\n  }, [socket]);\r\n\r\n  return <div className=\"page homePage\">\r\n    {/* display the box of the player recieved from server */}\r\n    <div className=\"qrcodeLayer\">\r\n      {playersInfo.map(playerInfo => {\r\n        return <div key={playerInfo['url']} className={`player-block ${playerInfo.joined? 'joined': 'waiting'}`}>\r\n          {/* https://mathiasbynens.github.io/rel-noopener/ */}\r\n          <div className=\"playerCard waiting\">\r\n            <a href={playerInfo['url']} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              <img src={playerInfo['img']} alt={`player QRcode`} className=\"playerQrcode\" />\r\n            </a>\r\n          </div>\r\n          <div className=\"playerCard joined\">\r\n            JOINED\r\n            <div className=\"shakeCount\"><big>{playerInfo.shakeCount}</big></div>\r\n          </div>\r\n        </div>;\r\n      })}\r\n    </div>\r\n    {/* <KitchenViewer /> */}\r\n    {/* <div className=\"startGameButton\" onClick={startGame}>Start Game!</div> */}\r\n  </div>;\r\n}\r\n\r\nexport default App;","import React, {useEffect, useState, useRef} from 'react';\r\nimport {TweenMax, Back} from 'gsap';\r\nimport Hammer from 'react-hammerjs';\r\n\r\nimport './touchTableInstance.css';\r\n\r\n\r\n/**\r\n * TouchTableInstance\r\n * @param {float} props.currentRotate\r\n * @param {[float, float]} props.currentXY\r\n * \r\n * TODO: reposition the instance when outside boundary\r\n */\r\nconst TouchTableInstance = (props) => {\r\n  const [msg, setMsg] = useState(\"event message\");\r\n  const [scale, setScale] = useState(1);\r\n  const [scalingFactor, setScalingFactor] = useState(0);\r\n  const [angle, setAngle] = useState(props.currentRotate || 0);\r\n  const [rotatingAngle, setRotatingAngle] = useState(props.currentRotate || 0);\r\n  const [currentXY, setCurrentXY] = useState(props.currentXY || [0,0]);\r\n  const [previousXY, setPreviousXY] = useState(props.currentXY || [0,0]);\r\n  const handlePinch = (event) => {\r\n    const newScale = Math.min(Math.max(scale * event.scale, 1), 2);\r\n    setScalingFactor(newScale);\r\n    setCurrentXY([\r\n      previousXY[0] + event.deltaX,\r\n      previousXY[1] + event.deltaY\r\n    ])\r\n  }\r\n  const handlePinchEnd = (event) => {\r\n    const newScale = Math.min(Math.max(scale * event.scale, 1), 2);\r\n    setScale(newScale);\r\n  }\r\n  const handleRotateStart = (event) => {\r\n    setAngle(event.rotation - rotatingAngle);\r\n  }\r\n  const handleRotateMove = (event) => {\r\n    setRotatingAngle( event.rotation - angle );\r\n  }\r\n  const enablePan = useRef(false);\r\n  const handlePanEnd = (event) => {\r\n    if (enablePan.current) {\r\n      enablePan.current = false;\r\n      // console.log('disablePan');\r\n      setPreviousXY([\r\n        previousXY[0] + event.deltaX,\r\n        previousXY[1] + event.deltaY\r\n      ])\r\n    }\r\n  }\r\n  const handlePan = (event) => {\r\n    // pan on scrollable area will have weird behaviour\r\n    if (event.type === \"pan\" && enablePan.current) {\r\n      // console.log(event.type);\r\n      setCurrentXY([\r\n        previousXY[0] + event.deltaX,\r\n        previousXY[1] + event.deltaY\r\n      ])\r\n    }\r\n  }\r\n  const handlePanStart = (event) => {\r\n    if (event.target.classList.contains('noPanning') || (event.target.offsetParent && event.target.offsetParent.classList.contains('noPanning'))) {\r\n      enablePan.current = false;\r\n      // console.log('noPan');\r\n    } else {\r\n      enablePan.current = true;\r\n      // console.log('enablePan');\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    const aniScale = {scale: 0};\r\n    TweenMax.to(aniScale, 0.4, {\r\n      scale: 1,\r\n      ease: Back.easeOut,\r\n      onUpdate: () => {\r\n        setScalingFactor(aniScale.scale)\r\n      },\r\n      onComplete: () => {\r\n        setScale(1)\r\n      }\r\n    })\r\n  }, [])\r\n  const rotateInstance = () => {\r\n    setAngle(angle + 12.5);\r\n    setRotatingAngle( rotatingAngle + 12.5 );\r\n  }\r\n  const closeInstance = () => {\r\n    const aniScale = {scale: scalingFactor};\r\n    TweenMax.to(aniScale, 0.2, {\r\n      scale: 0,\r\n      ease: Back.easeIn,\r\n      onUpdate: () => {\r\n        setScalingFactor(aniScale.scale)\r\n      },\r\n      onComplete: () => {\r\n        props.closeFunc()\r\n      }\r\n    })\r\n  }\r\n  return (\r\n  <div className=\"touchTableInstance\" \r\n    style={{\r\n      transform: `translate(${currentXY[0]}px,${currentXY[1]}px) rotate(${rotatingAngle}DEG) scale(${scalingFactor})`\r\n    }}\r\n  >\r\n    <Hammer\r\n      onPinch={handlePinch}\r\n      onPinchEnd={handlePinchEnd}\r\n      onRotateStart={handleRotateStart}\r\n      onRotateMove={handleRotateMove}\r\n      onPanStart={handlePanStart}\r\n      onPan={handlePan}\r\n      onPanEnd={handlePanEnd}\r\n      options={{\r\n        recognizers: {\r\n          pinch: { enable: true },\r\n          rotate: { enable: true },\r\n          pan: { threshold: 1 }\r\n        }\r\n      }}\r\n    >\r\n      <div style={{\r\n        height: '100%'\r\n      }}>\r\n    \r\n        <div className=\"controlMenu\">\r\n        <div className=\"rotateButton\" \r\n            onClick={rotateInstance}\r\n          >O</div>\r\n          <div className=\"closeButton\" \r\n            onClick={closeInstance}\r\n          >X</div>\r\n        </div>\r\n        <div className=\"contentPanel noPanning\">\r\n          <div className=\"categoryLayer1\">\r\n            <ul className=\"categoryLayer1List\">\r\n              <li className=\"categoryLayer1Item\">K. Wah</li>\r\n              <li className=\"categoryLayer1Item\">Dr. Lui Che Woo</li>\r\n              <li className=\"categoryLayer1Item\">Lui Che Woo Prize</li>\r\n              <li className=\"categoryLayer1Item\">Gallery</li>\r\n            </ul>\r\n          </div>\r\n          <div className=\"categoryLayer2\">\r\n            <ul className=\"categoryLayer2List\">\r\n              <li className=\"categoryLayer2Item\">About K. Wah</li>\r\n              <li className=\"categoryLayer2Item\">Properties</li>\r\n              <li className=\"categoryLayer2Item\">Chairman & Founder</li>\r\n              <li className=\"categoryLayer2Item\">CSR</li>\r\n              <li className=\"categoryLayer2Item\">Achievement</li>\r\n              <li className=\"categoryLayer2Item\">60 th Anniversary</li>\r\n              <li className=\"categoryLayer2Item\">Global Presence</li>\r\n              <li className=\"categoryLayer2Item\">Construction Materials</li>\r\n              <li className=\"categoryLayer2Item\">Hospitality</li>\r\n              <li className=\"categoryLayer2Item\">Entertainment & Leisure</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Hammer>\r\n  </div>\r\n  );\r\n}\r\n\r\nexport default TouchTableInstance;\r\n","import React, {useEffect, useState, useRef, useCallback} from 'react';\r\n\r\nimport Hammer from 'react-hammerjs';\r\n\r\nimport TouchTableInstance from 'components/touchTableInstance';\r\n\r\nimport clickSound from 'media/sound/click.mp3';\r\n\r\nimport './touchTable.css';\r\n\r\nconst TouchTable = () => {\r\n  const [instances, setInstances] = useState([]);\r\n  useEffect(() => {\r\n    const audioInstance = new Audio(clickSound);\r\n    const playClickSound = () => {\r\n      audioInstance.play();\r\n    }\r\n    document.addEventListener('click', playClickSound);\r\n    return () => {\r\n      document.removeEventListener('click', playClickSound);\r\n    }\r\n  }, [])\r\n  const createInstance = (event) => {\r\n    if (event.target.classList.contains('touchTableFrame')) {\r\n      setInstances((prevInstance) => {\r\n        const removeNewInstance = () => {\r\n          // remove itself\r\n          removeInstance(newInstance);\r\n        }\r\n        const containerWidth = event.target.offsetWidth;\r\n        const containerHeight = event.target.offsetHeight;\r\n        let instanceRotated = 0;\r\n        // rotation\r\n        const rotateAngleX = Math.atan(16 / 9);\r\n        const rotateAngleY = Math.PI / 2 - rotateAngleX;\r\n        const rotatedPositionX = event.center.x * Math.cos(rotateAngleX) - event.center.y * Math.sin(rotateAngleX);\r\n        const rotatedPositionY = (containerWidth / 2 - event.center.x) * Math.sin(rotateAngleY) + (containerHeight / 2 - event.center.y) * Math.cos(rotateAngleY);\r\n        if (rotatedPositionX < 0) {\r\n          if (rotatedPositionY < 0) {\r\n            instanceRotated = 0;\r\n          } else {\r\n            instanceRotated = 90;\r\n          }\r\n        } else {\r\n          if (rotatedPositionY < 0) {\r\n            instanceRotated = -90;\r\n          } else {\r\n            instanceRotated = 180;\r\n          }\r\n        }\r\n        /*\r\n        // simple distance \r\n        const distL = event.center.x;\r\n        const distR = containerWidth - event.center.x;\r\n        const distT = event.center.y;\r\n        const distB = containerHeight - event.center.y;\r\n        const minDist = Math.min(distL, distR, distT, distB);\r\n        console.log(distL, distR, distT, distB);\r\n        switch (minDist) {\r\n          case distL:\r\n            instanceRotated = 90;\r\n            break;\r\n          case distR:\r\n            instanceRotated = -90;\r\n            break;\r\n          case distT:\r\n            instanceRotated = 180;\r\n            break;\r\n          case distB:\r\n          default:\r\n            instanceRotated = 0;\r\n            break;\r\n        }\r\n        */\r\n        const pointerX = event.center.x;\r\n        const pointerY = event.center.y;\r\n        let instanceWidth = 640;\r\n        let instanceHeight = 360;\r\n        let instanceX = pointerX - instanceWidth / 2;\r\n        let instanceY = pointerY - instanceHeight / 2;\r\n        // check boundary\r\n        if (Math.abs(instanceRotated) === 90) {\r\n          [instanceWidth, instanceHeight] = [instanceHeight, instanceWidth];\r\n          if (instanceX < (instanceWidth - instanceHeight) / 2) {\r\n            instanceX = (instanceWidth - instanceHeight) / 2;\r\n          }\r\n          if (instanceX + (instanceHeight + instanceWidth) / 2 > containerWidth) {\r\n            instanceX = containerWidth - (instanceHeight + instanceWidth) / 2;\r\n          }\r\n\r\n          if (instanceY < (instanceHeight - instanceWidth) / 2) {\r\n            instanceY = (instanceHeight - instanceWidth) / 2;\r\n          }\r\n          if (instanceY + (instanceWidth + instanceHeight) / 2 > containerHeight) {\r\n            instanceY = containerHeight - (instanceWidth + instanceHeight) / 2;\r\n          }\r\n        } else {\r\n          if (instanceX + instanceWidth > containerWidth) {\r\n            instanceX = containerWidth - instanceWidth;\r\n          }\r\n          if (instanceX < 0) {\r\n            instanceX = 0;\r\n          }\r\n          if (instanceY + instanceHeight > containerHeight) {\r\n            instanceY = containerHeight - instanceHeight;\r\n          }\r\n          if (instanceY < 0) {\r\n            instanceY = 0;\r\n          }\r\n        }\r\n        const newInstance = <TouchTableInstance \r\n          key={Date.now()} \r\n          closeFunc={removeNewInstance} \r\n          currentXY={[instanceX, instanceY]}\r\n          currentRotate={instanceRotated}\r\n        />;\r\n        return [...prevInstance, newInstance];\r\n      })\r\n    }\r\n  }\r\n  const removeInstance = (instance) => {\r\n    setInstances((prevInstance) => {\r\n      const instanceIndex = prevInstance.indexOf(instance);\r\n      // console.log(instanceIndex);\r\n      return prevInstance.slice(0, instanceIndex).concat(prevInstance.slice(instanceIndex+1)); // , <TouchTableInstance currentXY={[event.center.x - 250, event.center.y - 100]} />];\r\n    })\r\n  }\r\n  return (\r\n  <Hammer onPress={createInstance}>\r\n    <div className=\"touchTableFrame\" onMouseMove={(event) => {\r\n      {/* console.log(event); */}\r\n      {/* const rotateAngleX = Math.atan(16 / 9);\r\n      const rotateAngleY = Math.PI / 2 - rotateAngleX;\r\n      const rotatedPositionX = event.clientX * Math.cos(rotateAngleX) - event.clientY * Math.sin(rotateAngleX);\r\n      const rotatedPositionY = (event.target.offsetWidth / 2 - event.clientX) * Math.sin(rotateAngleY) + (event.target.offsetHeight / 2 - event.clientY) * Math.cos(rotateAngleY);\r\n      console.log(rotatedPositionX, rotatedPositionY);\r\n      if (rotatedPositionX < 0) {\r\n          if (rotatedPositionY < 0) {\r\n            console.log(0,0);\r\n          } else {\r\n            console.log(0,1);\r\n          }\r\n        } else {\r\n          if (rotatedPositionY < 0) {\r\n            console.log(1,0);\r\n          } else {\r\n            console.log(1,1);\r\n          }\r\n        } */}\r\n      }}\r\n    >\r\n      <div className=\"debugFrame rotation\"></div>\r\n      <div className=\"debugFrame distance\"></div>\r\n      {instances}\r\n    </div>\r\n  </Hammer>\r\n  );\r\n}\r\n\r\nexport default TouchTable;\r\n","// import React from 'react';\r\nimport * as THREE from 'three';\r\nconst FBXLoader = require('three-fbxloader-offical');\r\n\r\nconst fbxModelsLoader = (modelsUrlArray) => {\r\n  const loader = new FBXLoader();\r\n  let mixer = null;\r\n  let modelLoadingArray = [];\r\n  modelsUrlArray.forEach((modelUrl, idx) => {\r\n    modelLoadingArray.push(\r\n      new Promise((resolve, reject) => {\r\n        setTimeout(() => {\r\n          loader.load(modelUrl, (object) => {\r\n            mixer = new THREE.AnimationMixer( object );\r\n            const action = mixer.clipAction( object.animations[ 0 ] );\r\n            action.loop = THREE.LoopOnce;\r\n            action.clampWhenFinished = true;\r\n            // action.play();\r\n            object.traverse(child => {\r\n              if (child.isMesh) {\r\n                child.castShadow = true;\r\n                child.receiveShadow = true;\r\n              }\r\n            });\r\n            resolve({\r\n              object: object,\r\n              mixer: mixer,\r\n              action: action,\r\n            });\r\n\r\n          }, (item) => {\r\n            // console.log( item, loaded, total );\r\n            console.log(item.loaded / item.total * 100 + '%');\r\n          }, (err) => {\r\n            console.log(err);\r\n            reject(err);\r\n          });\r\n        }, idx * 1000)\r\n        // resolve(\"foo\");\r\n      })\r\n    )\r\n  })\r\n  // const values = Promise.all(modelLoadingArray).then(values => { \r\n  //   return values;\r\n  // })\r\n  // return values;\r\n  return Promise.all(modelLoadingArray);\r\n  // return [];\r\n}\r\n\r\nexport default fbxModelsLoader;","import React from 'react';\r\nimport {useEffect, useState, useCallback} from 'react';\r\n\r\nimport fbxModelsLoader from 'components/fbxModelsLoader';\r\n\r\nconst CreateGame = (props) => {\r\n  /**\r\n   * createGame\r\n   *   - load kitchen and 3 hobs models\r\n   *   - connect to server and get the N-players uuid\r\n   *   - generate and display the qrcode base on the players uuid\r\n   *   - hidden buttons? (immediate start / restart / end game)\r\n   *   - wait the player scan the qrcode\r\n   *     - player joined (1 - N), start count down\r\n   * \r\n   * startGame\r\n   *   - user shake and the correspond hob play the animation\r\n   *     - if no one finish the shake, the total game time is 20secs\r\n   *     - if a user finish the shake, other players count down 5secs\r\n   *   - for 20% progress, add a popup\r\n   * \r\n   * endGame\r\n   *   - show the result\r\n   *   - auto restart after ? secs (or staff click?)\r\n   * \r\n   * */\r\n  const [loadedModels, setLoadedModels] = useState([]);\r\n  const fbxModels = [\r\n    require('media/models/190717_frying pan animationA_shake.fbx'),\r\n    require('media/models/190717_frying pan animationA_shake.fbx'),\r\n    require('media/models/190717_frying pan animationA_shake.fbx'),\r\n  ];\r\n  useEffect(() => {\r\n    // page load\r\n    loadModels();\r\n    return () => {\r\n      // page unload\r\n\r\n    }\r\n  }, []);\r\n  const loadModels = () => {\r\n    // load the models of the kitchen and the hobs\r\n    fbxModelsLoader(fbxModels).then(models => {\r\n      console.log(models);\r\n      setLoadedModels(models);\r\n    });\r\n  }\r\n  return <div className=\"page createGame\">\r\n    content of createGame\r\n    models loaded: {loadedModels.length}\r\n  </div>;\r\n}\r\nexport default CreateGame;","const routes = {\r\n  homePage: '/game',\r\n  joinGame: '/game/:userId',\r\n  fbxViewer: '/model',\r\n  fbxViewerOfName: '/:fbxName',\r\n  jsonViewerOfName: '/:jsonName',\r\n  typhoonViewer: '/:fbxName',\r\n  kitchenViewer: '/kitchenViewer',\r\n  touchTable: '/touchTable',\r\n  touchTableViewer: '/touchTableViewer',\r\n  indexPage: '/index',\r\n  animatingLines: '/animatingLines',\r\n  svgAnimator: '/svgAnimator',\r\n\r\n};\r\n\r\nexport default routes;","module.exports = __webpack_public_path__ + \"static/media/190715_CLP_game(8).3f43f4c2.fbx\";","module.exports = __webpack_public_path__ + \"static/media/meat.5069922d.png\";","module.exports = __webpack_public_path__ + \"static/media/mid_meat.6081577e.png\";","module.exports = __webpack_public_path__ + \"static/media/welldone_meat.0da2595b.png\";","module.exports = __webpack_public_path__ + \"static/media/click.826671b9.mp3\";"],"sourceRoot":""}