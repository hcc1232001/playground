{"version":3,"sources":["components/useDeviceMotion.js","pages/joinGame.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","globals/config.js"],"names":["UseDeviceMotion","props","_useState","useState","_useState2","Object","slicedToArray","threshold","setThreshold","_useState3","_useState4","lastAccVec3","setLastAccVec3","_useState5","_useState6","moveCounter","setMoveCounter","onMotion","useCallback","event","alpha","beta","gamma","deltaX","Math","abs","deltaY","deltaZ","prevMoveCounter","max","useEffect","window","addEventListener","removeEventListener","console","log","onShake","react_default","a","createElement","App","socket","setSocket","serverUrl","concat","serverPath","serverPort","io","on","emit","match","params","userId","msg","preventDefault","useDeviceMotion","onClick","_slicedToArray","arr","i","Array","isArray","_arrayWithHoles","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","value","length","err","_iterableToArrayLimit","TypeError","_nonIterableRest","__webpack_require__","d","__webpack_exports__"],"mappings":"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","file":"static/js/4.8aa7a11a.chunk.js","sourcesContent":["import React from 'react';\r\nimport {useState, useEffect, useCallback} from 'react';\r\n\r\n\r\n// https://www.raymondcamden.com/2017/04/25/using-device-motion-on-the-web\r\nconst UseDeviceMotion = (props) => {\r\n  const [threshold, setThreshold] = useState(45);\r\n  const [lastAccVec3, setLastAccVec3] = useState([null, null, null]);\r\n  const [moveCounter, setMoveCounter] = useState(0);\r\n  // const [shakeCounter, setShakeCounter] = useState(0);\r\n  \r\n  const onMotion = useCallback(\r\n    (event) => {\r\n      // event.alpha\r\n      // event.beta\r\n      // event.gamma\r\n      const {alpha, beta, gamma} = event;\r\n      //console.log('motion', acc);\r\n      // if (lastAccVec3[0] === null) {\r\n      //   setLastAccVec3([alpha, beta, gamma]);\r\n      //   return;\r\n      // }\r\n      // dunno why there exist some wrong result\r\n      //  - alpha, bata, gamma all zero randomly\r\n      if (!(alpha && beta && gamma)) { return; }\r\n      let deltaX = Math.abs(alpha - lastAccVec3[0]);\r\n      let deltaY = Math.abs(beta - lastAccVec3[1]);\r\n      let deltaZ = Math.abs(gamma - lastAccVec3[2]);\r\n    \r\n      if(deltaX + deltaY + deltaZ > threshold) {\r\n        setMoveCounter((prevMoveCounter) => {\r\n          return prevMoveCounter + 1;\r\n        })\r\n      } else {\r\n        setMoveCounter((prevMoveCounter) => {\r\n          return Math.max(0, prevMoveCounter - 1);\r\n        })\r\n      }\r\n      setLastAccVec3([alpha, beta, gamma]);\r\n    },\r\n    [threshold, lastAccVec3]\r\n  );\r\n  useEffect(() => {\r\n    if (props.threshold) {\r\n      setThreshold(props.threshold);\r\n    }\r\n    return () => {\r\n\r\n    }\r\n  }, [props.threshold])\r\n\r\n  useEffect(() => {\r\n    window.addEventListener('deviceorientation', onMotion, false);\r\n    // console.log('addEventListener deviceorientation');\r\n    return () => {\r\n      window.removeEventListener('deviceorientation', onMotion, false);\r\n      // console.log('removeEventListener deviceorientation');\r\n    }\r\n  }, [onMotion])\r\n\r\n  useEffect(() => {\r\n    if(moveCounter > 2) {\r\n      console.log('SHAKE!!!');\r\n      // setShakeCounter((prevShakeCounter => {\r\n      //   return prevShakeCounter + 1;\r\n      // }));\r\n      if (props.onShake && typeof(props.onShake) === 'function') {\r\n        props.onShake();\r\n      }\r\n\t\t\tsetMoveCounter(0);\r\n\t\t}\r\n  }, [moveCounter, props]);\r\n\r\n  // return <div>\r\n  //   {lastAccVec3.map(v => v + ', ')}\r\n  // </div>;\r\n\r\n  // return shakeCounter;\r\n  return <div>{moveCounter}</div>;\r\n}\r\n\r\nexport default UseDeviceMotion;","import React from 'react';\r\nimport {useState, useEffect} from 'react';\r\nimport io from 'socket.io-client';\r\n\r\nimport {serverPath, serverPort} from 'globals/config';\r\n\r\nimport UseDeviceMotion from 'components/useDeviceMotion';\r\n\r\nconst App = (props) => {\r\n  const [socket, setSocket] = useState(null);\r\n  // const [playersInfo, setPlayersInfo] = useState([]);\r\n  // const [shakeCount, setShakeCount] = useState(0);\r\n\r\n  useEffect(() => {\r\n    // const serverPath = 'http://localhost';\r\n    // get the ip and port from ipc\r\n    // const socket = io(window.location.origin);\r\n    const serverUrl = `${serverPath}:${serverPort}`;\r\n    const socket = io(serverUrl);\r\n    setSocket(socket);\r\n    return () => {\r\n\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (socket) {\r\n      socket.on('connect', () => {\r\n        console.log('connected !');\r\n        socket.emit('joinRoom', props.match.match.params.userId);\r\n      });\r\n      socket.on('joinRoomStatus', (msg) => {\r\n        // display fail msg if cannot join any room\r\n        console.log('joinRoom status: ', msg);\r\n      });\r\n      // TODO: need to wait a start game signal !!\r\n      socket.on('gameStarted', (msg) => {\r\n        // display start shake msg\r\n        // and shake available now\r\n      });\r\n      socket.on('*', (msg) => {\r\n        console.log(msg);\r\n      })\r\n    }\r\n  }, [socket]);\r\n  const onShake = (event) => {\r\n    event.preventDefault();\r\n    /* send signal to server */\r\n    socket.emit('shake');\r\n    // do some animation?\r\n    console.log('shake');\r\n  }\r\n  return <div>\r\n    <UseDeviceMotion onShake={onShake} />\r\n    Join Game!\r\n    {/* JSON.stringify(props) */}\r\n    <br />\r\n    <div onClick={onShake}>Shake it!</div>\r\n  </div>;\r\n}\r\n\r\nexport default App;","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}","const serverPath = 'https://socketio-testing.herokuapp.com';\r\nconst serverPort = 443;\r\n\r\nexport {\r\n  serverPath,\r\n  serverPort\r\n};"],"sourceRoot":""}